{"version":3,"sources":["custom.js","map-death.js","lines-bsas.js","bars-race.js","queue.js","map-composite.js","maps-substance.js","lines-death.js","lines-fent.js","blocks-substance-pie.js","blocks-gender.js","bars-age.js"],"names":["parallax","speed","document","querySelectorAll","window","onscroll","i","length","$offset","$","offset","$windowYOffset","height","pageYOffset","top","extraY","elBackgrounPos","style","backgroundPosition","collapseNavbar","addClass","removeClass","app","queue","defer","d3","json","awaitAll","generateMap","error","results","getYear","setSymbology","on","this","val","year","szAttr","html","parseInt","svgContainer","selectAll","transition","duration","d","delta","properties","OPIOIDSTATS","opChgScale","generateLegend","scale","szDivId","szCaption","width","svg","select","append","attr","g","legendData","push","r","s","domain","range","domainStrings","data","enter","text","maTowns","maOpioid","features","town","TOWN","console","log","alert","threshold","Infinity","colorbrewer","Blues","projection","geo","conicConformal","parallels","rotate","translate","geoPath","path","mouse","node","map","string_base","currentvalue","concat","currentyear","currentrate","format","tooltip","classed","toTitleCase","click","app2","generateMap2","str","replace","txt","charAt","toUpperCase","substr","toLowerCase","setSymbology2","generateLegend2","width2","height2","tooltip2","RdPu","type","keys","forEach","key","groups","age","value","values","wrap","each","word","words","split","reverse","line","lineNumber","lineHeight","y","dy","parseFloat","tspan","pop","join","getComputedTextLength","parallelism","popping","started","tasks","active","t","a","slice","call","callback","apply","e","remaining","NaN","notify","await","all","q","noop","arguments","f","version","define","amd","module","exports","createElement","scroll","ready","bind","event","$anchor","stop","animate","scrollTop","preventDefault","$id","$current","parent","find","location","pathname","hostname","target","hash","tab","$target","get","play","load","response","asignVal_svg","val_svg","initialize","mapWidth","mapHeight","transformX","transformY","legendWidth","legendHeight","unitWidth","Vis","visualize","states","visualizationWrapper","wrapper","createMap","selector","eventName","el","shape","$maps_sub","palette","self","town_value","geoData","parentNode","getElementsByTagName","innerHTML","fill-opacity","generateLegend_map_sub","$maps_sub_svg","$maps_sub_legends","YlOrBr","margin","right","bottom","left","MDG","Massachusetts","UnitedStates","dateFormat","time","xScale","yScale","sqrt","xAxis_death","axis","orient","ticks","tickFormat","innerTickSize","yAxis_death","tooltip_death","line_death","x","parse","rate","defined","$lines_death","csv","mouseoutFunc","mouseoverFunc","FullName","mousemoveFunc","coordinates","years","dataset","OMRs","Geography","rates","extent","max","inArray","quarter","date","date2","Date","setMonth","getMonth","Math","ceil","symbol","size","tooltipFent","focus","y0","y1","invert","percentVal","x0","pageY","pageX","rootSelector","chartData","FentanylHeroin","Fentanyl","Heroin","Methadone","yearformat","seriesColors","seriesLineStrokes","seriesLineDash","seriesPointShapes","seriesPointWidth","seriesPointFill","xLabel","ordinal","rangePoints","x2","linear","color","lineStroke","lineDash","pointShape","pointWidth","pointFill","xAxis_fent","months","xAxis2_fent","tickSize","tickPadding","formatPercent","yAxis_fent","label","$lines_fent","querySelector","varSeries","filter","seriesData","name","min","c","series","town_names","current_town","margin_bsas","width_bsas","height_bsas","bisectAge","bisector","percent","category10","xAxis_bsas","outerTickSize","yAxis_bsas","$lines_bsas","update","delay","string_select","value_select","mousemove","i_alcohol","d0_alcohol","d1_alcohol","d_alcohol","focusalcohol","i_marijuana","d0_marijuana","d1_marijuana","d_marijuana","focusmarijuana","i_none","d0_none","d1_none","d_none","focusnone","i_opioids","d0_opioids","d1_opioids","d_opioids","focusopioids","i_other","d0_other","d1_other","d_other","focusother","legend_pos_text","legend_pos_dot","y_circle_alcohol","autocomplete","source","request","matches","acItem","indexOf","term","ui","item","asignVal_substance","empty","makeChart_substance","Yes","No","data_substance","blockArray_substance","noOfBlocks_No","round","noOfBlocks_Yes","blockArray","addBlocks_substance","addBlock_substance","id","b","getParent","getValue","getSum","_sum","arcTween","toArc","arc","toEndAngle","endAngle","_current","interpolate","startAngle","labelAnimation","centroid","fill","selectArcAnimation","_d","dist","outerRadius","midAngle","sin","cos","updatePie","getPercent","sum","toFixed","getLegend","liveLarge","angle","arcLength","PI","onMouseIn","onClick","option","description","eval","explodedIndex","$pie_substance","_i","animateDuration","opacity","transform","labelHeight","stroke","x1","innerRadius","y2","onMouseOut","pie","arcs","isDelay","_duration","font-family","font-size","text-anchor","attrTween","class","exit","remove","legends","labelWidth","generatePie","prescription","heroin","fentanyl","both","methadone","buprenorphine","time_period","labelsWidth","layout","sort","alignment-baseline","data_pie","asignVal_gender","makeChart_gender","table_html","data_gender","noOfBlocks_gender","blockArray_gender","addBlocks_gender","addBlock_gender","noOfBlocks","multi","$option","$value","drawGraph","column","redraw","rangeBands","bars","$bars_age","gender_age","age_bar_color","age_bar_label","age_bars_legend","options","ease","rangeBand","gender","labels","labels2","numberFormat","percentageFormat","rateFormat","selected","thisButton","raceth","2014","2015","rangeRoundBands","xAxis_bars","yAxis_bars","divtooltip_raceeth","$bars_race","bar","elements","l","elementData","__data__","legend"],"mappings":"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A,KAAA,iBAAA,QAEAhC,GAAAgB,UAAA,gBACAR,GAAA,YAAA4N,GACA5N,GAAA,WAAA2N,GACA3N,GAAA,YAAA8N,KNzVA,IAAAsE,aAEA,WACA,QACA,WACA,QACA,SACA,SACA,WACA,UACA,UACA,WACA,YACA,aACA,QACA,WACA,UACA,QACA,YACA,SACA,OACA,OACA,aACA,QACA,SACA,UACA,cACA,aACA,UACA,UACA,SACA,cACA,UACA,YACA,aACA,YACA,SACA,SACA,SACA,aACA,UACA,WACA,YACA,WACA,cACA,YACA,WACA,aACA,WACA,cACA,YACA,WACA,aACA,YACA,WACA,aACA,YACA,SACA,WACA,SACA,aACA,WACA,UACA,aACA,UACA,WACA,UACA,eACA,WACA,WACA,aACA,UACA,WACA,UACA,UACA,SACA,aACA,SACA,UACA,YACA,SACA,YACA,SACA,UACA,UACA,QACA,SACA,SACA,YACA,UACA,kBACA,iBACA,iBACA,UACA,cACA,SACA,YACA,WACA,SACA,QACA,UACA,YACA,YACA,WACA,YACA,UACA,aACA,aACA,WACA,WACA,UACA,WACA,aACA,OACA,aACA,SACA,UACA,UACA,SACA,YACA,kBACA,aACA,SACA,YACA,SACA,UACA,WACA,UACA,UACA,UACA,SACA,WACA,UACA,UACA,WACA,YACA,SACA,QACA,UACA,WACA,WACA,SACA,UACA,YACA,UACA,WACA,YACA,cACA,SACA,OACA,aACA,UACA,WACA,YACA,YACA,eACA,WACA,MACA,YACA,QACA,aACA,WACA,YACA,SACA,UACA,YACA,aACA,SACA,SACA,YACA,OACA,YACA,SACA,aACA,YACA,aACA,SACA,cACA,aACA,UACA,eACA,UACA,WACA,UACA,SACA,UACA,SACA,WACA,UACA,gBACA,cACA,YACA,UACA,WACA,SACA,YACA,SACA,SACA,SACA,WACA,WACA,aACA,kBACA,SACA,YACA,SACA,UACA,aACA,aACA,eACA,iBACA,WACA,UACA,cACA,SACA,UACA,YACA,cACA,mBACA,iBACA,cACA,cACA,eACA,cACA,aACA,SACA,UACA,UACA,aACA,SACA,SACA,UACA,OACA,SACA,SACA,SACA,UACA,SACA,WACA,YACA,OACA,YACA,cACA,aACA,aACA,aACA,WACA,WACA,YACA,eACA,SACA,WACA,UACA,UACA,WACA,SACA,WACA,YACA,WACA,WACA,OACA,SACA,YACA,UACA,UACA,QACA,YACA,cACA,WACA,SACA,QACA,WACA,UACA,SACA,YACA,YACA,WACA,UACA,aACA,aACA,WACA,aACA,cACA,cACA,eACA,cACA,YACA,UACA,cACA,WACA,cACA,WACA,YACA,OACA,aACA,UACA,aACA,SACA,aACA,UACA,UACA,YACA,YACA,UACA,UACA,YACA,WACA,QACA,eACA,YACA,QACA,WACA,YACA,QACA,UACA,UACA,OACA,UACA,SACA,UACA,aACA,YACA,UACA,UACA,YACA,YACA,UACA,SACA,eACA,kBACA,iBACA,cACA,kBACA,kBACA,cACA,cACA,YACA,WACA,cACA,cACA,SACA,WACA,WACA,WACA,UACA,UACA,YACA,eACA,eACA,aACA,aACA,aACA,UACA,WACA,SACA,YACA,cACA,WACA,YAEAC,aAAA,gBAEAC,aACAzT,IAAA,EACAoN,MAAA,GACAC,OAAA,GACAC,KAAA,IAEAoG,WAAA,IAAAD,YAAAnG,KAAAmG,YAAArG,MACAuG,YAAA,IAAAF,YAAAzT,IAAAyT,YAAApG,OAEAuG,UAAAjT,GAAAkT,SAAA,SAAA/R,GACA,MAAAA,GAAA8E,MACA0G,KACAwG,QAAAnT,GAAAwE,OAAA,QACAiM,WAAAzQ,GAAAwE,OAAA,KAGAwB,UAEA6H,EAAA7N,GAAAyB,MAAA2P,SACA7O,OAAA,EAAAwQ,aAEAlM,EAAA7G,GAAAyB,MAAA2P,SACA7O,OAAAyQ,YAAA,IAGA3B,MAAArR,GAAAyB,MAAA2R,aAEAC,WAAArT,GAAA6B,IAAAwL,OACA5L,MAAAoM,GACAL,WAAAiD,YACAnD,OAAA,UACAgG,cAAA,GAEAC,WAAAvT,GAAA6B,IAAAwL,OACA5L,MAAAoF,GACAiL,SAAAiB,YACAzF,OAAA,SACAE,WAAA2F,SAEAzM,KAAA1G,GAAA6B,IAAA6E,OACAmH,EAAA,SAAA1M,GACA,MAAA0M,GAAA1M,EAAA8E,OAEAY,EAAA,SAAA1F,GACA,MAAA0F,GAAA1F,EAAA+E,SAEA8H,QAAA,SAAA7M,GACA,MAAA0F,GAAA1F,EAAA+E,SAKAsN,YAAAxT,GAAA8B,OAAA,eAAAC,OAAA,OACAC,KAAA,QAAA+Q,WAAAD,YAAAnG,KAAAmG,YAAArG,OACAzK,KAAA,SAAAgR,YAAAF,YAAAzT,IAAAyT,YAAApG,QACA3K,OAAA,KACAC,KAAA,YAAA,aAAA8Q,YAAAnG,KAAA,IAAAmG,YAAAzT,IAAA,IAEAW,IAAAkO,IAAA,wBAAAtI,KAAA,SAAAxF,EAAAqC,GA0QA,QAAAgR,KAeA,IAXAD,YAAA1R,OAAA,iBACAb,aACAC,SAAA,KACAwS,MAAA,KACA1R,KAAA,IAAA,SAAAb,GACA,MAAAuF,MAAAV,OAAA6M,aAAA,WAAA1M,UAMAtH,EAAA,EAAAA,EAAAmH,OAAA6M,aAAA,WAAA1M,OAAArH,OAAAD,IAAA,CACA,GAAA8U,GAAA,oBAAA3N,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAoH,GAGAD,QAAA6M,aAAA,WAAA1M,OAAAtH,GAAAqH,OAAA,EACAsN,YAAAxS,UAAA2S,GACA1S,aACAC,SAAA,KACAc,KAAA,KAAA,SAAAb;AACA,MAAA0M,GAAA7H,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAoH,OAEAjE,KAAA,KAAA,SAAAb,GACA,MAAA0F,GAAAb,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAqH,SAEAlE,KAAA,IAAA,GAEAwR,YAAAxS,UAAA2S,GACA1S,aACAC,SAAA,KACAc,KAAA,IAAA,GAeA,IAPAwR,YAAA1R,OAAA,mBACAb,aACAC,SAAA,KACAc,KAAA,IAAA,SAAAb,GACA,MAAAuF,MAAAV,OAAA6M,aAAA,aAAA1M,UAGAtH,EAAA,EAAAA,EAAAmH,OAAA6M,aAAA,aAAA1M,OAAArH,OAAAD,IAAA,CACA,GAAA8U,GAAA,sBAAA3N,OAAA6M,aAAA,aAAA1M,OAAAtH,GAAAoH,GAGAD,QAAA6M,aAAA,aAAA1M,OAAAtH,GAAAqH,OAAA,EACAsN,YAAAxS,UAAA2S,GACA1S,aACAC,SAAA,KACAc,KAAA,KAAA,SAAAb,GACA,MAAA0M,GAAA7H,OAAA6M,aAAA,aAAA1M,OAAAtH,GAAAoH,OAEAjE,KAAA,KAAA,SAAAb,GACA,MAAA0F,GAAAb,OAAA6M,aAAA,aAAA1M,OAAAtH,GAAAqH,SAEAlE,KAAA,IAAA,GAEAwR,YAAAxS,UAAA2S,GACA1S,aACAC,SAAA,KACAc,KAAA,IAAA,GAaA,IAPAwR,YAAA1R,OAAA,cACAb,aACAC,SAAA,KACAc,KAAA,IAAA,SAAAb,GACA,MAAAuF,MAAAV,OAAA6M,aAAA,QAAA1M,UAGAtH,EAAA,EAAAA,EAAAmH,OAAA6M,aAAA,QAAA1M,OAAArH,OAAAD,IAAA,CAGA,GAAA8U,GAAA,iBAAA3N,OAAA6M,aAAA,QAAA1M,OAAAtH,GAAAoH,IACA2N,EAAA5N,OAAA6M,aAAA,QAAA1M,OAAAtH,GAAAqH,KAKAF,QAAA6M,aAAA,QAAA1M,OAAAtH,GAAAqH,OAAA,EACAsN,YAAAxS,UAAA2S,GACA1S,aACAC,SAAA,KACAc,KAAA,KAAA,SAAAb,GACA,MAAA0M,GAAA7H,OAAA6M,aAAA,QAAA1M,OAAAtH,GAAAoH,OAEAjE,KAAA,KAAA,SAAAb,GACA,MAAA0F,GAAAb,OAAA6M,aAAA,QAAA1M,OAAAtH,GAAAqH,SAEAlE,KAAA,IAAA,GAEAwR,YAAAxS,UAAA2S,GACA1S,aACAC,SAAA,KACAc,KAAA,IAAA,GAaA,IAPAwR,YAAA1R,OAAA,iBACAb,aACAC,SAAA,KACAc,KAAA,IAAA,SAAAb,GACA,MAAAuF,MAAAV,OAAA6M,aAAA,WAAA1M,UAGAtH,EAAA,EAAAA,EAAAmH,OAAA6M,aAAA,WAAA1M,OAAArH,OAAAD,IAAA,CAGA,GAAA8U,GAAA,oBAAA3N,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAoH,IACA2N,EAAA5N,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAqH,KAKA0N,IAAA,EACAJ,YAAAxS,UAAA2S,GACA1S,aACAC,SAAA,KACAc,KAAA,KAAA,SAAAb,GACA,MAAA0M,GAAA7H,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAoH,OAEAjE,KAAA,KAAA,SAAAb,GACA,MAAA0F,GAAAb,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAqH,SAEAlE,KAAA,IAAA,GAEAwR,YAAAxS,UAAA2S,GACA1S,aACAC,SAAA,KACAc,KAAA,IAAA,GAaA,IAPAwR,YAAA1R,OAAA,eACAb,aACAC,SAAA,KACAc,KAAA,IAAA,SAAAb,GACA,MAAAuF,MAAAV,OAAA6M,aAAA,SAAA1M,UAGAtH,EAAA,EAAAA,EAAAmH,OAAA6M,aAAA,SAAA1M,OAAArH,OAAAD,IAAA,CAEA,GAAA8U,GAAA,kBAAA3N,OAAA6M,aAAA,SAAA1M,OAAAtH,GAAAoH,IACA2N,EAAA5N,OAAA6M,aAAA,SAAA1M,OAAAtH,GAAAqH,KAKA0N,IAAA,EACAJ,YAAAxS,UAAA2S,GACA1S,aACAC,SAAA,KACAc,KAAA,KAAA,SAAAb,GACA,MAAA0M,GAAA7H,OAAA6M,aAAA,SAAA1M,OAAAtH,GAAAoH,OAEAjE,KAAA,KAAA,SAAAb,GACA,MAAA0F,GAAAb,OAAA6M,aAAA,SAAA1M,OAAAtH,GAAAqH,SAEAlE,KAAA,IAAA,GAEAwR,YAAAxS,UAAA2S,GACA1S,aACAC,SAAA,KACAc,KAAA,IAAA,IAmFA,QAAA6R,KAIA,GAAA7D,GAAAnC,EAAAiC,OAAA9P,GAAAgE,MAAAvD,MAAA,IAGAqT,EAAAb,UAAAjN,OAAA6M,aAAA,WAAA1M,OAAA6J,EAAA,GACA+D,EAAA/N,OAAA6M,aAAA,WAAA1M,OAAA2N,EAAA,GACAE,EAAAhO,OAAA6M,aAAA,WAAA1M,OAAA2N,GACAG,EAAAjE,EAAA+D,EAAA9N,IAAA+N,EAAA/N,IAAA+J,EAAAgE,EAAAD,CAEAE,GAAA/N,OAAA,GACAgO,EAAAlS,KAAA,YAAA,aAAA6L,EAAAoG,EAAAhO,KAAA,IAAAY,EAAAoN,EAAA/N,OAAA,KACAgO,EAAApS,OAAA,QAAAa,KAAAwQ,QAAAc,EAAA/N,QACAgO,EAAApS,OAAA,UAAAE,KAAA,IAAA,KAEAkS,EAAApS,OAAA,UAAAE,KAAA,IAAA,GACAkS,EAAApS,OAAA,QAAAa,KAAA,IAKA,IAAAwR,GAAAlB,UAAAjN,OAAA6M,aAAA,aAAA1M,OAAA6J,EAAA,GACAoE,EAAApO,OAAA6M,aAAA,aAAA1M,OAAAgO,EAAA,GACAE,EAAArO,OAAA6M,aAAA,aAAA1M,OAAAgO,GACAG,EAAAtE,EAAAoE,EAAAnO,IAAAoO,EAAApO,IAAA+J,EAAAqE,EAAAD,CAMAE,GAAApO,OAAA,GACAqO,EAAAvS,KAAA,YAAA,aAAA6L,EAAAyG,EAAArO,KAAA,IAAAY,EAAAyN,EAAApO,OAAA,KACAqO,EAAAzS,OAAA,QAAAa,KAAAwQ,QAAAmB,EAAApO,QACAqO,EAAAzS,OAAA,UAAAE,KAAA,IAAA,KAEAuS,EAAAzS,OAAA,UAAAE,KAAA,IAAA,GACAuS,EAAAzS,OAAA,QAAAa,KAAA,IAKA,IAAA6R,GAAAvB,UAAAjN,OAAA6M,aAAA,QAAA1M,OAAA6J,EAAA,GACAyE,EAAAzO,OAAA6M,aAAA,QAAA1M,OAAAqO,EAAA,GACAE,EAAA1O,OAAA6M,aAAA,QAAA1M,OAAAqO,GACAG,EAAA3E,EAAAyE,EAAAxO,IAAAyO,EAAAzO,IAAA+J,EAAA0E,EAAAD,CAEAE,GAAAzO,OAAA,GACA0O,EAAA5S,KAAA,YAAA,aAAA6L,EAAA8G,EAAA1O,KAAA,IAAAY,EAAA8N,EAAAzO,OAAA,KACA0O,EAAA9S,OAAA,QAAAa,KAAAwQ,QAAAwB,EAAAzO,QACA0O,EAAA9S,OAAA,UAAAE,KAAA,IAAA,KAEA4S,EAAA9S,OAAA,UAAAE,KAAA,IAAA,GACA4S,EAAA9S,OAAA,QAAAa,KAAA,IAKA,IAAAkS,GAAA5B,UAAAjN,OAAA6M,aAAA,WAAA1M,OAAA6J,EAAA,GACA8E,EAAA9O,OAAA6M,aAAA,WAAA1M,OAAA0O,EAAA,GACAE,EAAA/O,OAAA6M,aAAA,WAAA1M,OAAA0O,GACAG,EAAAhF,EAAA8E,EAAA7O,IAAA8O,EAAA9O,IAAA+J,EAAA+E,EAAAD,CAEAE,GAAA9O,OAAA,GACA+O,EAAAjT,KAAA,YAAA,aAAA6L,EAAAmH,EAAA/O,KAAA,IAAAY,EAAAmO,EAAA9O,OAAA,KACA+O,EAAAnT,OAAA,QAAAa,KAAAwQ,QAAA6B,EAAA9O,QACA+O,EAAAnT,OAAA,UAAAE,KAAA,IAAA,KAEAiT,EAAAnT,OAAA,UAAAE,KAAA,IAAA,GACAiT,EAAAnT,OAAA,QAAAa,KAAA,IAKA,IAAAuS,GAAAjC,UAAAjN,OAAA6M,aAAA,SAAA1M,OAAA6J,EAAA,GACAmF,EAAAnP,OAAA6M,aAAA,SAAA1M,OAAA+O,EAAA,GACAE,EAAApP,OAAA6M,aAAA,SAAA1M,OAAA+O,GACAG,EAAArF,EAAAmF,EAAAlP,IAAAmP,EAAAnP,IAAA+J,EAAAoF,EAAAD,CAIAE,GAAAnP,OAAA,GACAoP,EAAAtT,KAAA,YAAA,aAAA6L,EAAAwH,EAAApP,KAAA,IAAAY,EAAAwO,EAAAnP,OAAA,KACAoP,EAAAxT,OAAA,QAAAa,KAAAwQ,QAAAkC,EAAAnP,QACAoP,EAAAxT,OAAA,UAAAE,KAAA,IAAA,KAEAsT,EAAAxT,OAAA,UAAAE,KAAA,IAAA,GACAsT,EAAAxT,OAAA,QAAAa,KAAA,KAKAqN,EAAA,IACAkE,EAAApS,OAAA,QAAAE,KAAA,IAAA,GAAAA,KAAA,KAAA,GAAAA,KAAA,cAAA,aACAuS,EAAAzS,OAAA,QAAAE,KAAA,IAAA,GAAAA,KAAA,KAAA,GAAAA,KAAA,cAAA,aACA4S,EAAA9S,OAAA,QAAAE,KAAA,IAAA,GAAAA,KAAA,KAAA,GAAAA,KAAA,cAAA,aACAiT,EAAAnT,OAAA,QAAAE,KAAA,IAAA,GAAAA,KAAA,KAAA,GAAAA,KAAA,cAAA,aACAsT,EAAAxT,OAAA,QAAAE,KAAA,IAAA,GAAAA,KAAA,KAAA,GAAAA,KAAA,cAAA,eAEAkS,EAAApS,OAAA,QAAAE,KAAA,IAAA,IAAAA,KAAA,cAAA,aACAuS,EAAAzS,OAAA,QAAAE,KAAA,IAAA,IAAAA,KAAA,cAAA,aACA4S,EAAA9S,OAAA,QAAAE,KAAA,IAAA,IAAAA,KAAA,cAAA,aACAiT,EAAAnT,OAAA,QAAAE,KAAA,IAAA,IAAAA,KAAA,cAAA,aACAsT,EAAAxT,OAAA,QAAAE,KAAA,IAAA,IAAAA,KAAA,cAAA,cAtnBA,GAAA5B,EAAA,KAAAA,EAIAyN,GAAAvL,QAAA,KAAAtC,GAAA8O,IAAArM,EAAA,SAAAtB,GACA,MAAAA,GAAA8E,QAEAY,EAAAvE,QAAA,EAAA,MAEAkR,YAAAzR,OAAA,KACAC,KAAA,QAAA,eACAA,KAAA,YAAA,eAAAgR,YAAA,KACApL,KAAAyL,YACAtR,OAAA,QACAC,KAAA,IAAA,KACAA,KAAA,IAAA,IACAA,KAAA,cAAA,UACAW,KAAA,QAEA6Q,YAAAzR,OAAA,KACAC,KAAA,QAAA,eACA4F,KAAA2L,YACAxR,OAAA,QAEAvC,MAAA,cAAA,SAEAgU,YAAAxS,UAAA,qBAAAgB,KAAA,KAAA,IAAAA,KAAA,KAAA,EAEA,IAAAuT,IAAA,GACAC,GAAA,EA0EA,KAvEAhC,YAAAzR,OAAA,UACAC,KAAA,QAAA,kBACAA,KAAA,KAAA+Q,WAAAyC,GACAxT,KAAA,KAAA,IACAA,KAAA,IAAA,GACAwR,YAAAzR,OAAA,KACAA,OAAA,QACAC,KAAA,QAAA,iBACAA,KAAA,IAAA+Q,WAAAwC,GACAvT,KAAA,IAAA,IACAW,KAAA,WAEA6Q,YAAAzR,OAAA,UACAC,KAAA,QAAA,kBACAA,KAAA,KAAA+Q,WAAAyC,GACAxT,KAAA,KAAA,IACAA,KAAA,IAAA,GACAwR,YAAAzR,OAAA,KACAA,OAAA,QACAC,KAAA,QAAA,iBACAA,KAAA,IAAA+Q,WAAAwC,GACAvT,KAAA,IAAA,IACAW,KAAA,WAGA6Q,YAAAzR,OAAA,UACAC,KAAA,QAAA,oBACAA,KAAA,KAAA+Q,WAAAyC,GACAxT,KAAA,KAAA,IACAA,KAAA,IAAA,GACAwR,YAAAzR,OAAA,KACAA,OAAA,QACAC,KAAA,QAAA,mBACAA,KAAA,IAAA+Q,WAAAwC,GACAvT,KAAA,IAAA,IACAW,KAAA,aAGA6Q,YAAAzR,OAAA,UACAC,KAAA,QAAA,gBACAA,KAAA,KAAA+Q,WAAAyC,GACAxT,KAAA,KAAA,IACAA,KAAA,IAAA,GACAwR,YAAAzR,OAAA,KACAA,OAAA,QACAC,KAAA,QAAA,eACAA,KAAA,IAAA+Q,WAAAwC,GACAvT,KAAA,IAAA,IACAW,KAAA,SAGA6Q,YAAAzR,OAAA,UACAC,KAAA,QAAA,eACAA,KAAA,KAAA+Q,WAAAyC,GACAxT,KAAA,KAAA,IACAA,KAAA,IAAA,GACAwR,YAAAzR,OAAA,KACAA,OAAA,QACAC,KAAA,QAAA,cACAA,KAAA,IAAA+Q,WAAAwC,GACAvT,KAAA,IAAA,IACAW,KAAA,QAGA6Q,YAAAzR,OAAA,QACAC,KAAA,QAAA,gBACAA,KAAA,IAAA,SAAAb,GACA,MAAAuF,MAAAV,OAAA6M,aAAA,WAAA1M,UAIAtH,EAAA,EAAAA,EAAAmH,OAAA6M,aAAA,WAAA1M,OAAArH,OAAAD,IAAA,CAEA,GACA4W,IADAzP,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAoH,IACAD,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAqH,MAEAuP,IAAA,GAKAjC,YAAAzR,OAAA,UACAC,KAAA,QAAA,SAAAb,GACA,MAAA,mBAAA6E,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAoH,MAEAjE,KAAA,KAAA6L,EAAA7H,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAoH,MACAjE,KAAA,KAAA6E,EAAAb,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAqH,QACAlE,KAAA,IAAA,GAWA,IANAwR,YAAAzR,OAAA,QACAC,KAAA,QAAA,kBACAA,KAAA,IAAA,SAAAb,GACA,MAAAuF,MAAAV,OAAA6M,aAAA,aAAA1M,UAGAtH,EAAA,EAAAA,EAAAmH,OAAA6M,aAAA,aAAA1M,OAAArH,OAAAD,IAAA,CAEA,GACA4W,IADAzP,OAAA6M,aAAA,aAAA1M,OAAAtH,GAAAoH,IACAD,OAAA6M,aAAA,aAAA1M,OAAAtH,GAAAqH,MAEAuP,IAAA,GAKAjC,YAAAzR,OAAA,UACAC,KAAA,QAAA,SAAAb,GACA,MAAA,qBAAA6E,OAAA6M,aAAA,aAAA1M,OAAAtH,GAAAoH,MAEAjE,KAAA,KAAA6L,EAAA7H,OAAA6M,aAAA,aAAA1M,OAAAtH,GAAAoH,MACAjE,KAAA,KAAA6E,EAAAb,OAAA6M,aAAA,aAAA1M,OAAAtH,GAAAqH,QACAlE,KAAA,IAAA,GAWA,IANAwR,YAAAzR,OAAA,QACAC,KAAA,QAAA,aACAA,KAAA,IAAA,SAAAb,GACA,MAAAuF,MAAAV,OAAA6M,aAAA,QAAA1M,UAGAtH,EAAA,EAAAA,EAAAmH,OAAA6M,aAAA,QAAA1M,OAAArH,OAAAD,IAAA,CAEA,GACA4W,IADAzP,OAAA6M,aAAA,QAAA1M,OAAAtH,GAAAoH,IACAD,OAAA6M,aAAA,QAAA1M,OAAAtH,GAAAqH,MAEAuP,IAAA,GAKAjC,YAAAzR,OAAA,UACAC,KAAA,QAAA,SAAAb,GACA,MAAA,gBAAA6E,OAAA6M,aAAA,QAAA1M,OAAAtH,GAAAoH,MAEAjE,KAAA,KAAA6L,EAAA7H,OAAA6M,aAAA,QAAA1M,OAAAtH,GAAAoH,MACAjE,KAAA,KAAA6E,EAAAb,OAAA6M,aAAA,QAAA1M,OAAAtH,GAAAqH,QACAlE,KAAA,IAAA,GAWA,IANAwR,YAAAzR,OAAA,QACAC,KAAA,QAAA,gBACAA,KAAA,IAAA,SAAAb,GACA,MAAAuF,MAAAV,OAAA6M,aAAA,WAAA1M,UAGAtH,EAAA,EAAAA,EAAAmH,OAAA6M,aAAA,WAAA1M,OAAArH,OAAAD,IAAA,CAEA,GACA4W,IADAzP,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAoH,IACAD,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAqH,MAEAuP,IAAA,GAKAjC,YAAAzR,OAAA,UACAC,KAAA,QAAA,SAAAb,GACA,MAAA,mBAAA6E,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAoH,MAEAjE,KAAA,KAAA6L,EAAA7H,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAoH,MACAjE,KAAA,KAAA6E,EAAAb,OAAA6M,aAAA,WAAA1M,OAAAtH,GAAAqH,QACAlE,KAAA,IAAA,GAWA,IANAwR,YAAAzR,OAAA,QACAC,KAAA,QAAA,cACAA,KAAA,IAAA,SAAAb,GACA,MAAAuF,MAAAV,OAAA6M,aAAA,SAAA1M,UAGAtH,EAAA,EAAAA,EAAAmH,OAAA6M,aAAA,SAAA1M,OAAArH,OAAAD,IAAA,CAEA,GACA4W,IADAzP,OAAA6M,aAAA,SAAA1M,OAAAtH,GAAAoH,IACAD,OAAA6M,aAAA,SAAA1M,OAAAtH,GAAAqH,MAEAuP,IAAA,GAKAjC,YAAAzR,OAAA,UACAC,KAAA,QAAA,SAAAb,GACA,MAAA,iBAAA6E,OAAA6M,aAAA,SAAA1M,OAAAtH,GAAAoH,MAEAjE,KAAA,KAAA6L,EAAA7H,OAAA6M,aAAA,SAAA1M,OAAAtH,GAAAoH,MACAjE,KAAA,KAAA6E,EAAAb,OAAA6M,aAAA,SAAA1M,OAAAtH,GAAAqH,QACAlE,KAAA,IAAA,GAMAhD,EAAA,aAAAW,SAAA,UACAK,GAAAgB,UAAA,aAAAR,GAAA,QAAA,WACAqS,aAAA7S,GAAA8B,OAAArB,MAAAuB,KAAA,YACAyR,IACAzU,EAAA,SAAA0B,IAAA,MAIA1B,EAAA,SAAA0W,cACAC,OAAA,SAAAC,EAAAtL,GACA,GAAAuL,GAAA7W,EAAAkF,IAAA0O,WAAA,SAAAkD,GACA,GAAA,IAAAA,EAAA3Q,cAAA4Q,QAAAH,EAAAI,KAAA7Q,eACA,MAAA2Q,IAGAxL,GAAAuL,IAUA/T,OAAA,SAAAoH,EAAA+M,GACApD,aAAAoD,EAAAC,KAAAhQ,MACAlH,EAAA,aAAAY,YAAA,UACA6T,MAiMA,IAAAS,GAAAV,YAAAzR,OAAA,KACAC,KAAA,QAAA,iBACAxC,MAAA,UAAA,OACA0U,GAAAnS,OAAA,UACAC,KAAA,IAAA,GACAkS,EAAAnS,OAAA,QACAC,KAAA,IAAA,GACAA,KAAA,KAAA,QAGA,IAAAuS,GAAAf,YAAAzR,OAAA,KACAC,KAAA,QAAA,mBACAxC,MAAA,UAAA,OACA+U,GAAAxS,OAAA,UACAC,KAAA,IAAA,GACAuS,EAAAxS,OAAA,QACAC,KAAA,IAAA,GACAA,KAAA,KAAA,QAGA,IAAA4S,GAAApB,YAAAzR,OAAA,KACAC,KAAA,QAAA,cACAxC,MAAA,UAAA,OACAoV,GAAA7S,OAAA,UACAC,KAAA,IAAA,GACA4S,EAAA7S,OAAA,QACAC,KAAA,IAAA,GACAA,KAAA,KAAA,QAGA,IAAAiT,GAAAzB,YAAAzR,OAAA,KACAC,KAAA,QAAA,iBACAxC,MAAA,UAAA,OACAyV,GAAAlT,OAAA,UACAC,KAAA,IAAA,GACAiT,EAAAlT,OAAA,QACAC,KAAA,IAAA,GACAA,KAAA,KAAA,QAGA,IAAAsT,GAAA9B,YAAAzR,OAAA,KACAC,KAAA,QAAA,eACAxC,MAAA,UAAA,OACA8V,GAAAvT,OAAA,UACAC,KAAA,IAAA,GACAsT,EAAAvT,OAAA,QACAC,KAAA,IAAA,GACAA,KAAA,KAAA,SAGAwR,YAAAzR,OAAA,QACAC,KAAA,QAAA,WACAA,KAAA,QAAA+Q,YACA/Q,KAAA,SAAAgR,aACAxS,GAAA,YAAA,WACA+T,EAAA/U,MAAA,UAAA,MACA0U,EAAA1U,MAAA,UAAA,MACAoV,EAAApV,MAAA,UAAA,MACAyV,EAAAzV,MAAA,UAAA,MACA8V,EAAA9V,MAAA,UAAA,QAGAgB,GAAA,WAAA,WACA+T,EAAA/U,MAAA,UAAA,QACA0U,EAAA1U,MAAA,UAAA,QACAoV,EAAApV,MAAA,UAAA,QACAyV,EAAAzV,MAAA,UAAA,QACA8V,EAAA9V,MAAA,UAAA,UAGAgB,GAAA,YAAAqT,KOj7BA7U,EAAAP,UAAAuK,MAAA,WA6HA,QAAAmN,oBAAAvQ,EAAAoH,GACAhO,EAAA,WAAAoX,QACApX,EAAA,WAAAqH,KAAA,WACAgQ,oBAAAzQ,EAAAoH,GACAhO,EAAA,oBAAA6B,KAAA,0HAAA+E,EAAAoH,GAAAsJ,IAAA,qCAAA1Q,EAAAoH,GAAAuJ,GAAA,yBAOA,QAAAF,qBAAAG,EAAA3X,GACA,GAAA4X,MACAC,EAAApH,KAAAqH,MAAAH,EAAA3X,GAAA0X,IACAK,EAAAtH,KAAAqH,MAAAH,EAAA3X,GAAAyX,IAEAO,YAAAC,oBAAA,UAAAF,EAAAF,EAAAF,EAAAC,EAAA5X,GACAkY,mBAAA,UAAAN,EAAA,GAGA,QAAAK,qBAAAE,EAAAJ,EAAAF,EAAAF,EAAAC,EAAA5X,GACA,IAAAoY,EAAA,EAAAA,EAAAP,EAAAO,IACAR,EAAAtU,KAAA,gDAAAqU,EAAA3X,GAAA0X,GAAA,WAEA,KAAAU,EAAA,EAAAA,EAAAL,EAAAK,IACAjY,EAAAgY,GAAAjV,OAAA,gDAAAyU,EAAA3X,GAAAyX,IAAA,WAEA,OAAAG,GAIA,QAAAM,oBAAAC,EAAAP,EAAA5X,GACAA,EAAAgY,WAAA/X,SACAE,EAAAgY,GAAAjV,OAAA0U,EAAA5X,IACAA,IACAkY,mBAAAC,EAAAP,EAAA5X,IAoHA,QAAAqY,aACA,MAAAzW,MAAAuL,WAGA,QAAAmL,UAAAhW,GACA,MAAAA,GAAA+E,MAIA,QAAAkR,QAAA3U,GACA,GAAA4U,GAAA,CAIA,OAHA5U,GAAAqD,QAAA,SAAAoQ,GACAmB,GAAAnB,EAAAhQ,QAEAmR,EAGA,QAAAC,UAAAnW,GAGA,QAAAoW,GAAA9P,GACA,MAAA+P,KAAA3Y,EAAA4I,IAGA,QAAAgQ,GAAAhQ,GAEA,MADAtG,GAAAuW,SAAA7Y,EAAA4I,GACA+P,IAAArW,GARA,GAAAtC,EAWA,OAAA,mBAAA4B,MAAAkX,UACA9Y,EAAAmB,GAAA4X,YAAAzW,EAAA0W,WAAA,GAAA1W,EAAAuW,UACAjX,KAAAkX,SAAAxW,EACAsW,IAEA5Y,EAAAmB,GAAA4X,YAAAnX,KAAAkX,SAAAxW,GACAV,KAAAkX,SAAA9Y,EAAA,GACA0Y,GAGA,QAAAO,gBAAA3W,GACA,MAAA,cAAAqW,IAAAO,SAAA5W,GAAA,IAGA,QAAA6W,MAAA7W,EAAAtC,GACA,MAAAwS,OAAAxS,GAGA,QAAAoZ,oBAAAC,GACA,GAAAC,GAAA,IAAAC,WACAF,GAAAG,UAAAH,EAAAR,SAAAQ,EAAAL,YAAA,EAAAK,EAAAL,UACA,IAAAhK,GAAAyB,KAAAgJ,IAAAJ,EAAAG,UAAAF,EACAtR,GAAAyI,KAAAiJ,IAAAL,EAAAG,UAAAF,CACA,OAAA,aAAAtK,EAAA,IAAAhH,EAAA,IAGA,QAAA2R,WAAA/V,MAUA,QAAAgW,YAAAtX,GACA,OAAAA,EAAA+E,MAAAwS,IAAA,KAAAC,QAAA,GAAA,IAGA,QAAAC,WAAAzX,GACA,MAAAA,GAAAsB,KAAA+P,KAAA,cAAArR,EAAAsB,KAAAyD,MAGA,QAAA2S,WAAA1X,GACA,GAAA2X,GAAA,KAAA3X,EAAA+E,MAAAwS,KACAK,EAAAzJ,KAAA0J,IAAAZ,YAAA,GAAAU,EAAA,GACA,OAAAC,GAAAzJ,KAAA0J,GAAAZ,YAAA,IAGA,QAAAa,WAAA9X,EAAAtC,GAIA,QAAAqa,SAAA/X,EAAAtC,GAEAoE,QAAAC,IAAA/B,EAAAsB,KAAA0W,QACAna,EAAA,mBAAA6B,KAAAM,EAAAsB,KAAA2W,aACApa,EAAA,UAAA6B,KAAAM,EAAAsB,KAAAyD,OACA,iBAAA/E,EAAAsB,KAAA0W,OACAna,EAAA,oBAAAgD,KAAA,MAAA,GAEAhD,EAAA,oBAAAgD,KAAA,MAAA,GAEAwU,eAAA6C,KAAAlY,EAAAsB,KAAA0W,QACAhD,mBAAAK,eAAAxJ,MAdAsM,cAAAza,EACAqa,QAAA/X,EAAAtC,EAiBA,IAAAqT,OAAAqH,eAAAvY,UAAA,WACAsR,OAAA,SAAA4F,EAAAsB,GACA,MAAA3a,KAAA2a,GAEAtH,OAAAlQ,KAAA,cACAkQ,MAAAjR,aACAC,SAAAuY,gBAAA,GACAzX,MACA0X,QAAA,EACAC,UAAA,kBAAAC,YAAA,GAAA/a,EAAA,MAKA0a,eAAAvY,UAAA,QACAsR,OAAA,SAAA4F,EAAAsB,GACA,MAAA3a,KAAA2a,IAEAvY,aACAC,SAAAuY,gBAAA,GACAzX,KAAA,YAAAiW,oBAEAsB,eAAAzX,OAAA,gBACAA,OAAA,WACAb,aACAC,SAAAuY,gBAAA,GACAzX,MACA0X,QAAA,EACAG,OAAA7B,KAAA,KAAAnZ,KAGA0a,eAAAzX,OAAA,gBACAA,OAAA,WACAb,aACAC,SAAAuY,gBAAA,GACAzX,MACA0X,QAAA,EACA1B,KAAAA,KAAA,KAAAnZ,KAGA0a,eAAAzX,OAAA,gBACAA,OAAA,QACAb,aACAC,SAAAuY,gBAAA,GACAzX,MACA0X,QAAA,EACAG,OAAA7B,KAAA,KAAAnZ,GACAib,GAAAxK,KAAAgJ,IAAAnX,EAAAkX,WAAA,GAAA0B,aACAlK,IAAAP,KAAAiJ,IAAApX,EAAAkX,WAAA,GAAA0B,aACA5I,GAAA7B,KAAAgJ,IAAAnX,EAAAkX,UAAA0B,YACAC,IAAA1K,KAAAiJ,IAAApX,EAAAkX,UAAA0B,cAGAR,eAAAzX,OAAA,gBACAA,OAAA,iBACAa,KAAAxB,EAAAsB,KAAA+P,MAEA1Q,OAAAoV,WACApV,OAAA,gBACAa,KAAAxB,EAAAsB,KAAAyD,OAGA,QAAA+T,YAAA9Y,EAAAtC,GAwBA,GAvBA0a,eAAAzX,OAAA,gBACAd,WAAA,UAAA,YACAC,aACAC,SAAAuY,gBAAA,GACAzX,MACA0X,QAAA,IAGAH,eAAAzX,OAAA,gBACAA,OAAA,QACAb,aACAC,SAAAuY,gBAAA,GACAzX,MACA0X,QAAA,IAGAH,eAAAzX,OAAA,gBACAA,OAAA,iBACAa,KAAA,IACAb,OAAAoV,WACApV,OAAA,gBACAa,KAAA,IAEA,mBAAA9D,GAAA,CAGA,GAAAqT,GAAAqH,eAAAvY,UAAA,WACAsR,OAAA,SAAA4F,EAAAsB,GACA,MAAA3a,KAAA2a,GAGAtH,GAAAlQ,KAAA,cACAkQ,EAAAjR,aACAC,SAAAuY,gBAAA,GACAzX,MACA0X,QAAA,EACAC,UAAA,iBAAAC,YAAA,GAAA/a,EAAA,MAIA0a,eAAAvY,UAAA,QACAsR,OAAA,SAAA4F,EAAAsB,GACA,MAAA3a,KAAA2a,IAEAvY,aACAC,SAAAuY,gBAAA,GACAzX,MACA2X,UAAA,oBAxJA,GAAAjB,KAAAtB,OAAA3U,KACAA,MAAAyX,IAAAzX,KACA,IAAA0X,MAAAZ,eAAAzX,OAAA,QACAd,UAAA,QACAyB,KAAAA,MAEA2X,QAAAD,KAAAnZ,UAAA,QAAAlC,OACAub,UAAAD,QAAAX,gBAAAA,gBAAA,CAqJAQ,cAGAE,KAAAzX,QACAX,OAAA,KACAC,KAAA,QAAA,OAEAxB,GAAA,QAAA,SAAAW,EAAAtC,GAGAya,eAAA,GACAW,WAAA,KAAAX,eAEAL,UAAA9X,EAAAtC,KAIAkD,OAAA,QACAC,MACAgW,KAAAA,OAEAhW,KAAA,IAAAwV,KAAAhY,MAAA,SAAA,SACAA,MAAA,eAAA,GACAsC,OAAAoV,WACA5E,OAAAuG,WACA9W,OAAA,QACAC,MACAsY,cAAA,QACAC,YAAA,OACAvC,KAAA,OACAwC,cAAA,WAIAL,KAAArY,OAAA,QACAb,aACAyS,MAAA,SAAAvS,EAAAtC,GACA,MAAAub,SAAA,EAAAC,UAAAxb,IAEAqC,SAAAmZ,WACAI,UAAA,IAAAnD,UAEA6C,KAAArY,OAAA,QACAa,KAAA8V,YACAxX,aACAC,SAAAuY,iBACAzX,MACA0Y,MAAA,gBACAf,UAAA7B,iBAGAqC,KAAAQ,OACAna,GAAA,aAAA,MACAA,GAAA,WAAA,MACAoa,QAIA,IAAAC,SAAAtB,eACAzX,OAAA,WACAd,UAAA,WACAyB,KAAAA,KAEAoY,SAAAnY,QACAX,OAAA,KACAvB,GAAA,QAAA,SAAAW,EAAAtC,GAGAya,eAAA,GACAW,WAAA,KAAAX,eAEAL,UAAA9X,EAAAtC,KAEAmD,KAAA,QAAA,UACAD,OAAA,QACAC,MACAJ,MAAAkZ,WACA3b,OAAAya,YACA5B,KAAAA,OAEAlW,OAAAoV,WACAnV,OAAA,QACAC,MACAuY,YAAA,OACAD,cAAA,QACAtC,KAAA,OACAnK,EAAAiN,WAAA,EACAjU,EAAA+S,YAAA,EAAA,IAEA9X,OAAAoV,WACAlV,MACA0X,QAAA,EACAC,UAAA,SAAAxY,EAAAtC,GACA,MAAA,kBAAA+a,YAAA,GAAA/a,EAAA,OAGAoC,aACAC,SAAAuY,iBACAzX,MACA0X,QAAA,EACAC,UAAA,SAAAxY,EAAAtC,GACA,MAAA,iBAAA+a,YAAA,GAAA/a,EAAA,OAIAgc,QAAAF,OACAna,GAAA,aAAA,MACAA,GAAA,WAAA,MACAwB,KAAA,aAAA,GACAf,aACAC,SAAAuY,gBAAA,GACAzX,MACA0X,QAAA,EACAC,UAAA,SAAAxY,EAAAtC,GACA,MAAA,mBAAA+a,YAAA,GAAA/a,EAAA,OAGA+b,SAIAC,QAAA/Y,OAAA,QAAAjB,KAAA+X,WAgBA,QAAAmC,aAAAtY,GACA+V,UAAA/V,GAhnBA,GAAAuY,gBACA1E,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAGA0E,SACA3E,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAGA2E,WACA5E,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAGA4E,OACA7E,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAEAD,IAAA,EACAC,GAAA,KAGA6E,YACA9E,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAGA8E,gBACA/E,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAEAD,IAAA,GACAC,GAAA,KAMAC,eAAAwE,aACAhO,KAAA,CACAmJ,oBAAAK,eAAAxJ,MACAhO,EAAA,gBAAAW,SAAA,UAQAX,EAAA,aAAAwB,GAAA,QAAA,WACAxB,EAAA,aAAAY,YAAA,UACAZ,EAAAyB,MAAAd,SAAA,UACAqN,KAAAlM,SAAA9B,EAAAyB,MAAAC,OACAyV,mBAAAK,eAAAxJ,KACA,IAAAsO,EACA,QAAAtO,MACA,IAAA,GACAsO,EAAA,yBACA,MACA,KAAA,GACAA,EAAA,uBACA,MACA,KAAA,GACAA,EAAA,uBACA,MACA,KAAA,GACAA,EAAA,uBAGAtc,EAAA,iBAAA6B,KAAAya,EAAAjW,eACArG,EAAA,iBAAA6B,KAAAya,IAgDA,IAAA9O,SACAnN,IAAA,GACAqN,OAAA,GACAC,KAAA,GACAF,MAAA,GAEA7K,MAAA,IAAA4K,OAAAG,KAAAH,OAAAC,MACAtN,OAAA,IAAAqN,OAAAnN,IAAAmN,OAAAE,OAEA6O,YAAA,GAAA3Z,MACAkZ,WAAA,GAAAS,YACA3B,YAAA,GAAAkB,WAEArB,gBAAA,IACArB,YAAAxW,MAAA2Z,YAAApc,QAAAyC,MAAA2Z,aAAA,EAAApc,OAAA,EACA4a,YAAA,GAAA3B,YAEAZ,IAAAxX,GAAA6B,IAAA2V,MACAuC,YAAAA,aACA3B,YAAAA,aAEA8B,IAAAla,GAAAwb,OACAtB,MACAuB,KAAA,MACAvV,MAAAiR,UACAU,WAAA,IAAAvI,KAAA0J,IACAtB,SAAA,IAAApI,KAAA0J,IAEAM,cACAjI,MAAArR,GAAAyB,MAAAwP,UACA1O,OAAA,UAAA,UAAA,UAAA,UAAA,UAAA,YAEAgX,eAAAvZ,GAAA8B,OAAA,aACAE,MACAJ,MAAAA,MAAA4K,OAAAG,KAAAH,OAAAC,MACAtN,OAAAA,OAAAqN,OAAAnN,IAAAmN,OAAAE,SAEA3K,OAAA,KACAC,MACA0Y,MAAA,SACAf,UAAA,cAAA/X,OAAA2Z,YAAA/O,OAAAC,QAAA,KAAAD,OAAAnN,IAAA,MAEAyC,OAAAoV,WACAnV,OAAA,KACAC,MACA0Y,MAAA,MACAf,UAAA,cAAAvB,YAAA5L,OAAAG,MAAA,MAAAxN,OAAA,EAAAqN,OAAAnN,KAAA,MAEAyC,OAAAoV,WACAnV,OAAA,KACAC,MACA0Y,MAAA,cACAf,UAAA,cAAAvB,YAAA5L,OAAAG,MAAA,MAAAyL,YAAA5L,OAAAnN,KAAA,MAEAyC,OAAAoV,UAEAqC,gBAAAzX,OAAA,gBACAC,OAAA,UACAC,MACA0Y,MAAA,SACAhB,QAAA,EACAG,OAAA,sBACA7B,KAAA,gBACA5V,EAAA,GAAA2X,cAEAjY,OAAAoV,WACAnV,OAAA,UACAC,MACA0Y,MAAA,SACAhB,QAAA,EACA1B,KAAA,sBACA5V,EAAA,GAAA2X,cAEAjY,OAAAoV,WACAnV,OAAA,QACAC,MACA0X,QAAA,EACAG,OAAA,sBACAC,GAAA,EACAjK,GAAA,EACAsB,GAAA,EACA6I,GAAA,IAEAlY,OAAAoV,WACAnV,OAAA,QACAC,MACA0Y,MAAA,eACAH,YAAA,OACA1T,GAAA,EAAAkT,YAAA,IACAO,cAAA,QACAE,cAAA,SACAkB,qBAAA,SACA1D,KAAA,SAGAlW,OAAAoV,WACAnV,OAAA,QACAC,MACA0Y,MAAA,cACAH,YAAA,OACA1T,EAAA,IAAAkT,YACAO,cAAA,QACAE,cAAA,SACAkB,qBAAA,SACA1D,KAAA,QAoVA,IAAA2D,YACAnJ,KAAA,SAAAtM,MAAA,IAAAiT,OAAA,SAAAC,YAAA,WACA5G,KAAA,WAAAtM,MAAA,IAAAiT,OAAA,WAAAC,YAAA,aACA5G,KAAA,oBAAAtM,MAAA,IAAAiT,OAAA,OAAAC,YAAA,6BACA5G,KAAA,sBAAAtM,MAAA,IAAAiT,OAAA,eAAAC,YAAA,wBACA5G,KAAA,YAAAtM,MAAA,GAAAiT,OAAA,YAAAC,YAAA,cACA5G,KAAA,gBAAAtM,MAAA,GAAAiT,OAAA,gBAAAC,YAAA,iBAGA2B,aAAAY,YC9mBA3c,EAAAP,UAAAuK,MAAA,WA6DA,QAAA4S,iBAAAzC,OAAAjT,OACAlH,EAAA,0BAAAY,YAAA,UACAZ,EAAA,IAAAma,QAAAxZ,SAAA,UACAX,EAAA,WAAAoX,QACAyF,iBAAAxC,KAAAF,SACAna,EAAA,iBAAA6B,KAAAib,WAAA5V,QAIA,QAAA2V,kBAAAE,GAEA,GAAAlF,KACA,KAAAhY,EAAA,EAAAA,EAAA,EAAAA,IAAA,CACA,GAAAmd,GAAA1M,KAAAqH,MAAAoF,EAAAld,GAAA,GAEAod,mBAAAC,iBAAA,UAAAF,EAAAD,EAAAlF,GAEAsF,gBAAA,UAAAF,kBAAA,GAGA,QAAAE,iBAAAnF,EAAAH,EAAAhY,GACAA,EAAAgY,EAAA/X,SACAE,EAAAgY,GAAAjV,OAAA8U,EAAAhY,IACAA,IAGAsd,gBAAAnF,EAAAH,EAAAhY,IAMA,QAAAqd,kBAAAlF,EAAAoF,EAAAL,EAAAlF,GACA,IAAAI,EAAA,EAAAA,EAAAmF,EAAAnF,IAEAJ,EAAA1U,KAAA,gCAAAtD,EAAA,eAAAkd,EAAAld,GAAA,GAAA,WAGA,OAAAgY,GAjGA,GAAAmE,gBACA,EAAA,IACA,KAAA,KACA,MAAA,KACA,MAAA,IACA,KAAA,KACA,EAAA,IAEAC,SACA,EAAA,IACA,KAAA,KACA,MAAA,KACA,MAAA,KACA,KAAA,KACA,EAAA,IAGAoB,QACA,IAAA,KACA,IAAA,KACA,IAAA,KACA,IAAA,KACA,IAAA,IACA,IAAA,IAMAP,YACA,0IAAAd,aAAA,GAAA,GAAA,kCAAAA,aAAA,GAAA,GAAA,0DAAAA,aAAA,GAAA,GAAA,kCAAAA,aAAA,GAAA,GAAA,sBACA,0IAAAC,OAAA,GAAA,GAAA,kCAAAA,OAAA,GAAA,GAAA,0DAAAA,OAAA,GAAA,GAAA,kCAAAA,OAAA,GAAA,GAAA,sBACA,8KAAAoB,MAAA,GAAA,GAAA,qCAAAA,MAAA,GAAA,GAAA,qCAAAA,MAAA,GAAA,GAAA,6DAAAA,MAAA,GAAA,GAAA,qCAAAA,MAAA,GAAA,GAAA,qCAAAA,MAAA,GAAA,GAAA,uBAIAN,YAAAf,YAIAa,kBAAAb,cACAhc,EAAA,iBAAA6B,KAAAib,WAAA,IACA9c,EAAA,iBAAAW,SAAA,UAGAX,EAAA,mBAAA4F,MAAA,WACA,GAAA0X,SAAAtd,EAAAyB,MAAAgC,KAAA,UACA8Z,OAAAlD,KAAAra,EAAAyB,MAAAC,MACAkb,iBAAAU,QAAAC,UAIAvd,EAAA,eAAA4F,MAAA,WACA,GAAA0X,SAAAtd,EAAAyB,MAAAuB,KAAA,MACAua,OAAAlD,KAAAra,EAAAyB,MAAAC,MACAkb,iBAAAU,QAAAC,YCzDA,WA8IA,QAAAC,GAAA/Z,EAAAga,GAEA,MAAAha,GAAAgZ,KAAA,SAAA/T,EAAAuP,GACA,MAAAA,GAAAwF,GAAA/U,EAAA+U,KAOA,QAAAC,GAAAja,EAAAga,GAEA,GAAA3N,GAAA9O,GAAA8O,IAAArM,EAAA,SAAAtB,GACA,OAAAA,EAAAsb,IAGAxP,QAAAjN,GAAAyB,MAAA2P,SACA9O,QAAA,EAAAwM,IACAvM,OAAA,EAAAX,IAEAsL,OAAAlN,GAAAyB,MAAAwP,UACA3O,OAAAtC,GAAAuC,MAAAE,EAAA3D,SACA6d,YAAA,EAAAxd,GAAA,GAKA,IAAAyd,GAAAC,EAAA7b,UAAA,YACAyB,KAAAA,EAAA,SAAAtB,GACA,MAAAA,GAAA2b,aAIAC,EAAA/c,GAAAyB,MAAAwP,UACA1O,OAAA,UAAA,YACAya,EAAAhd,GAAAyB,MAAAwP,UACA1O,OAAA,OAAA,WAEA0a,EAAAJ,EAAA7b,UAAA,oBACAyB,KAAAya,QAAAvV,SACAjF,QAAAX,OAAA,KACAC,KAAA,QAAA,mBACAA,KAAA,YAAA,SAAAb,EAAAtC,GACA,MAAA,gBAAAM,EAAA,EAAAqN,EAAA,GAAA3N,GAAA,KAGAoe,GAAAlb,OAAA,QACAC,KAAA,IAAAJ,EAAA,IACAI,KAAA,QAAA,IACAA,KAAA,SAAA,IACAxC,MAAA,OAAAud,GAGAE,EAAAlb,OAAA,QACAC,KAAA,IAAAJ,EAAA,GACAI,KAAA,IAAA,GACAA,KAAA,KAAA,SACAxC,MAAA,cAAA,SACAmD,KAAAqa,GAOAJ,EAAAla,QACAX,OAAA,QACAC,KAAA,QAAA,OAIA4a,EAAAjC,OACA1Z,aACAC,SAAA,KACAic,KAAA,OACAnb,KAAA,QAAA,GACA4Y,SAIAgC,EACA3b,aACAC,SAAA,KACAic,KAAA,QACAnb,KAAA,QAAA,SAAAb,GACA,MAAA8L,SAAA9L,EAAAsb,MAEAza,KAAA,SAAAkL,OAAAkQ,aACApb,KAAA,YAAA,SAAAb,EAAAtC,GACA,MAAA,cAAA,EAAA2N,EAAAU,OAAArO,IAAA,MAEAmD,KAAA,QAAA,SAAAb,EAAAtC,GACA,MAAA,SAAAsC,EAAAkc,QAAA,aAAAlc,EAAA8E,IACA,yBACA,WAAA9E,EAAAkc,QAAA,aAAAlc,EAAA8E,IACA,yBACA,WAAA9E,EAAAkc,QAAA,aAAAlc,EAAA8E,IACA,yBACA,SAAA9E,EAAAkc,QAAA,aAAAlc,EAAA8E,IACA,yBACA,WAAA9E,EAAAkc,OACA,eACA,SAAAlc,EAAAkc,OACA,eADA,QAmBA,IAAAC,GAAAT,EAAA7b,UAAA,eACAyB,KAAAA,EAAA,SAAAtB,GACA,MAAAA,GAAA2b,aAGAS,EAAAV,EAAA7b,UAAA,gBACAyB,KAAAA,EAAA,SAAAtB,GACA,MAAAA,GAAA2b,YAKAQ,GAAA5a,QACAX,OAAA,QACAC,KAAA,QAAA,UACAsb,EAAA3C,OACAC,SAEA2C,EAAA7a,QACAX,OAAA,QACAC,KAAA,QAAA,WACAub,EAAA5C,OACAC,SAEA4C,aAAAxd,GAAAwE,OAAA,OACAiZ,iBAAAzd,GAAAwE,OAAA,OACAkZ,WAAA1d,GAAAwE,OAAA,OAEA8Y,EAAArc,aACAC,SAAA,KACAc,KAAA,YAAA,SAAAb,EAAAtC,GAGA,MAFAoE,SAAAC,IAAA+J,QAAA9L,EAAAsb,IAAA,IACAxZ,QAAAC,IAAA/B,EAAAsb,IACA,cAAAxP,QAAA9L,EAAAsb,IAAAjQ,GAAA,KAAAU,OAAArO,GAAA,GAAA,MAEA8D,KAAA,SAAAxB,GAEA,MAAA,sBAAAsb,GAAA,OAAAtb,EAAA8E,IACA,MAEA,sBAAAwW,GAAA,OAAAtb,EAAA8E,IACAwX,iBAAAtc,EAAAsb,IAAA,IAEA,sBAAAA,EACAe,aAAArc,EAAAsb,IAEAiB,WAAAvc,EAAAsb,MAGAza,KAAA,KAAA,SACAA,KAAA,KAAA,OACAA,KAAA,cAAA,SAEAub,EAAAtc,aACAC,SAAA,KACAc,KAAA,YAAA,SAAAb,EAAAtC,GAEA,MAAA,gBAAAqO,OAAArO,GAAA,GAAA,MAEA8D,KAAA,SAAAxB,GACA,MAAAA,GAAA8E,MAEAjE,KAAA,KAAA,SACAA,KAAA,KAAA,OACAA,KAAA,cAAA,SArUA,GAAAJ,GAAA,IACAzC,EAAA,IACAqN,EAAA,GAOAqQ,EAAA7c,GAAA8B,OAAA,kBAAAC,OAAA,OACAC,KAAA,QAAAJ,EAAA,KACAI,KAAA,SAAA7C,EAAA,GACA0d,GAAA9a,OAAA,QACAC,KAAA,QAAA,QACAA,KAAA,SAAA,QACAA,KAAA,OAAA,QAIAhC,GAAAkO,IAAA,uBAAA,SAAA9N,EAAAqC,GAEA,GAAAkb,GAAA,qBAEAlP,EAAA+N,EAAA/Z,EAAAkb,EAIAjB,GAAAjO,EAAAkP,GAEA3d,GAAA8B,OAAA,QAAA4C,QAAA,YAAA,GACA1F,EAAA,QAAAW,SAAA,UAEAK,GAAA8B,OAAA,QACAtB,GAAA,QAAA,SAAAW,EAAAtC,GACA8e,EAAA,qBACAlP,EAAA+N,EAAA/Z,EAAAkb,GACAjB,EAAAjO,EAAAkP,EACA,IAAAC,GAAA5d,GAAA8B,OAAArB,KACAT,IAAAgB,UAAA,uBAAA0D,QAAA,YAAA,GACA1F,EAAA,uBAAAY,YAAA,UAEAI,GAAAgB,UAAA,cAAA0D,QAAA,YAAA,GACA1F,EAAA,cAAAY,YAAA,UAEAge,EAAAlZ,QAAA,YAAA,GACA1F,EAAAyB,MAAAd,SAAA,YAEAK,GAAA8B,OAAA,OACAtB,GAAA,QAAA,SAAAW,EAAAtC,GACA8e,EAAA,YACAlP,EAAA+N,EAAA/Z,EAAAkb,GACAjB,EAAAjO,EAAAkP,EACA,IAAAC,GAAA5d,GAAA8B,OAAArB,KACAT,IAAAgB,UAAA,uBAAA0D,QAAA,YAAA,GACA1F,EAAA,uBAAAY,YAAA,UAEAI,GAAAgB,UAAA,cAAA0D,QAAA,YAAA,GACA1F,EAAA,cAAAY,YAAA,UAEAge,EAAAlZ,QAAA,YAAA,GACA1F,EAAAyB,MAAAd,SAAA,YAEAK,GAAA8B,OAAA,QACAtB,GAAA,QAAA,SAAAW,EAAAtC,GACA8e,EAAA,qBACAlP,EAAA+N,EAAA/Z,EAAAkb,GACAjB,EAAAjO,EAAAkP,EACA,IAAAC,GAAA5d,GAAA8B,OAAArB,KACAT,IAAAgB,UAAA,uBAAA0D,QAAA,YAAA,GACA1F,EAAA,uBAAAY,YAAA,UAEAI,GAAAgB,UAAA,cAAA0D,QAAA,YAAA,GACA1F,EAAA,cAAAY,YAAA,UAEAge,EAAAlZ,QAAA,YAAA,GACA1F,EAAAyB,MAAAd,SAAA,YAIAK,GAAA8B,OAAA,cACAtB,GAAA,QAAA,SAAAW,EAAAtC,GAIA,GAAA+e,GAAA5d,GAAA8B,OAAArB,KAIAmd,GAAAlZ,QAAA,YAAA,GACA1F,EAAAyB,MAAAd,SAAA,UAEAK,GAAAgB,UAAA,uBACA0D,QAAA,eAAA,GACA1E,GAAAgB,UAAA,uBACA0D,QAAA,eAAA,GAEA1E,GAAAgB,UAAA,uBACA0D,QAAA,eAAA,GACA1E,GAAAgB,UAAA,uBACA0D,QAAA,eAAA,KAIA1E,GAAA8B,OAAA,cACAtB,GAAA,QAAA,SAAAW,EAAAtC,GAIA,GAAA+e,GAAA5d,GAAA8B,OAAArB,KAIAmd,GAAAlZ,QAAA,YAAA,GACA1F,EAAAyB,MAAAd,SAAA,UAEAK,GAAAgB,UAAA,uBACA0D,QAAA,eAAA,GACA1E,GAAAgB,UAAA,uBACA0D,QAAA,eAAA,GAEA1E,GAAAgB,UAAA,uBACA0D,QAAA,eAAA,GACA1E,GAAAgB,UAAA,uBACA0D,QAAA,eAAA,UR7HA+J,UACAoP,OAAA,MAAAC,KAAA,KAAAC,KAAA,OACAF,OAAA,qBAAAC,KAAA,KAAAC,KAAA,OACAF,OAAA,qBAAAC,KAAA,KAAAC,KAAA,OACAF,OAAA,WAAAC,KAAA,KAAAC,KAAA,MAGA,IAAA1M,OAAArR,GAAAyB,MAAAwP,UACA1O,OAAA,UAAA,YACAiK,QAAAnN,IAAAyB,SAAAd,GAAA8B,OAAA,yBAAAtC,MAAA,SAAA,IAAA,GAAAiN,MAAA3L,SAAAd,GAAA8B,OAAA,yBAAAtC,MAAA,SAAA,IAAA,GAAAkN,OAAA5L,SAAAd,GAAA8B,OAAA,yBAAAtC,MAAA,SAAA,IAAA,EAAAmN,KAAA7L,SAAAd,GAAA8B,OAAA,yBAAAtC,MAAA,SAAA,IAAA,IACAoC,MAAAd,SAAAd,GAAA8B,OAAA,yBAAAtC,MAAA,SAAA,IAAAgN,OAAAG,KAAAH,OAAAC,MACAtN,OAAA2B,SAAAd,GAAA8B,OAAA,yBAAAtC,MAAA,UAAA,IAAAgN,OAAAnN,IAAAmN,OAAAE,OAEAsD,GAAAhQ,GAAAyB,MAAAwP,UACA+M,iBAAA,EAAApc,OAAA,IAEAkY,GAAA9Z,GAAAyB,MAAAwP,UAEApK,EAAA7G,GAAAyB,MAAA2P,SACA7O,OAAApD,OAAA,IAQA8e,WAAAje,GAAA6B,IAAAwL,OACA5L,MAAAuO,IACA1C,OAAA,UAEA4Q,WAAAle,GAAA6B,IAAAwL,OACA5L,MAAAoF,GACAyG,OAAA,QACAE,WAAAxN,GAAAwE,OAAA,QAEA2Z,mBAAAne,GAAA8B,OAAA,yBAAAC,OAAA,OAAAC,KAAA,QAAA,mBAGAoc,WAAApe,GAAA8B,OAAA,yBAAAC,OAAA,OACAC,KAAA,QAAAJ,MAAA4K,OAAAG,KAAAH,OAAAC,OACAzK,KAAA,SAAA7C,OAAAqN,OAAAnN,IAAAmN,OAAAE,QACA3K,OAAA,KACAC,KAAA,YAAA,aAAAwK,OAAAG,KAAA,IAAAH,OAAAnN,IAAA,KAMA6d,QAAAld,GAAA6F,KAAA4I,QAAA,IAAA6D,OAAA,SAAAvM,GACA,MAAA,WAAAA,GAGA0I,SAAA3I,QAAA,SAAA3E,GACAA,EAAAgF,OAAA+W,QAAAhZ,IAAA,SAAAsO,GACA,OAAAA,KAAAA,EAAAtM,OAAA/E,EAAAqR,QAIAxC,GAAA1N,OAAAmM,QAAAvK,IAAA,SAAA/C,GACA,MAAAA,GAAA0c,UAEA/D,GAAAxX,OAAA4a,SAAAc,iBAAA,EAAAhO,GAAAoN,cACAvW,EAAAvE,QAAA,EAAAtC,GAAA8O,IAAAL,QAAA,SAAAtN,GACA,MAAAnB,IAAA8O,IAAA3N,EAAAgF,OAAA,SAAAhF,GACA,MAAAA,GAAA+E,YAIAkY,WAAArc,OAAA,KACAC,KAAA,QAAA,eACAA,KAAA,YAAA,gBAAA7C,OAAA,KACAyI,KAAAqW,YACAjd,UAAA,cACA4G,KAAAxB,KAAA4J,GAAAoN,aAEAgB,WAAArc,OAAA,KACAC,KAAA,QAAA,eACA4F,KAAAsW,YACAnc,OAAA,QACAC,KAAA,YAAA,eACAA,KAAA,KAAA,IACAA,KAAA,KAAA,SACAxC,MAAA,cAAA,OACAmD,KAAA,iCAEA,IAAA0b,KAAAD,WAAApd,UAAA,QACAyB,KAAAgM,SACA/L,QAAAX,OAAA,KACAC,KAAA,QAAA,QACAA,KAAA,YAAA,SAAAb,GACA,MAAA,cAAA6O,GAAA7O,EAAA0c,QAAA,IAAA,OAIAQ,KAAArd,UAAA,QACAyB,KAAA,SAAAtB,GACA,MAAAA,GAAAgF,SAEAzD,QAAAX,OAAA,QACAC,KAAA,QAAA8X,GAAAsD,aACApb,KAAA,IAAA,SAAAb,GACA,MAAA2Y,IAAA3Y,EAAAqR,MAAA,IAEAxQ,KAAA,IAAA,SAAAb,GACA,MAAA0F,GAAA1F,EAAA+E,SAEAlE,KAAA,QAAA,SAAAb,GACA,MAAAA,GAAAqR,OAEAxQ,KAAA,SAAA,SAAAb,GACA,MAAAhC,QAAA0H,EAAA1F,EAAA+E,SAEA1G,MAAA,OAAA,SAAA2B,GACA,MAAAkQ,OAAAlQ,EAAAqR,QAEAhT,MAAA,OAAA,SAAA2B,GACA,MAAAkQ,OAAAlQ,EAAAqR,QAQA6L,IACA7d,GAAA,YAAA,SAAAW,GACAgd,mBAAA3e,MAAA,OAAAQ,GAAAkJ,MAAAgH,MAAAlR,EAAA,yBAAAC,SAAA0N,KAAA,MACAwR,mBAAA3e,MAAA,MAAAQ,GAAAkJ,MAAA+G,MAAAjR,EAAA,yBAAAC,SAAAI,IAAA,MACA8e,mBAAA3e,MAAA,UAAA,eACA,IAEA8e,IAFAte,GAAAkJ,MAAAgH,MACAlQ,GAAAkJ,MAAA+G,MACAxR,SAAAC,iBAAA,UACA6f,GAAAD,EAAAxf,OACAyf,GAAA,EACAC,YAAAF,EAAAC,GAAAE,SAEAN,mBAAAtd,KAAA,SAAA2d,YAAA,MAAA,aAIAH,IACA7d,GAAA,WAAA,SAAAW,GACAgd,mBAAA3e,MAAA,UAAA,SAKA,IAAAkf,QAAAN,WAAApd,UAAA,WACAyB,KAAAya,QAAAvV,SACAjF,QAAAX,OAAA,KACAC,KAAA,QAAA,UACAA,KAAA,YAAA,SAAAb,EAAAtC,GACA,MAAA,eAAA,GAAAA,EAAA,KAGA6f,QAAA3c,OAAA,QACAC,KAAA,IAAAJ,MAAA,IACAI,KAAA,QAAA,IACAA,KAAA,SAAA,IACAxC,MAAA,OAAA6R,OAEAqN,OAAA3c,OAAA,QACAC,KAAA,IAAAJ,MAAA,IACAI,KAAA,IAAA,GACAA,KAAA,KAAA,SACAxC,MAAA,cAAA,OACAmD,KAAA,SAAAxB,GACA,MAAAA","file":"main.js","sourcesContent":["// Create HTML5 elements for IE\r\n\r\ndocument.createElement(\"article\");\r\ndocument.createElement(\"section\");\r\n\r\nvar speed = -80;\r\nparallax(speed);\r\n\r\nfunction parallax(speed) {\r\n\r\n    var parallax = document.querySelectorAll(\".parallax\");\r\n    // console.log(parallax[0]);\r\n\r\n    window.onscroll = function() {\r\n        for (var i = 0; i < parallax.length; i++) {\r\n\r\n            //var position = $(el).position();\r\n            // var offset = [];\r\n            var $offset = $(parallax[i]).offset();\r\n            //console.log(offset);\r\n            var $windowHeight = window.height;\r\n            var $windowYOffset = window.pageYOffset / $offset.top;\r\n            // $windowYOffset[0] = 0;\r\n            //       console.log($windowYOffset);\r\n            //console.log('windowYOffset: pageYOffset (' + window.pageYOffset + ') / ( window.height (' + window.height + ') - offset.top ( ' + offset.top + ' ) = ' + windowYOffset);\r\n            // console.log(el+\",\"+i);\r\n\r\n            var extraY = [0, -10, -60, -40, 0, -20];\r\n\r\n            var elBackgrounPos = [];\r\n\r\n            elBackgrounPos[i] = \"50% \" + (extraY[i] + $windowYOffset * speed) + \"%\";\r\n\r\n            //console.log(elBackgrounPos);\r\n\r\n            parallax[i].style.backgroundPosition = elBackgrounPos[i];\r\n        };\r\n    };\r\n\r\n};\r\n\r\n\r\n\r\n\r\n\r\n/////////////////////////////NAV\r\nfunction collapseNavbar() {\r\n    if ($(\".navbar\").offset().top > 50) {\r\n        $(\".navbar-fixed-top\").addClass(\"top-nav-collapse\");\r\n    } else {\r\n        $(\".navbar-fixed-top\").removeClass(\"top-nav-collapse\");\r\n    }\r\n}\r\n\r\n$(window).scroll(collapseNavbar);\r\n$(document).ready(collapseNavbar);\r\n\r\n// jQuery for page scrolling feature - requires jQuery Easing plugin\r\n$(function() {\r\n    $('a.page-scroll').bind('click', function(event) {\r\n        var $anchor = $(this);\r\n        $('html, body').stop().animate({\r\n            scrollTop: $($anchor.attr('href')).offset().top\r\n        }, 1500, 'easeInOutExpo');\r\n        event.preventDefault();\r\n    });\r\n});\r\n\r\n// Closes the Responsive Menu on Menu Item Click\r\n$('.navbar-collapse ul li a').click(function() {\r\n    if ($(this).attr('class') != 'dropdown-toggle active' && $(this).attr('class') != 'dropdown-toggle') {\r\n        $('.navbar-toggle:visible').click();\r\n    }\r\n});\r\n\r\n\r\n//when scrolling...\r\n$(window).scroll(function() {\r\n    if ($(window).scrollTop() >= 400) {\r\n        $(\"#navigation\").addClass(\"navbar-fixed-top\");\r\n    } else {\r\n        $(\"#navigation\").removeClass(\"navbar-fixed-top\");\r\n    };\r\n\r\n\r\n    $('.target').each(function() {\r\n        if ($(window).scrollTop() >= ($(this).offset().top) - 10) {\r\n            var $id = $(this).attr('id');\r\n            $('#navigation li').removeClass('active');\r\n            $('#navigation li[id=' + $id + '1]').addClass('active');\r\n\r\n            var $current = $(this).attr('data-index');\r\n            // var $current = $(this).find('.section-title').text();\r\n            $('#current-section').html($current);\r\n        }\r\n    });\r\n\r\n});\r\n\r\n$(\"#navigation li\").on('click', function() {\r\n    $(this).parent().find(\"li\").removeClass(\"active\");\r\n    $(this).addClass(\"active\");\r\n});\r\n\r\n\r\n\r\n$('a[href*=#]:not([href=#])').click(function() {\r\n    if (location.pathname.replace(/^\\//, '') == this.pathname.replace(/^\\//, '') || location.hostname == this.hostname) {\r\n\r\n        var target = $(this.hash);\r\n        target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');\r\n        if (target.length) {\r\n            $('html,body').animate({\r\n                scrollTop: target.offset().top\r\n            }, 500);\r\n            return false;\r\n        }\r\n    }\r\n    // });\r\n\r\n\r\n});\r\n\r\n\r\n/////////////////////////////Accordion\r\n// $(function() {\r\n//     var icons = {\r\n//         header: \"iconClosed\",\r\n//         activeHeader: \"iconOpen\",\r\n//         hoverHeader: 'iconHover'\r\n\r\n//     };\r\n//     $(\"#accordion\").accordion({\r\n//         icons: icons,\r\n//         heightStyle: \"content\"\r\n//     });\r\n// });\r\n\r\n/////////////////////////////Pills\r\n\r\n$('#pills-first a').click(function(e) {\r\n    e.preventDefault()\r\n    $(this).tab('show')\r\n});\r\n\r\n\r\n/////////////////////////////Video Links\r\n\r\n$('.js-play-video').click(function() {\r\n    var $target = $($(this).data('target'));\r\n    if($target.get(0)) {\r\n        $target.get(0).play();\r\n    }\r\n});\r\n\r\n/////////////////////////////SVG Infographic\r\n$(function() {\r\n    $(\"#odInfographic\").load('img/human1.svg', function(response) {\r\n        var val_svg = '2/3';\r\n        asignVal_svg(val_svg);\r\n\r\n        function asignVal_svg(val) {\r\n            $('.btn-svg').removeClass('active');\r\n            $('.btn-svg[value=\"' + val + '\"]').addClass('active');\r\n            if (val == '1/12') {\r\n                $('.svg-studyperiod').attr(\"opacity\", 0);\r\n                $('.svg-onemonth').attr(\"opacity\", 1);\r\n                $('#odInfographic_details').html('Only about '+ '<strong>1 in 12</strong>' +' people who died from opioids had an active opioid prescription a month before they died')\r\n            } else {\r\n                $('.svg-studyperiod').attr(\"opacity\", 1);\r\n                $('#odInfographic_details').html('About '+ '<strong>8 in 12</strong>' +' people who died from opioids had an opioid prescription at some point during the study period')\r\n            }\r\n        }\r\n\r\n        $('.btn-svg').on('click', function() {\r\n            asignVal_svg($(this).val());\r\n        });\r\n\r\n        $('.controls-svg').on('click', function() {\r\n            asignVal_svg($(this).data('select'));\r\n        });\r\n    });\r\n});\r\n","$(document).ready(function() {\r\n    app();\r\n    app2();\r\n});\r\n\r\nfunction app() {\r\n    queue()\r\n        //should be town polym data\r\n        .defer(d3.json, \"js/data/TOWN.geo.json\")\r\n        //.defer(d3.json, \"us_states_5m.geo.json\")\r\n        //should be opioid death data\r\n        .defer(d3.json, \"js/data/TOWN.geo.json\")\r\n        //.defer(d3.csv, \"us_pop.csv\")\r\n        .awaitAll(generateMap);\r\n}\r\n\r\nfunction generateMap(error, results) {\r\n\r\n    //should be town polym data\r\n    var maTowns = results[0];\r\n    //var usStates = results[0];\r\n    //should be opioid death data\r\n    var maOpioid = results[1];\r\n    //var usPop = results[1];\r\n    // The data in usStates is in alpha-order by state, as is the data in usPop.\r\n    // The ASSERT test below is just a sanity-check for possible corruption.\r\n\r\n    var i;\r\n    for (i = 0; i < maTowns.features.length; i++) {\r\n        //for (i = 0; i < usStates.features.length; i++) {  \r\n        // Assert test.\r\n        if (maTowns.features[i].properties.town != maOpioid.features[i].TOWN) {\r\n            //if (usStates.features[i].properties.NAME !== usPop[i].State) {\r\n            console.log('ASSERT failure for index: ' + i);\r\n            console.log(maTowns.features[i].properties.town + ' mismatch with ' + maOpioid.features[i].TOWN);\r\n            //console.log(usStates.features[i].properties.NAME + ' mismatch with ' + usPop[i].State);\r\n            alert('Input data corrupted: generation of map terminated.');\r\n            return;\r\n        }\r\n        maTowns.features[i].properties.OPIOIDSTATS = maOpioid.features[i].properties;\r\n        //usStates.features[i].properties.POPSTATS = usPop[i];\r\n    }\r\n\r\n    var width = 960,\r\n        height = 500;\r\n\r\n    var svgContainer = d3.select(\"#map_death\").append(\"svg\")\r\n        .attr(\"width\", width)\r\n        .attr(\"height\", height)\r\n        .style(\"border\", \"0px solid steelblue\");\r\n\r\n    var opChgScale = d3.scale.threshold()\r\n        //popChgScale = d3.scale.threshold()\r\n        .domain([0.01, 6.9, 15.9, 31.5, Infinity])\r\n        .range(colorbrewer.Blues[5]);\r\n    //.range(colorbrewer.Greens[10]);\r\n    opChgScale.domainStrings = function() {\r\n        return (['< 0.01', '0.01-6.9', '6.9-15.9',\r\n            '15.9-31.5', '>31.5'\r\n        ]);\r\n    };\r\n\r\n    var projection = d3.geo.conicConformal()\r\n        .parallels([41 + 43 / 60, 42 + 41 / 60])\r\n        .rotate([71 + 30 / 60, -41])\r\n        .scale([11000])\r\n        .translate([480, 500]);\r\n    //var projection = d3.geo.albersUsa()\r\n    //.scale(1280)\r\n    //.translate([width / 2, height / 2]);\r\n\r\n    var geoPath = d3.geo.path()\r\n        .projection(projection);\r\n\r\n\r\n\r\n    var map = svgContainer.selectAll(\"path\")\r\n        .data(maTowns.features)\r\n        .enter()\r\n        .append(\"path\")\r\n        .attr(\"d\", function(d, i) {\r\n            return geoPath(d);\r\n        })\r\n        .on('mousemove', function(d) {\r\n            var mouse = d3.mouse(svgContainer.node()).map(function(d) {\r\n                return parseInt(d);\r\n            });\r\n\r\n            var string_base = \"yr\"\r\n            currentvalue = string_base.concat(currentyear);\r\n\r\n            var currentrate\r\n\r\n            if (d.properties[currentvalue] > 0) {\r\n                currentrate = d3.format(\".1f\")(d.properties[currentvalue]);\r\n            } else if (d.properties[currentvalue] == 0) {\r\n                currentrate = d3.format(\".0f\")(d.properties[currentvalue]);\r\n            } else {\r\n                currentrate = \"N/A*\";\r\n            }\r\n\r\n            tooltip.classed('hidden', false)\r\n                .attr('style', 'left:' + (mouse[0] + 15) +\r\n                    'px !important; top:' + (mouse[1] + 75) + 'px !important')\r\n                .html(\"<b>\" + toTitleCase(d.properties.TOWN) + \"</b> | \" + currentrate);\r\n        })\r\n\r\n    .on('mouseover', function(d, i) {\r\n\r\n            var currentState = this;\r\n            d3.select(this).style('fill-opacity', 0.25)\r\n                .style(\"stroke\", \"white\")\r\n                .style(\"stroke-width\", \"2px\");\r\n        })\r\n        .on('mouseout', function(d, i) {\r\n            tooltip.classed('hidden', true);\r\n            d3.selectAll('path')\r\n                .style(\"fill-opacity\", 1)\r\n                .style(\"stroke\", \"#2f363d\")\r\n                .style(\"stroke-width\", \"0.1px\");\r\n        })\r\n        .style(\"stroke\", \"#2f363d\")\r\n        .style(\"stroke-width\", \"0.1px\")\r\n        .style(\"fill\", \"white\");\r\n\r\n    var aYears = [\r\n        [2000, 2001],\r\n        [2001, 2002],\r\n        [2002, 2003],\r\n        [2003, 2004],\r\n        [2004, 2005],\r\n        [2005, 2006],\r\n        [2006, 2007],\r\n        [2007, 2008],\r\n        [2008, 2009],\r\n        [2010, 2011],\r\n        [2011, 2012],\r\n        [2012, 2013],\r\n        [2013, 2014],\r\n        [2014, 2014.5]\r\n    ];\r\n\r\n    var index = 0;\r\n\r\n\r\n    getYear();\r\n    generateLegend(opChgScale, 'legend_death', 'Unintentional Opioid Deaths per 100,000 people');\r\n    //generateLegend(popChgScale, 'legend', 'Population Change (percent)');\r\n\r\n    // Bind timer event handler.\r\n    // var timerInterval = 1000;\r\n    // // var id = setInterval(setSymbology, timerInterval);\r\n\r\n\r\n\r\n\r\n    //queryVariable\r\n\r\n    // function getQueryVariable(variable)\r\n    // {\r\n    //        var query = window.location.search.substring(1);\r\n    //        var vars = query.split(\"&\");\r\n    //        for (var i=0;i<vars.length;i++) {\r\n    //                var pair = vars[i].split(\"=\");\r\n    //                if(pair[0] == variable){return pair[1];}\r\n    //        }\r\n    //        return(false);\r\n    // }\r\n    $('.controls-map').click(function() {\r\n        $(\"#timeline\").val($(this).data('select'));\r\n        setSymbology($(this).data('select'));\r\n    });\r\n\r\n    function getYear() {\r\n        setSymbology(2000);\r\n        $(\"#timeline\").on('input change', function() {\r\n            setSymbology($(this).val());\r\n        });\r\n    };\r\n\r\n    function setSymbology(year) {\r\n\r\n        var szAttr = 'yr' + year;\r\n        $('#titlePrefix').html('Unintentional Opiod Overdose Deaths in Massachusetts from');\r\n        $('#fromYear1').html(year);\r\n        $('#titleMidfix1').html(' to ');\r\n        $('#toYear').html(parseInt(year) + 1);\r\n\r\n        svgContainer.selectAll(\"path\")\r\n            .transition()\r\n            .duration(500)\r\n            .style(\"fill\", function(d, i) {\r\n\r\n                var delta = +d.properties.OPIOIDSTATS[szAttr];\r\n                //var delta = +d.properties.POPSTATS[szAttr];\r\n                return (delta === -9999) ? '#f1f1f1' : opChgScale(delta);\r\n                //return (delta === -9999) ? '#e8e8e8' : popChgScale(delta);    \r\n            });\r\n    } // setSymbology()\r\n\r\n    function generateLegend(scale, szDivId, szCaption) {\r\n        var width = 550,\r\n            height = 80;\r\n\r\n        var svg = d3.select('#' + szDivId).append(\"svg\")\r\n            .attr(\"width\", width)\r\n            .attr(\"height\", height);\r\n\r\n        var g = svg.append(\"g\");\r\n\r\n        // Create data array.\r\n        var legendData = [];\r\n        legendData.push({ d: -9999, r: '#f1f1f1', s: 'N/A' });\r\n        var i;\r\n        for (i = 0; i < scale.domain().length; i++) {\r\n            legendData.push({ d: scale.domain()[i], r: scale.range()[i], s: scale.domainStrings()[i] });\r\n        }\r\n\r\n        g.selectAll(\"rect\")\r\n            .data(legendData)\r\n            .enter().append(\"rect\")\r\n            .attr(\"height\", 20)\r\n            .attr(\"width\", 50)\r\n            .attr(\"x\", function(d, i) {\r\n                return i * 55;\r\n            })\r\n            .attr(\"y\", 20)\r\n            .style(\"stroke\", \"black\")\r\n            .style(\"stroke-width\", \"0.25px\")\r\n            .style(\"fill\", function(d, i) {\r\n                return d.r;\r\n            });\r\n\r\n        g.selectAll(\"text\")\r\n            .data(legendData)\r\n            .enter().append(\"text\")\r\n            .attr(\"x\", function(d, i) {\r\n                return i * 55;\r\n            })\r\n            .attr(\"y\", 60)\r\n            .text(function(d, i) {\r\n                return d.s;\r\n            })\r\n            .style(\"font-size\", \"12px\");\r\n\r\n        g.append(\"text\")\r\n            .attr(\"class\", \"caption\")\r\n            .attr(\"y\", 12)\r\n            .text(szCaption);\r\n    } // generateLegend()\r\n} // generateMap\r\n\r\n\r\nfunction app2() {\r\n    queue()\r\n        //should be town polym data\r\n        .defer(d3.json, \"js/data/TOWN.geo.json\")\r\n        //.defer(d3.json, \"us_states_5m.geo.json\")\r\n        //should be opioid death data\r\n        .defer(d3.json, \"js/data/TOWN.geo.json\")\r\n        //.defer(d3.csv, \"us_pop.csv\")\r\n        .awaitAll(generateMap2);\r\n}\r\n\r\nfunction generateMap2(error, results) {\r\n\r\n\r\n    var maTowns = results[0];\r\n    var maOpioid = results[1];\r\n\r\n    var currentyear\r\n\r\n    var i;\r\n    for (i = 0; i < maTowns.features.length; i++) {\r\n        if (maTowns.features[i].properties.town != maOpioid.features[i].TOWN) {\r\n            console.log('ASSERT failure for index: ' + i);\r\n            console.log(maTowns.features[i].properties.town + ' mismatch with ' + maOpioid.features[i].TOWN);\r\n            alert('Input data corrupted: generation of map terminated.');\r\n            return;\r\n        }\r\n        maTowns.features[i].properties.OPIOIDSTATS = maOpioid.features[i].properties;\r\n    }\r\n\r\n    var width = 960,\r\n        height = 450;\r\n\r\n    console.log(height);\r\n\r\n    var svgContainer = d3.select(\"#map_comp\").append(\"svg\")\r\n        .attr(\"width\", width)\r\n        .attr(\"height\", height)\r\n        .style(\"border\", \"0px solid steelblue\");\r\n\r\n    var tooltip2 = d3.select('#map_comp').append('div')\r\n        .attr('class', 'hidden tooltip2');\r\n\r\n    var opChgScale = d3.scale.threshold()\r\n        .domain([0.01, 6.9, 15.9, 31.5, Infinity])\r\n        .range(colorbrewer.RdPu[5]);\r\n    opChgScale.domainStrings = function() {\r\n        return (['< 0.01', '0.01-6.9', '6.9-15.9',\r\n            '15.9-31.5', '>31.5'\r\n        ]);\r\n    };\r\n\r\n    function toTitleCase(str) {\r\n        return str.replace(/\\w\\S*/g, function(txt) {\r\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\r\n        });\r\n    }\r\n\r\n    var projection = d3.geo.conicConformal()\r\n        .parallels([41 + 43 / 60, 42 + 41 / 60])\r\n        .rotate([71 + 30 / 60, -41])\r\n        .scale([11000])\r\n        .translate([400, 480]);\r\n\r\n    var geoPath = d3.geo.path()\r\n        .projection(projection);\r\n\r\n    var map = svgContainer.selectAll(\"path\")\r\n        .data(maTowns.features)\r\n        .enter()\r\n        .append(\"path\")\r\n        .attr(\"d\", function(d, i) {\r\n            return geoPath(d);\r\n        })\r\n        .on('mousemove', function(d) {\r\n            var mouse = d3.mouse(svgContainer.node()).map(function(d) {\r\n                return parseInt(d);\r\n            });\r\n            var string_base = \"yr\"\r\n            currentvalue = string_base.concat(currentyear);\r\n            var currentrate\r\n            console.log(height);\r\n\r\n            if (d.properties[currentvalue] > 0) {\r\n                currentrate = d3.format(\".1f\")(d.properties[currentvalue]);\r\n            } else if (d.properties[currentvalue] == 0) {\r\n                currentrate = d3.format(\".0f\")(d.properties[currentvalue]);\r\n            } else {\r\n                currentrate = \"N/A*\";\r\n            }\r\n\r\n            console.log(currentrate);\r\n\r\n            tooltip2.classed('hidden', false)\r\n                .attr('style', 'left:' + (mouse[0] + 15) +\r\n                    'px !important; top:' + (mouse[1] + 725) + 'px !important')\r\n                .html(\"<b>\" + toTitleCase(d.properties.TOWN) + \"</b> | \" + currentrate);\r\n        })\r\n        .on('mouseover', function(d, i) {\r\n\r\n            var currentState = this;\r\n            d3.select(this).style('fill-opacity', 0.25)\r\n                .style(\"stroke\", \"white\")\r\n                .style(\"stroke-width\", \"2px\");\r\n        })\r\n        .on('mouseout', function(d, i) {\r\n            tooltip2.classed('hidden', true);\r\n            d3.selectAll('path')\r\n                .style(\"fill-opacity\", 1)\r\n                .style(\"stroke\", \"#2f363d\")\r\n                .style(\"stroke-width\", \"0.1px\");\r\n        })\r\n        .style(\"stroke\", \"#2f363d\")\r\n        .style(\"stroke-width\", \"0.1px\")\r\n        .style(\"fill\", \"white\")\r\n        .on('mouseenter', function(d, i) {\r\n\r\n            //var string_base = \"yr\"\r\n            //currentvalue = string_base.concat(currentyear);\r\n            //console.log(d.properties[currentvalue]);\r\n        })\r\n        .on('mouseleave', function(d) {\r\n\r\n        });\r\n\r\n    var aYears = [\r\n        [2000, 2001],\r\n        [2001, 2002],\r\n        [2002, 2003],\r\n        [2003, 2004],\r\n        [2004, 2005],\r\n        [2005, 2006],\r\n        [2006, 2007],\r\n        [2007, 2008],\r\n        [2008, 2009],\r\n        [2010, 2011],\r\n        [2011, 2012],\r\n        [2012, 2013],\r\n        [2013, 2014],\r\n        [2014, 2014.5]\r\n    ];\r\n\r\n    var index = 0;\r\n    getYear();\r\n\r\n    generateLegend2(opChgScale, 'legend2', 'Composite Index Values');\r\n\r\n    function getYear() {\r\n        setSymbology2(2000);\r\n        $(\"#timeline\").on('input change', function() {\r\n            var year = $(this).val()\r\n                // $(\"#to\").html(parseInt(year) + 1);\r\n                // $(\"#from\").html(year);\r\n            setSymbology2($(this).val());\r\n        });\r\n    };\r\n\r\n\r\n    function setSymbology2(year) {\r\n\r\n        var szAttr = 'yr' + year;\r\n        currentyear = year\r\n        console.log(currentyear)\r\n        $('#titlePrefix2').html('A Composite Indicator of the Impact of the Opioid Epidemic on Massachusetts in ');\r\n        $('#fromYear2').html(year);\r\n\r\n        svgContainer.selectAll(\"path\")\r\n            .transition()\r\n            .duration(500)\r\n            .style(\"fill\", function(d, i) {\r\n\r\n                var delta = +d.properties.OPIOIDSTATS[szAttr];\r\n                return (delta === -9999) ? '#f1f1f1' : opChgScale(delta);\r\n            });\r\n    }\r\n\r\n    function generateLegend2(scale, szDivId, szCaption) {\r\n        var width2 = 550,\r\n            height2 = 80;\r\n\r\n        var svg = d3.select('#' + szDivId).append(\"svg\")\r\n            .attr(\"width\", width2)\r\n            .attr(\"height\", height2);\r\n\r\n        var g = svg.append(\"g\");\r\n\r\n        // Create data array.\r\n        var legendData = [];\r\n        legendData.push({\r\n            d: -9999,\r\n            r: '#f1f1f1',\r\n            s: 'N/A'\r\n        });\r\n        var i;\r\n        for (i = 0; i < scale.domain().length; i++) {\r\n            legendData.push({\r\n                d: scale.domain()[i],\r\n                r: scale.range()[i],\r\n                s: scale.domainStrings()[i]\r\n            });\r\n        }\r\n\r\n        g.selectAll(\"rect\")\r\n            .data(legendData)\r\n            .enter().append(\"rect\")\r\n            .attr(\"height\", 20)\r\n            .attr(\"width\", 50)\r\n            .attr(\"x\", function(d, i) {\r\n                return i * 55;\r\n            })\r\n            .attr(\"y\", 20)\r\n            .style(\"stroke\", \"black\")\r\n            .style(\"stroke-width\", \"0.25px\")\r\n            .style(\"fill\", function(d, i) {\r\n                return d.r;\r\n            });\r\n\r\n        g.selectAll(\"text\")\r\n            .data(legendData)\r\n            .enter().append(\"text\")\r\n            .attr(\"x\", function(d, i) {\r\n                return i * 55;\r\n            })\r\n            .attr(\"y\", 60)\r\n            .text(function(d, i) {\r\n                return d.s;\r\n            })\r\n            .style(\"font-size\", \"12px\");\r\n\r\n        g.append(\"text\")\r\n            .attr(\"class\", \"caption\")\r\n            .attr(\"y\", 12)\r\n            .text(szCaption);\r\n    } // generateLegend2()\r\n} // generateMap2\r\n"," var town_names = [\r\n     //\"massachusetts\",\r\n     \"abington\",\r\n     \"acton\",\r\n     \"acushnet\",\r\n     \"adams\",\r\n     \"agawam\",\r\n     \"alford\",\r\n     \"amesbury\",\r\n     \"amherst\",\r\n     \"andover\",\r\n     \"aquinnah\",\r\n     \"arlington\",\r\n     \"ashburnham\",\r\n     \"ashby\",\r\n     \"ashfield\",\r\n     \"ashland\",\r\n     \"athol\",\r\n     \"attleboro\",\r\n     \"auburn\",\r\n     \"avon\",\r\n     \"ayer\",\r\n     \"barnstable\",\r\n     \"barre\",\r\n     \"becket\",\r\n     \"bedford\",\r\n     \"belchertown\",\r\n     \"bellingham\",\r\n     \"belmont\",\r\n     \"berkley\",\r\n     \"berlin\",\r\n     \"bernardston\",\r\n     \"beverly\",\r\n     \"billerica\",\r\n     \"blackstone\",\r\n     \"blandford\",\r\n     \"bolton\",\r\n     \"boston\",\r\n     \"bourne\",\r\n     \"boxborough\",\r\n     \"boxford\",\r\n     \"boylston\",\r\n     \"braintree\",\r\n     \"brewster\",\r\n     \"bridgewater\",\r\n     \"brimfield\",\r\n     \"brockton\",\r\n     \"brookfield\",\r\n     \"brewster\",\r\n     \"bridgewater\",\r\n     \"brimfield\",\r\n     \"brockton\",\r\n     \"brookfield\",\r\n     \"brookline\",\r\n     \"buckland\",\r\n     \"burlington\",\r\n     \"cambridge\",\r\n     \"canton\",\r\n     \"carlisle\",\r\n     \"carver\",\r\n     \"charlemont\",\r\n     \"charlton\",\r\n     \"chatham\",\r\n     \"chelmsford\",\r\n     \"chelsea\",\r\n     \"cheshire\",\r\n     \"chester\",\r\n     \"chesterfield\",\r\n     \"chicopee\",\r\n     \"chilmark\",\r\n     \"clarksburg\",\r\n     \"clinton\",\r\n     \"cohasset\",\r\n     \"colrain\",\r\n     \"concord\",\r\n     \"conway\",\r\n     \"cummington\",\r\n     \"dalton\",\r\n     \"danvers\",\r\n     \"dartmouth\",\r\n     \"dedham\",\r\n     \"deerfield\",\r\n     \"dennis\",\r\n     \"dighton\",\r\n     \"douglas\",\r\n     \"dover\",\r\n     \"dracut\",\r\n     \"dudley\",\r\n     \"dunstable\",\r\n     \"duxbury\",\r\n     \"eastbridgewater\",\r\n     \"eastbrookfield\",\r\n     \"eastlongmeadow\",\r\n     \"eastham\",\r\n     \"easthampton\",\r\n     \"easton\",\r\n     \"edgartown\",\r\n     \"egremont\",\r\n     \"erving\",\r\n     \"essex\",\r\n     \"everett\",\r\n     \"fairhaven\",\r\n     \"fallriver\",\r\n     \"falmouth\",\r\n     \"fitchburg\",\r\n     \"florida\",\r\n     \"foxborough\",\r\n     \"framingham\",\r\n     \"franklin\",\r\n     \"freetown\",\r\n     \"gardner\",\r\n     \"gay head\",\r\n     \"georgetown\",\r\n     \"gill\",\r\n     \"gloucester\",\r\n     \"goshen\",\r\n     \"gosnold\",\r\n     \"grafton\",\r\n     \"granby\",\r\n     \"granville\",\r\n     \"greatbarrington\",\r\n     \"greenfield\",\r\n     \"groton\",\r\n     \"groveland\",\r\n     \"hadley\",\r\n     \"halifax\",\r\n     \"hamilton\",\r\n     \"hampden\",\r\n     \"hancock\",\r\n     \"hanover\",\r\n     \"hanson\",\r\n     \"hardwick\",\r\n     \"harvard\",\r\n     \"harwich\",\r\n     \"hatfield\",\r\n     \"haverhill\",\r\n     \"hawley\",\r\n     \"heath\",\r\n     \"hingham\",\r\n     \"hinsdale\",\r\n     \"holbrook\",\r\n     \"holden\",\r\n     \"holland\",\r\n     \"holliston\",\r\n     \"holyoke\",\r\n     \"hopedale\",\r\n     \"hopkinton\",\r\n     \"hubbardston\",\r\n     \"hudson\",\r\n     \"hull\",\r\n     \"huntington\",\r\n     \"ipswich\",\r\n     \"kingston\",\r\n     \"lakeville\",\r\n     \"lancaster\",\r\n     \"lanesborough\",\r\n     \"lawrence\",\r\n     \"lee\",\r\n     \"leicester\",\r\n     \"lenox\",\r\n     \"leominster\",\r\n     \"leverett\",\r\n     \"lexington\",\r\n     \"leyden\",\r\n     \"lincoln\",\r\n     \"littleton\",\r\n     \"longmeadow\",\r\n     \"lowell\",\r\n     \"ludlow\",\r\n     \"lunenburg\",\r\n     \"lynn\",\r\n     \"lynnfield\",\r\n     \"malden\",\r\n     \"manchester\",\r\n     \"mansfield\",\r\n     \"marblehead\",\r\n     \"marion\",\r\n     \"marlborough\",\r\n     \"marshfield\",\r\n     \"mashpee\",\r\n     \"mattapoisett\",\r\n     \"maynard\",\r\n     \"medfield\",\r\n     \"medford\",\r\n     \"medway\",\r\n     \"melrose\",\r\n     \"mendon\",\r\n     \"merrimac\",\r\n     \"methuen\",\r\n     \"middleborough\",\r\n     \"middlefield\",\r\n     \"middleton\",\r\n     \"milford\",\r\n     \"millbury\",\r\n     \"millis\",\r\n     \"millville\",\r\n     \"milton\",\r\n     \"monroe\",\r\n     \"monson\",\r\n     \"montague\",\r\n     \"monterey\",\r\n     \"montgomery\",\r\n     \"mountwashington\",\r\n     \"nahant\",\r\n     \"nantucket\",\r\n     \"natick\",\r\n     \"needham\",\r\n     \"newashford\",\r\n     \"newbedford\",\r\n     \"newbraintree\",\r\n     \"newmarlborough\",\r\n     \"newsalem\",\r\n     \"newbury\",\r\n     \"newburyport\",\r\n     \"newton\",\r\n     \"norfolk\",\r\n     \"westadams\",\r\n     \"westandover\",\r\n     \"westattleborough\",\r\n     \"westbrookfield\",\r\n     \"westreading\",\r\n     \"northampton\",\r\n     \"northborough\",\r\n     \"northbridge\",\r\n     \"northfield\",\r\n     \"norton\",\r\n     \"norwell\",\r\n     \"norwood\",\r\n     \"oak bluffs\",\r\n     \"oakham\",\r\n     \"orange\",\r\n     \"orleans\",\r\n     \"otis\",\r\n     \"oxford\",\r\n     \"palmer\",\r\n     \"paxton\",\r\n     \"peabody\",\r\n     \"pelham\",\r\n     \"pembroke\",\r\n     \"pepperell\",\r\n     \"peru\",\r\n     \"petersham\",\r\n     \"phillipston\",\r\n     \"pittsfield\",\r\n     \"plainfield\",\r\n     \"plainville\",\r\n     \"plymouth\",\r\n     \"plympton\",\r\n     \"princeton\",\r\n     \"provincetown\",\r\n     \"quincy\",\r\n     \"randolph\",\r\n     \"raynham\",\r\n     \"reading\",\r\n     \"rehoboth\",\r\n     \"revere\",\r\n     \"richmond\",\r\n     \"rochester\",\r\n     \"rockland\",\r\n     \"rockport\",\r\n     \"rowe\",\r\n     \"rowley\",\r\n     \"royalston\",\r\n     \"russell\",\r\n     \"rutland\",\r\n     \"salem\",\r\n     \"salisbury\",\r\n     \"sandisfield\",\r\n     \"sandwich\",\r\n     \"saugus\",\r\n     \"savoy\",\r\n     \"scituate\",\r\n     \"seekonk\",\r\n     \"sharon\",\r\n     \"sheffield\",\r\n     \"shelburne\",\r\n     \"sherborn\",\r\n     \"shirley\",\r\n     \"shrewsbury\",\r\n     \"shutesbury\",\r\n     \"somerset\",\r\n     \"somerville\",\r\n     \"southhadley\",\r\n     \"southampton\",\r\n     \"southborough\",\r\n     \"southbridge\",\r\n     \"southwick\",\r\n     \"spencer\",\r\n     \"springfield\",\r\n     \"sterling\",\r\n     \"stockbridge\",\r\n     \"stoneham\",\r\n     \"stoughton\",\r\n     \"stow\",\r\n     \"sturbridge\",\r\n     \"sudbury\",\r\n     \"sunderland\",\r\n     \"sutton\",\r\n     \"swampscott\",\r\n     \"swansea\",\r\n     \"taunton\",\r\n     \"templeton\",\r\n     \"tewksbury\",\r\n     \"tisbury\",\r\n     \"tolland\",\r\n     \"topsfield\",\r\n     \"townsend\",\r\n     \"truro\",\r\n     \"tyngsborough\",\r\n     \"tyringham\",\r\n     \"upton\",\r\n     \"uxbridge\",\r\n     \"wakefield\",\r\n     \"wales\",\r\n     \"walpole\",\r\n     \"waltham\",\r\n     \"ware\",\r\n     \"wareham\",\r\n     \"warren\",\r\n     \"warwick\",\r\n     \"washington\",\r\n     \"watertown\",\r\n     \"wayland\",\r\n     \"webster\",\r\n     \"wellesley\",\r\n     \"wellfleet\",\r\n     \"wendell\",\r\n     \"wenham\",\r\n     \"westboylston\",\r\n     \"westbridgewater\",\r\n     \"westbrookfield\",\r\n     \"westnewbury\",\r\n     \"westspringfield\",\r\n     \"weststockbridge\",\r\n     \"westtisbury\",\r\n     \"westborough\",\r\n     \"westfield\",\r\n     \"westford\",\r\n     \"westhampton\",\r\n     \"westminster\",\r\n     \"weston\",\r\n     \"westport\",\r\n     \"westwood\",\r\n     \"weymouth\",\r\n     \"whately\",\r\n     \"whitman\",\r\n     \"wilbraham\",\r\n     \"williamsburg\",\r\n     \"williamstown\",\r\n     \"wilmington\",\r\n     \"winchendon\",\r\n     \"winchester\",\r\n     \"windsor\",\r\n     \"winthrop\",\r\n     \"woburn\",\r\n     \"worcester\",\r\n     \"worthington\",\r\n     \"wrentham\",\r\n     \"yarmouth\"\r\n ];\r\n var current_town = \"massachusetts\";\r\n\r\n var margin_bsas = {\r\n         top: 0,\r\n         right: 50,\r\n         bottom: 30,\r\n         left: 50\r\n     },\r\n     width_bsas = 650 - margin_bsas.left - margin_bsas.right,\r\n     height_bsas = 400 - margin_bsas.top - margin_bsas.bottom;\r\n\r\n var bisectAge = d3.bisector(function(d) {\r\n     return d.age;\r\n }).left;\r\n var percent = d3.format(',.1%');\r\n var yearformat = d3.format(\"d\");\r\n // var min_age = 2005;\r\n // var fields = ['emp', 'edu', 'race', 'orig'];\r\n var groups = {};\r\n\r\n var x = d3.scale.linear()\r\n     .range([0, width_bsas]);\r\n\r\n var y = d3.scale.linear()\r\n     .range([height_bsas, 0]);\r\n // .domain([0, 6]);\r\n\r\n var color = d3.scale.category10();\r\n\r\n var xAxis_bsas = d3.svg.axis()\r\n     .scale(x)\r\n     .tickFormat(yearformat)\r\n     .orient(\"bottom\")\r\n     .outerTickSize(0);\r\n\r\n var yAxis_bsas = d3.svg.axis()\r\n     .scale(y)\r\n     .tickSize(width_bsas)\r\n     .orient(\"right\")\r\n     .tickFormat(percent);\r\n\r\n var line = d3.svg.line()\r\n     .x(function(d) {\r\n         return x(d.age);\r\n     })\r\n     .y(function(d) {\r\n         return y(d.value);\r\n     })\r\n     .defined(function(d) {\r\n         return y(d.value);\r\n     }) // Omit empty values.;\r\n\r\n\r\n\r\n var $lines_bsas = d3.select(\"#lines-bsas\").append(\"svg\")\r\n     .attr(\"width\", width_bsas + margin_bsas.left + margin_bsas.right)\r\n     .attr(\"height\", height_bsas + margin_bsas.top + margin_bsas.bottom)\r\n     .append(\"g\")\r\n     .attr(\"transform\", \"translate(\" + margin_bsas.left + \",\" + margin_bsas.top + \")\");\r\n\r\n d3.csv(\"js/data/bsas-data.csv\", type, function(error, data) {\r\n     if (error) throw error;\r\n     //console.log(groups);\r\n     // var marriages = groups[current_town];\r\n\r\n     x.domain([2005, d3.max(data, function(d) {\r\n         return d.age;\r\n     })]);\r\n     y.domain([0, .99]);\r\n\r\n     $lines_bsas.append(\"g\")\r\n         .attr(\"class\", \"x axis_bsas\")\r\n         .attr(\"transform\", \"translate(0,\" + height_bsas + \")\")\r\n         .call(xAxis_bsas)\r\n         .append(\"text\")\r\n         .attr(\"x\", 635)\r\n         .attr(\"y\", 15)\r\n         .attr(\"text-anchor\", \"middle\")\r\n         .text(\"Year\");\r\n\r\n     $lines_bsas.append(\"g\")\r\n         .attr(\"class\", \"y axis_bsas\")\r\n         .call(yAxis_bsas)\r\n         .append(\"text\")\r\n         // .attr(\"y\", -30)\r\n         .style(\"text-anchor\", \"start\")\r\n         // .text(\"Substance Abuse\");\r\n     $lines_bsas.selectAll(\".y.axis_bsas text\").attr(\"x\", -43).attr(\"dy\", 0);\r\n\r\n     var legend_pos_text = -40,\r\n         legend_pos_dot = -50;\r\n\r\n\r\n     $lines_bsas.append(\"circle\")\r\n         .attr(\"class\", \"circle opioids\")\r\n         .attr(\"cx\", width_bsas + legend_pos_dot)\r\n         .attr(\"cy\", 25)\r\n         .attr(\"r\", 3);\r\n     $lines_bsas.append(\"g\")\r\n         .append(\"text\")\r\n         .attr(\"class\", \"focus opioids\")\r\n         .attr(\"x\", width_bsas + legend_pos_text)\r\n         .attr(\"y\", 28)\r\n         .text(\"opioids\");\r\n\r\n     $lines_bsas.append(\"circle\")\r\n         .attr(\"class\", \"circle alcohol\")\r\n         .attr(\"cx\", width_bsas + legend_pos_dot)\r\n         .attr(\"cy\", 40)\r\n         .attr(\"r\", 3);\r\n     $lines_bsas.append(\"g\")\r\n         .append(\"text\")\r\n         .attr(\"class\", \"focus alcohol\")\r\n         .attr(\"x\", width_bsas + legend_pos_text)\r\n         .attr(\"y\", 43)\r\n         .text(\"alcohol\");\r\n\r\n\r\n     $lines_bsas.append(\"circle\")\r\n         .attr(\"class\", \"circle marijuana\")\r\n         .attr(\"cx\", width_bsas + legend_pos_dot)\r\n         .attr(\"cy\", 55)\r\n         .attr(\"r\", 3);\r\n     $lines_bsas.append(\"g\")\r\n         .append(\"text\")\r\n         .attr(\"class\", \"focus marijuana\")\r\n         .attr(\"x\", width_bsas + legend_pos_text)\r\n         .attr(\"y\", 58)\r\n         .text(\"marijuana\");\r\n\r\n\r\n     $lines_bsas.append(\"circle\")\r\n         .attr(\"class\", \"circle other\")\r\n         .attr(\"cx\", width_bsas + legend_pos_dot)\r\n         .attr(\"cy\", 70)\r\n         .attr(\"r\", 3);\r\n     $lines_bsas.append(\"g\")\r\n         .append(\"text\")\r\n         .attr(\"class\", \"focus other\")\r\n         .attr(\"x\", width_bsas + legend_pos_text)\r\n         .attr(\"y\", 73)\r\n         .text(\"other\");\r\n\r\n\r\n     $lines_bsas.append(\"circle\")\r\n         .attr(\"class\", \"circle none\")\r\n         .attr(\"cx\", width_bsas + legend_pos_dot)\r\n         .attr(\"cy\", 82)\r\n         .attr(\"r\", 3);\r\n     $lines_bsas.append(\"g\")\r\n         .append(\"text\")\r\n         .attr(\"class\", \"focus none\")\r\n         .attr(\"x\", width_bsas + legend_pos_text)\r\n         .attr(\"y\", 88)\r\n         .text(\"none\");\r\n\r\n     // Alcohol line\r\n     $lines_bsas.append(\"path\")\r\n         .attr(\"class\", \"line alcohol\")\r\n         .attr(\"d\", function(d) {\r\n             return line(groups[current_town + \"alcohol\"].values);\r\n         });\r\n\r\n     //alcohol circle\r\n     for (i = 0; i < groups[current_town + \"alcohol\"].values.length; i++) {\r\n\r\n         var x_circle_alcohol = groups[current_town + \"alcohol\"].values[i].age;\r\n         var y_circle_alcohol = groups[current_town + \"alcohol\"].values[i].value;\r\n\r\n         if (y_circle_alcohol >= 0) {\r\n\r\n             //console.log(groups[current_town+\"alcohol\"].values[i].age); \r\n             //console.log(\"circle alcohol y\" + groups[current_town + \"alcohol\"].values[i].age)\r\n\r\n             $lines_bsas.append(\"circle\")\r\n                 .attr(\"class\", function(d) {\r\n                     return \"circle alcohol y\" + groups[current_town + \"alcohol\"].values[i].age\r\n                 })\r\n                 .attr(\"cx\", x(groups[current_town + \"alcohol\"].values[i].age))\r\n                 .attr(\"cy\", y(groups[current_town + \"alcohol\"].values[i].value))\r\n                 .attr(\"r\", 3)\r\n         }\r\n     }\r\n\r\n     // Marijuana line\r\n     $lines_bsas.append(\"path\")\r\n         .attr(\"class\", \"line marijuana\")\r\n         .attr(\"d\", function(d) {\r\n             return line(groups[current_town + \"marijuana\"].values);\r\n         });\r\n     // Marijuana circle\r\n     for (i = 0; i < groups[current_town + \"marijuana\"].values.length; i++) {\r\n\r\n         var x_circle_alcohol = groups[current_town + \"marijuana\"].values[i].age;\r\n         var y_circle_alcohol = groups[current_town + \"marijuana\"].values[i].value;\r\n\r\n         if (y_circle_alcohol >= 0) {\r\n\r\n             //console.log(groups[current_town+\"alcohol\"].values[i].age); \r\n             //console.log(\"circle marijuana y\" + groups[current_town + \"marijuana\"].values[i].age)\r\n\r\n             $lines_bsas.append(\"circle\")\r\n                 .attr(\"class\", function(d) {\r\n                     return \"circle marijuana y\" + groups[current_town + \"marijuana\"].values[i].age\r\n                 })\r\n                 .attr(\"cx\", x(groups[current_town + \"marijuana\"].values[i].age))\r\n                 .attr(\"cy\", y(groups[current_town + \"marijuana\"].values[i].value))\r\n                 .attr(\"r\", 3)\r\n         }\r\n     }\r\n\r\n     // None line\r\n     $lines_bsas.append(\"path\")\r\n         .attr(\"class\", \"line none\")\r\n         .attr(\"d\", function(d) {\r\n             return line(groups[current_town + \"none\"].values);\r\n         });\r\n     // None circle\r\n     for (i = 0; i < groups[current_town + \"none\"].values.length; i++) {\r\n\r\n         var x_circle_alcohol = groups[current_town + \"none\"].values[i].age;\r\n         var y_circle_alcohol = groups[current_town + \"none\"].values[i].value;\r\n\r\n         if (y_circle_alcohol >= 0) {\r\n\r\n             //console.log(groups[current_town+\"alcohol\"].values[i].age); \r\n             //console.log(\"circle none y\" + groups[current_town + \"none\"].values[i].age)\r\n\r\n             $lines_bsas.append(\"circle\")\r\n                 .attr(\"class\", function(d) {\r\n                     return \"circle none y\" + groups[current_town + \"none\"].values[i].age\r\n                 })\r\n                 .attr(\"cx\", x(groups[current_town + \"none\"].values[i].age))\r\n                 .attr(\"cy\", y(groups[current_town + \"none\"].values[i].value))\r\n                 .attr(\"r\", 3)\r\n         }\r\n     }\r\n\r\n     // Opioids line\r\n     $lines_bsas.append(\"path\")\r\n         .attr(\"class\", \"line opioids\")\r\n         .attr(\"d\", function(d) {\r\n             return line(groups[current_town + \"opioids\"].values);\r\n         });\r\n     // Opioids circle\r\n     for (i = 0; i < groups[current_town + \"opioids\"].values.length; i++) {\r\n\r\n         var x_circle_alcohol = groups[current_town + \"opioids\"].values[i].age;\r\n         var y_circle_alcohol = groups[current_town + \"opioids\"].values[i].value;\r\n\r\n         if (y_circle_alcohol >= 0) {\r\n\r\n             //console.log(groups[current_town+\"alcohol\"].values[i].age); \r\n             //console.log(\"circle opioids y\" + groups[current_town + \"opioids\"].values[i].age)\r\n\r\n             $lines_bsas.append(\"circle\")\r\n                 .attr(\"class\", function(d) {\r\n                     return \"circle opioids y\" + groups[current_town + \"opioids\"].values[i].age\r\n                 })\r\n                 .attr(\"cx\", x(groups[current_town + \"opioids\"].values[i].age))\r\n                 .attr(\"cy\", y(groups[current_town + \"opioids\"].values[i].value))\r\n                 .attr(\"r\", 3)\r\n         }\r\n     }\r\n\r\n     // Other line\r\n     $lines_bsas.append(\"path\")\r\n         .attr(\"class\", \"line other\")\r\n         .attr(\"d\", function(d) {\r\n             return line(groups[current_town + \"other\"].values);\r\n         });\r\n     // Other circle\r\n     for (i = 0; i < groups[current_town + \"other\"].values.length; i++) {\r\n\r\n         var x_circle_alcohol = groups[current_town + \"other\"].values[i].age;\r\n         var y_circle_alcohol = groups[current_town + \"other\"].values[i].value;\r\n\r\n         if (y_circle_alcohol >= 0) {\r\n\r\n             //console.log(groups[current_town+\"alcohol\"].values[i].age); \r\n             // console.log(\"circle other y\" + groups[current_town + \"other\"].values[i].age)\r\n\r\n             $lines_bsas.append(\"circle\")\r\n                 .attr(\"class\", function(d) {\r\n                     return \"circle other y\" + groups[current_town + \"other\"].values[i].age\r\n                 })\r\n                 .attr(\"cx\", x(groups[current_town + \"other\"].values[i].age))\r\n                 .attr(\"cy\", y(groups[current_town + \"other\"].values[i].value))\r\n                 .attr(\"r\", 3)\r\n         }\r\n     }\r\n\r\n     // Autocomplete\r\n\r\n     $(\".btn-bsas\").addClass('active');\r\n     d3.selectAll(\".btn-bsas\").on(\"click\", function() {\r\n         current_town = d3.select(this).attr(\"data-val\");\r\n         update();\r\n         $(\"#tags\").val('');\r\n     });\r\n\r\n\r\n     $(\"#tags\").autocomplete({\r\n         source: function(request, response) {\r\n             var matches = $.map(town_names, function(acItem) {\r\n                 if (acItem.toUpperCase().indexOf(request.term.toUpperCase()) === 0) {\r\n                     return acItem;\r\n                 }\r\n             });\r\n             response(matches);\r\n             //$(\"#tags\").focus(function() {\r\n                 // if (matches.length == 1) {\r\n                 //     current_town = matches[0];\r\n                 //     $(\".btn-bsas\").removeClass('active');\r\n                 //     update();\r\n                 // }\r\n             //});\r\n             //console.log(matches);\r\n         },\r\n         select: function(event, ui) {\r\n             current_town = ui.item.value;\r\n             $(\".btn-bsas\").removeClass('active');\r\n             update();\r\n         }\r\n     });\r\n\r\n     function update() {\r\n\r\n         // marriages = groups[current_town];\r\n         //update alcohol line\r\n         $lines_bsas.select(\".line.alcohol\")\r\n             .transition()\r\n             .duration(600)\r\n             .delay(180)\r\n             .attr(\"d\", function(d) {\r\n                 return line(groups[current_town + \"alcohol\"].values);\r\n             });\r\n\r\n         //console.log(groups[current_town + \"alcohol\"].values[5].value >= 0);\r\n\r\n         //update alcohol circles\r\n         for (i = 0; i < groups[current_town + \"alcohol\"].values.length; i++) {\r\n             var string_select = \".circle.alcohol.y\" + groups[current_town + \"alcohol\"].values[i].age\r\n                 // console.log(string_select);\r\n\r\n             if (groups[current_town + \"alcohol\"].values[i].value >= 0) {\r\n                 $lines_bsas.selectAll(string_select)\r\n                     .transition()\r\n                     .duration(600)\r\n                     .attr(\"cx\", function(d) {\r\n                         return x(groups[current_town + \"alcohol\"].values[i].age)\r\n                     })\r\n                     .attr(\"cy\", function(d) {\r\n                         return y(groups[current_town + \"alcohol\"].values[i].value)\r\n                     })\r\n                     .attr(\"r\", 3)\r\n             } else {\r\n                 $lines_bsas.selectAll(string_select)\r\n                     .transition()\r\n                     .duration(600)\r\n                     .attr(\"r\", 0)\r\n             }\r\n\r\n         }\r\n\r\n\r\n\r\n         //marijuana\r\n         $lines_bsas.select(\".line.marijuana\")\r\n             .transition()\r\n             .duration(600)\r\n             .attr(\"d\", function(d) {\r\n                 return line(groups[current_town + \"marijuana\"].values);\r\n             });\r\n         //update marijuana circles\r\n         for (i = 0; i < groups[current_town + \"marijuana\"].values.length; i++) {\r\n             var string_select = \".circle.marijuana.y\" + groups[current_town + \"marijuana\"].values[i].age\r\n                 //console.log(string_select);\r\n\r\n             if (groups[current_town + \"marijuana\"].values[i].value >= 0) {\r\n                 $lines_bsas.selectAll(string_select)\r\n                     .transition()\r\n                     .duration(600)\r\n                     .attr(\"cx\", function(d) {\r\n                         return x(groups[current_town + \"marijuana\"].values[i].age)\r\n                     })\r\n                     .attr(\"cy\", function(d) {\r\n                         return y(groups[current_town + \"marijuana\"].values[i].value)\r\n                     })\r\n                     .attr(\"r\", 3)\r\n             } else {\r\n                 $lines_bsas.selectAll(string_select)\r\n                     .transition()\r\n                     .duration(600)\r\n                     .attr(\"r\", 0)\r\n             }\r\n\r\n         }\r\n\r\n         //none\r\n         $lines_bsas.select(\".line.none\")\r\n             .transition()\r\n             .duration(600)\r\n             .attr(\"d\", function(d) {\r\n                 return line(groups[current_town + \"none\"].values);\r\n             });\r\n         //update none circles\r\n         for (i = 0; i < groups[current_town + \"none\"].values.length; i++) {\r\n\r\n\r\n             var string_select = \".circle.none.y\" + groups[current_town + \"none\"].values[i].age\r\n             var value_select = groups[current_town + \"none\"].values[i].value\r\n                 // console.log(string_select);\r\n                 // console.log(value_select);\r\n                 // console.log(value_select >= 0);\r\n\r\n             if (groups[current_town + \"none\"].values[i].value >= 0) {\r\n                 $lines_bsas.selectAll(string_select)\r\n                     .transition()\r\n                     .duration(600)\r\n                     .attr(\"cx\", function(d) {\r\n                         return x(groups[current_town + \"none\"].values[i].age)\r\n                     })\r\n                     .attr(\"cy\", function(d) {\r\n                         return y(groups[current_town + \"none\"].values[i].value)\r\n                     })\r\n                     .attr(\"r\", 3);\r\n             } else {\r\n                 $lines_bsas.selectAll(string_select)\r\n                     .transition()\r\n                     .duration(600)\r\n                     .attr(\"r\", 0);\r\n             }\r\n\r\n         }\r\n\r\n         //opioids\r\n         $lines_bsas.select(\".line.opioids\")\r\n             .transition()\r\n             .duration(600)\r\n             .attr(\"d\", function(d) {\r\n                 return line(groups[current_town + \"opioids\"].values);\r\n             });\r\n         //update opioids circles\r\n         for (i = 0; i < groups[current_town + \"opioids\"].values.length; i++) {\r\n\r\n\r\n             var string_select = \".circle.opioids.y\" + groups[current_town + \"opioids\"].values[i].age\r\n             var value_select = groups[current_town + \"opioids\"].values[i].value\r\n                 //console.log(string_select);\r\n                 //console.log(value_select);\r\n                 //console.log(value_select >= 0);\r\n\r\n             if (value_select >= 0) {\r\n                 $lines_bsas.selectAll(string_select)\r\n                     .transition()\r\n                     .duration(600)\r\n                     .attr(\"cx\", function(d) {\r\n                         return x(groups[current_town + \"opioids\"].values[i].age)\r\n                     })\r\n                     .attr(\"cy\", function(d) {\r\n                         return y(groups[current_town + \"opioids\"].values[i].value)\r\n                     })\r\n                     .attr(\"r\", 3);\r\n             } else {\r\n                 $lines_bsas.selectAll(string_select)\r\n                     .transition()\r\n                     .duration(600)\r\n                     .attr(\"r\", 0);\r\n             }\r\n\r\n         }\r\n\r\n         //other\r\n         $lines_bsas.select(\".line.other\")\r\n             .transition()\r\n             .duration(600)\r\n             .attr(\"d\", function(d) {\r\n                 return line(groups[current_town + \"other\"].values);\r\n             });\r\n         //update other circles\r\n         for (i = 0; i < groups[current_town + \"other\"].values.length; i++) {\r\n\r\n             var string_select = \".circle.other.y\" + groups[current_town + \"other\"].values[i].age\r\n             var value_select = groups[current_town + \"other\"].values[i].value\r\n                 // console.log(string_select);\r\n                 // console.log(value_select);\r\n                 // console.log(value_select >= 0);\r\n\r\n             if (value_select >= 0) {\r\n                 $lines_bsas.selectAll(string_select)\r\n                     .transition()\r\n                     .duration(600)\r\n                     .attr(\"cx\", function(d) {\r\n                         return x(groups[current_town + \"other\"].values[i].age)\r\n                     })\r\n                     .attr(\"cy\", function(d) {\r\n                         return y(groups[current_town + \"other\"].values[i].value)\r\n                     })\r\n                     .attr(\"r\", 3);\r\n             } else {\r\n                 $lines_bsas.selectAll(string_select)\r\n                     .transition()\r\n                     .duration(600)\r\n                     .attr(\"r\", 0);\r\n             }\r\n\r\n         }\r\n\r\n     }\r\n\r\n\r\n\r\n\r\n     // alcohol\r\n     var focusalcohol = $lines_bsas.append(\"g\")\r\n         .attr(\"class\", \"focus alcohol\")\r\n         .style(\"display\", \"none\");\r\n     focusalcohol.append(\"circle\")\r\n         .attr(\"r\", 3);\r\n     focusalcohol.append(\"text\")\r\n         .attr(\"x\", 9)\r\n         .attr(\"dy\", \".35em\");\r\n\r\n     // marijuana\r\n     var focusmarijuana = $lines_bsas.append(\"g\")\r\n         .attr(\"class\", \"focus marijuana\")\r\n         .style(\"display\", \"none\");\r\n     focusmarijuana.append(\"circle\")\r\n         .attr(\"r\", 3);\r\n     focusmarijuana.append(\"text\")\r\n         .attr(\"x\", 9)\r\n         .attr(\"dy\", \".35em\");\r\n\r\n     // none\r\n     var focusnone = $lines_bsas.append(\"g\")\r\n         .attr(\"class\", \"focus none\")\r\n         .style(\"display\", \"none\");\r\n     focusnone.append(\"circle\")\r\n         .attr(\"r\", 3);\r\n     focusnone.append(\"text\")\r\n         .attr(\"x\", 9)\r\n         .attr(\"dy\", \".35em\");\r\n\r\n     // opioids\r\n     var focusopioids = $lines_bsas.append(\"g\")\r\n         .attr(\"class\", \"focus opioids\")\r\n         .style(\"display\", \"none\");\r\n     focusopioids.append(\"circle\")\r\n         .attr(\"r\", 3);\r\n     focusopioids.append(\"text\")\r\n         .attr(\"x\", 9)\r\n         .attr(\"dy\", \".35em\");\r\n\r\n     // none\r\n     var focusother = $lines_bsas.append(\"g\")\r\n         .attr(\"class\", \"focus other\")\r\n         .style(\"display\", \"none\");\r\n     focusother.append(\"circle\")\r\n         .attr(\"r\", 3);\r\n     focusother.append(\"text\")\r\n         .attr(\"x\", 9)\r\n         .attr(\"dy\", \".35em\");\r\n\r\n     // Events\r\n     $lines_bsas.append(\"rect\")\r\n         .attr(\"class\", \"overlay\")\r\n         .attr(\"width\", width_bsas)\r\n         .attr(\"height\", height_bsas)\r\n         .on(\"mouseover\", function() {\r\n             focusmarijuana.style(\"display\", null);\r\n             focusalcohol.style(\"display\", null);\r\n             focusnone.style(\"display\", null);\r\n             focusopioids.style(\"display\", null);\r\n             focusother.style(\"display\", null);\r\n             //focusage.style(\"display\", null);\r\n         })\r\n         .on(\"mouseout\", function() {\r\n             focusmarijuana.style(\"display\", \"none\");\r\n             focusalcohol.style(\"display\", \"none\");\r\n             focusnone.style(\"display\", \"none\");\r\n             focusopioids.style(\"display\", \"none\");\r\n             focusother.style(\"display\", \"none\");\r\n             //focusage.style(\"display\", \"none\");\r\n         })\r\n         .on(\"mousemove\", mousemove);\r\n\r\n     function mousemove() {\r\n\r\n\r\n\r\n         var x0 = x.invert(d3.mouse(this)[0])\r\n\r\n         // Alcohol\r\n         var i_alcohol = bisectAge(groups[current_town + \"alcohol\"].values, x0, 1),\r\n             d0_alcohol = groups[current_town + \"alcohol\"].values[i_alcohol - 1],\r\n             d1_alcohol = groups[current_town + \"alcohol\"].values[i_alcohol],\r\n             d_alcohol = x0 - d0_alcohol.age > d1_alcohol.age - x0 ? d1_alcohol : d0_alcohol;\r\n\r\n         if (d_alcohol.value >= 0) {\r\n             focusalcohol.attr(\"transform\", \"translate(\" + x(d_alcohol.age) + \",\" + y(d_alcohol.value) + \")\");\r\n             focusalcohol.select(\"text\").text(percent(d_alcohol.value));\r\n             focusalcohol.select(\"circle\").attr(\"r\", 4);\r\n         } else {\r\n             focusalcohol.select(\"circle\").attr(\"r\", 0);\r\n             focusalcohol.select(\"text\").text(\"\");\r\n         }\r\n\r\n         // Marijuana\r\n\r\n         var i_marijuana = bisectAge(groups[current_town + \"marijuana\"].values, x0, 1),\r\n             d0_marijuana = groups[current_town + \"marijuana\"].values[i_marijuana - 1],\r\n             d1_marijuana = groups[current_town + \"marijuana\"].values[i_marijuana],\r\n             d_marijuana = x0 - d0_marijuana.age > d1_marijuana.age - x0 ? d1_marijuana : d0_marijuana;\r\n\r\n\r\n         // console.log(d_marijuana.value + \" \" + d_marijuana.age);\r\n         // console.log(d_marijuana.value >= 0);\r\n\r\n         if (d_marijuana.value >= 0) {\r\n             focusmarijuana.attr(\"transform\", \"translate(\" + x(d_marijuana.age) + \",\" + y(d_marijuana.value) + \")\");\r\n             focusmarijuana.select(\"text\").text(percent(d_marijuana.value));\r\n             focusmarijuana.select(\"circle\").attr(\"r\", 4);\r\n         } else {\r\n             focusmarijuana.select(\"circle\").attr(\"r\", 0);\r\n             focusmarijuana.select(\"text\").text(\"\");\r\n         }\r\n\r\n         // None\r\n\r\n         var i_none = bisectAge(groups[current_town + \"none\"].values, x0, 1),\r\n             d0_none = groups[current_town + \"none\"].values[i_none - 1],\r\n             d1_none = groups[current_town + \"none\"].values[i_none],\r\n             d_none = x0 - d0_none.age > d1_none.age - x0 ? d1_none : d0_none;\r\n\r\n         if (d_none.value >= 0) {\r\n             focusnone.attr(\"transform\", \"translate(\" + x(d_none.age) + \",\" + y(d_none.value) + \")\");\r\n             focusnone.select(\"text\").text(percent(d_none.value));\r\n             focusnone.select(\"circle\").attr(\"r\", 4);\r\n         } else {\r\n             focusnone.select(\"circle\").attr(\"r\", 0);\r\n             focusnone.select(\"text\").text(\"\");\r\n         }\r\n\r\n\r\n         // Opioids\r\n         var i_opioids = bisectAge(groups[current_town + \"opioids\"].values, x0, 1),\r\n             d0_opioids = groups[current_town + \"opioids\"].values[i_opioids - 1],\r\n             d1_opioids = groups[current_town + \"opioids\"].values[i_opioids],\r\n             d_opioids = x0 - d0_opioids.age > d1_opioids.age - x0 ? d1_opioids : d0_opioids;\r\n\r\n         if (d_opioids.value >= 0) {\r\n             focusopioids.attr(\"transform\", \"translate(\" + x(d_opioids.age) + \",\" + y(d_opioids.value) + \")\");\r\n             focusopioids.select(\"text\").text(percent(d_opioids.value));\r\n             focusopioids.select(\"circle\").attr(\"r\", 4);\r\n         } else {\r\n             focusopioids.select(\"circle\").attr(\"r\", 0);\r\n             focusopioids.select(\"text\").text(\"\");\r\n         }\r\n\r\n\r\n         // other\r\n         var i_other = bisectAge(groups[current_town + \"other\"].values, x0, 1),\r\n             d0_other = groups[current_town + \"other\"].values[i_other - 1],\r\n             d1_other = groups[current_town + \"other\"].values[i_other],\r\n             d_other = x0 - d0_other.age > d1_other.age - x0 ? d1_other : d0_other;\r\n\r\n         //console.log(d_other.value);\r\n\r\n         if (d_other.value >= 0) {\r\n             focusother.attr(\"transform\", \"translate(\" + x(d_other.age) + \",\" + y(d_other.value) + \")\");\r\n             focusother.select(\"text\").text(percent(d_other.value));\r\n             focusother.select(\"circle\").attr(\"r\", 4);\r\n         } else {\r\n             focusother.select(\"circle\").attr(\"r\", 0);\r\n             focusother.select(\"text\").text(\"\");\r\n         }\r\n\r\n\r\n         // Adjust label horizontal positions.\r\n         if (x0 > 80) {\r\n             focusalcohol.select(\"text\").attr(\"x\", 3).attr(\"y\", -7).attr(\"text-anchor\", \"beginning\");\r\n             focusmarijuana.select(\"text\").attr(\"x\", 3).attr(\"y\", -7).attr(\"text-anchor\", \"beginning\");\r\n             focusnone.select(\"text\").attr(\"x\", 3).attr(\"y\", -7).attr(\"text-anchor\", \"beginning\");\r\n             focusopioids.select(\"text\").attr(\"x\", 3).attr(\"y\", -7).attr(\"text-anchor\", \"beginning\");\r\n             focusother.select(\"text\").attr(\"x\", 3).attr(\"y\", -7).attr(\"text-anchor\", \"beginning\");\r\n         } else {\r\n             focusalcohol.select(\"text\").attr(\"x\", 10).attr(\"text-anchor\", \"beginning\");\r\n             focusmarijuana.select(\"text\").attr(\"x\", 10).attr(\"text-anchor\", \"beginning\");\r\n             focusnone.select(\"text\").attr(\"x\", 10).attr(\"text-anchor\", \"beginning\");\r\n             focusopioids.select(\"text\").attr(\"x\", 10).attr(\"text-anchor\", \"beginning\");\r\n             focusother.select(\"text\").attr(\"x\", 10).attr(\"text-anchor\", \"beginning\");\r\n         }\r\n\r\n\r\n\r\n     }\r\n\r\n }); // @end d3.tsv()\r\n\r\n\r\n function type(d, i) {\r\n\r\n     d3.keys(d).forEach(function(key) {\r\n         d[key] = +d[key];\r\n         if (key != 'age') {\r\n             if (!(key in groups)) {\r\n                 groups[key] = {\r\n                     'values': [{\r\n                         age: d.age,\r\n                         value: d[key]\r\n                     }]\r\n                 };\r\n             } else {\r\n                 groups[key]['values'].push({\r\n                     age: d.age,\r\n                     value: d[key]\r\n                 });\r\n             }\r\n         }\r\n     });\r\n\r\n     return d;\r\n\r\n }\r\n","dataset = [\r\n    { raceth: \"All\", \"2014\": 19.8, \"2015\": 23.2 },\r\n    { raceth: \"White non-Hispanic\", \"2014\": 23.3, \"2015\": 27.1 },\r\n    { raceth: \"Black non-Hispanic\", \"2014\": 11.1, \"2015\": 13.6 },\r\n    { raceth: \"Hispanic\", \"2014\": 15.3, \"2015\": 19.5 }\r\n];\r\n\r\nvar color = d3.scale.ordinal()\r\n    .range([\"#2166ac\", \"#92c5de\"]);\r\nvar margin = { top: (parseInt(d3.select('#race_ethnicity_chart').style('width'), 10) / 10), right: (parseInt(d3.select('#race_ethnicity_chart').style('width'), 10) / 20), bottom: (parseInt(d3.select('#race_ethnicity_chart').style('width'), 10) / 5), left: (parseInt(d3.select('#race_ethnicity_chart').style('width'), 10) / 10) },\r\n    width = parseInt(d3.select('#race_ethnicity_chart').style('width'), 10) - margin.left - margin.right,\r\n    height = parseInt(d3.select('#race_ethnicity_chart').style('height'), 10) - margin.top - margin.bottom;\r\n\r\nvar x0 = d3.scale.ordinal()\r\n    .rangeRoundBands([0, width], .1);\r\n\r\nvar x1 = d3.scale.ordinal();\r\n\r\nvar y = d3.scale.linear()\r\n    .range([height, 0]);\r\n\r\n//var colorRange = d3.scale.category20();\r\n//var color = d3.scale.ordinal()\r\n//.range(colorRange.range());\r\n\r\n\r\n\r\nvar xAxis_bars = d3.svg.axis()\r\n    .scale(x0)\r\n    .orient(\"bottom\");\r\n\r\nvar yAxis_bars = d3.svg.axis()\r\n    .scale(y)\r\n    .orient(\"left\")\r\n    .tickFormat(d3.format(\".0f\"));\r\n\r\nvar divtooltip_raceeth = d3.select(\"#race_ethnicity_chart\").append(\"div\").attr(\"class\", \"tooltip_raceeth\");\r\n\r\n\r\nvar $bars_race = d3.select(\"#race_ethnicity_chart\").append(\"svg\")\r\n    .attr(\"width\", width + margin.left + margin.right)\r\n    .attr(\"height\", height + margin.top + margin.bottom)\r\n    .append(\"g\")\r\n    .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\r\n\r\n\r\n\r\n\r\n\r\nvar options = d3.keys(dataset[0]).filter(function(key) {\r\n    return key !== \"raceth\";\r\n});\r\n\r\ndataset.forEach(function(d) {\r\n    d.values = options.map(function(name) {\r\n        return { name: name, value: +d[name] };\r\n    });\r\n});\r\n\r\nx0.domain(dataset.map(function(d) {\r\n    return d.raceth;\r\n}));\r\nx1.domain(options).rangeRoundBands([0, x0.rangeBand()]);\r\ny.domain([0, d3.max(dataset, function(d) {\r\n    return d3.max(d.values, function(d) {\r\n        return d.value;\r\n    });\r\n})]);\r\n\r\n$bars_race.append(\"g\")\r\n    .attr(\"class\", \"x axis-race\")\r\n    .attr(\"transform\", \"translate(10,\" + height + \")\")\r\n    .call(xAxis_bars)\r\n    .selectAll(\".tick text\")\r\n    .call(wrap, x0.rangeBand());\r\n\r\n$bars_race.append(\"g\")\r\n    .attr(\"class\", \"y axis-race\")\r\n    .call(yAxis_bars)\r\n    .append(\"text\")\r\n    .attr(\"transform\", \"rotate(-90)\")\r\n    .attr(\"y\", -35)\r\n    .attr(\"dy\", \".71em\")\r\n    .style(\"text-anchor\", \"end\")\r\n    .text(\"Age Adjusted Rates per 100,000\");\r\n\r\nvar bar = $bars_race.selectAll(\".bar\")\r\n    .data(dataset)\r\n    .enter().append(\"g\")\r\n    .attr(\"class\", \"rect\")\r\n    .attr(\"transform\", function(d) {\r\n        return \"translate(\" + (x0(d.raceth) - 10) + \",0)\";\r\n    });\r\n\r\n\r\nbar.selectAll(\"rect\")\r\n    .data(function(d) {\r\n        return d.values;\r\n    })\r\n    .enter().append(\"rect\")\r\n    .attr(\"width\", x1.rangeBand())\r\n    .attr(\"x\", function(d) {\r\n        return x1(d.name) + 5;\r\n    })\r\n    .attr(\"y\", function(d) {\r\n        return y(d.value);\r\n    })\r\n    .attr(\"value\", function(d) {\r\n        return d.name;\r\n    })\r\n    .attr(\"height\", function(d) {\r\n        return height - y(d.value);\r\n    })\r\n    .style(\"fill\", function(d) {\r\n        return color(d.name);\r\n    })\r\n    .style(\"fill\", function(d) {\r\n        return color(d.name);\r\n    });\r\n\r\n//bar.on(\r\n//\"mouseover\", function(){ \r\n//d3.select(this).attr(\"fill\",\"red !important\");\r\n//});\r\n\r\nbar\r\n    .on(\"mousemove\", function(d) {\r\n        divtooltip_raceeth.style(\"left\", d3.event.pageX - $(\"#race_ethnicity_chart\").offset().left + \"px\");\r\n        divtooltip_raceeth.style(\"top\", d3.event.pageY - $(\"#race_ethnicity_chart\").offset().top + \"px\");\r\n        divtooltip_raceeth.style(\"display\", \"inline-block\");\r\n        var x = d3.event.pageX,\r\n            y = d3.event.pageY\r\n        var elements = document.querySelectorAll(':hover');\r\n        l = elements.length\r\n        l = l - 1\r\n        elementData = elements[l].__data__\r\n            //divtooltip_raceeth.html(\"<rate>\" + (elementData.value) + \"</rate>\"  +\"<br>\" + \"<reth> - \" + (d.raceth) + \" - </reth>\" + \"<br>\" + \"<year>\" + (elementData.name) + \"</year>\");\r\n        divtooltip_raceeth.html(\"<rate>\" + (elementData.value) + \"</rate>\");\r\n\r\n    });\r\n\r\nbar\r\n    .on(\"mouseout\", function(d) {\r\n        divtooltip_raceeth.style(\"display\", \"none\");\r\n    });\r\n\r\n\r\n\r\nvar legend = $bars_race.selectAll(\".legend\")\r\n    .data(options.slice())\r\n    .enter().append(\"g\")\r\n    .attr(\"class\", \"legend\")\r\n    .attr(\"transform\", function(d, i) {\r\n        return \"translate(0,\" + i * 20 + \")\";\r\n    });\r\n\r\nlegend.append(\"rect\")\r\n    .attr(\"x\", width - 18)\r\n    .attr(\"width\", 18)\r\n    .attr(\"height\", 18)\r\n    .style(\"fill\", color);\r\n\r\nlegend.append(\"text\")\r\n    .attr(\"x\", width - 24)\r\n    .attr(\"y\", 9)\r\n    .attr(\"dy\", \".35em\")\r\n    .style(\"text-anchor\", \"end\")\r\n    .text(function(d) {\r\n        return d;\r\n    });\r\n\r\nfunction wrap(text, width) {\r\n    text.each(function() {\r\n        var text = d3.select(this),\r\n            words = text.text().split(/\\s+/).reverse(),\r\n            word,\r\n            line = [],\r\n            lineNumber = 0,\r\n            lineHeight = 1.1, // ems\r\n            y = text.attr(\"y\"),\r\n            dy = parseFloat(text.attr(\"dy\")),\r\n            tspan = text.text(null).append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", dy + \"em\");\r\n        while (word = words.pop()) {\r\n            line.push(word);\r\n            tspan.text(line.join(\" \"));\r\n            if (tspan.node().getComputedTextLength() > width) {\r\n                line.pop();\r\n                tspan.text(line.join(\" \"));\r\n                line = [word];\r\n                tspan = text.append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\").text(word);\r\n            }\r\n        }\r\n    });\r\n}\r\n","(function() {\r\n  var slice = [].slice;\r\n\r\n  function queue(parallelism) {\r\n    var q,\r\n        tasks = [],\r\n        started = 0, // number of tasks that have been started (and perhaps finished)\r\n        active = 0, // number of tasks currently being executed (started but not finished)\r\n        remaining = 0, // number of tasks not yet finished\r\n        popping, // inside a synchronous task callback?\r\n        error = null,\r\n        await = noop,\r\n        all;\r\n\r\n    if (!parallelism) parallelism = Infinity;\r\n\r\n    function pop() {\r\n      while (popping = started < tasks.length && active < parallelism) {\r\n        var i = started++,\r\n            t = tasks[i],\r\n            a = slice.call(t, 1);\r\n        a.push(callback(i));\r\n        ++active;\r\n        t[0].apply(null, a);\r\n      }\r\n    }\r\n\r\n    function callback(i) {\r\n      return function(e, r) {\r\n        --active;\r\n        if (error != null) return;\r\n        if (e != null) {\r\n          error = e; // ignore new tasks and squelch active callbacks\r\n          started = remaining = NaN; // stop queued tasks from starting\r\n          notify();\r\n        } else {\r\n          tasks[i] = r;\r\n          if (--remaining) popping || pop();\r\n          else notify();\r\n        }\r\n      };\r\n    }\r\n\r\n    function notify() {\r\n      if (error != null) await(error);\r\n      else if (all) await(error, tasks);\r\n      else await.apply(null, [error].concat(tasks));\r\n    }\r\n\r\n    return q = {\r\n      defer: function() {\r\n        if (!error) {\r\n          tasks.push(arguments);\r\n          ++remaining;\r\n          pop();\r\n        }\r\n        return q;\r\n      },\r\n      await: function(f) {\r\n        await = f;\r\n        all = false;\r\n        if (!remaining) notify();\r\n        return q;\r\n      },\r\n      awaitAll: function(f) {\r\n        await = f;\r\n        all = true;\r\n        if (!remaining) notify();\r\n        return q;\r\n      }\r\n    };\r\n  }\r\n\r\n  function noop() {}\r\n\r\n  queue.version = \"1.0.7\";\r\n  if (typeof define === \"function\" && define.amd) define(function() { return queue; });\r\n  else if (typeof module === \"object\" && module.exports) module.exports = queue;\r\n  else this.queue = queue;\r\n})();\r\n","/* global d3, $, queue */\r\n// Dependency on queue.js\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    // Heights & Widths\r\n    var legendHeight = 60,\r\n\tlegendWidth = '100%',\r\n\tmapWidth = 600,\r\n\tmapHeight = 400;\r\n\r\n    var currentyear;\r\n    var svgContainer;\r\n    var opChgScale;\r\n\r\n    // Helper functions\r\n\r\n    function toTitleCase(str) {\r\n        return str.replace(/\\w\\S*/g, function(txt) {\r\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\r\n        });\r\n    }\r\n\r\n\r\n\r\n    function initialize() {\r\n\tqueue()\r\n\t//should be town polym data\r\n\t.defer(d3.json, \"js/data/opioid_count_by_town.geo.json\")\r\n\t//.defer(d3.json, \"us_states_5m.geo.json\")\r\n\t//should be opioid death data\r\n\t.defer(d3.json, \"js/data/opioid_count_by_town.geo.json\")\r\n\t//.defer(d3.csv, \"us_pop.csv\")\r\n\t.awaitAll(generateMap);\r\n    }\r\n\r\n    function generateMap(error, results) {\r\n\r\n\tvar maTowns = results[0];\r\n\tvar maOpioid = results[1];\r\n\r\n\r\n\t$('.controls-map').click(function() {\r\n\t    $(\"#odMap_timeline\").val($(this).data('select'));\r\n\t    setSymbology($(this).data('select'));\r\n\t});\r\n\r\n\tfor (var i = 0; i < maTowns.features.length; i++) {\r\n\t    if (maTowns.features[i].properties.town !== maOpioid.features[i].TOWN) {\r\n\t\tconsole.log('ASSERT failure for index: ' + i);\r\n\t\tconsole.log(maTowns.features[i].properties.town + ' mismatch with ' + maOpioid.features[i].TOWN);\r\n\t\t// alert('Input data corrupted: generation of map terminated.');\r\n\t\treturn;\r\n            }\r\n\t    maTowns.features[i].properties.OPIOIDSTATS = maOpioid.features[i].properties;\r\n\t}\r\n\r\n\tsvgContainer = d3.select(\"#odMap_map\")\r\n\t    .classed(\"svg-container\", true) //container class to make it responsive\r\n\t    .append(\"svg\")\r\n\t    .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\r\n\t    .attr(\"viewBox\", \"0 0 \"+mapWidth+\" \"+mapHeight)\r\n\t    //class to make it responsive\r\n\t    .classed(\"svg-content-responsive\", true)\r\n\t    .style(\"border\", \"0px solid steelblue\");\r\n\r\n\tvar tooltip = d3.select('#odMap_map').append('div')\r\n\t    .attr('class', 'hidden tooltip');\r\n\r\n\t//#eff3ff\r\n\r\n\topChgScale = d3.scale.threshold()\r\n\t    .domain([0.01, 1.01, 5.01, 15.01, 33.01, 64.01, Infinity])\r\n\t    .range([\"#f1f1f1\",\"#c6dbef\",\"#9ecae1\",\"#6baed6\",\"#4292c6\",\"#2171b5\", \"#084594\"]);\r\n\topChgScale.domainStrings = function() {\r\n\t    return (['0', '1', '2-5', '6-15', '16-33', '34-64', '>64'\r\n\t    ]);\r\n\t};\r\n\r\n\r\n\tvar projection = d3.geo.conicConformal()\r\n\t    .parallels([41 + 43 / 60, 42 + 41 / 60])\r\n\t    .rotate([71 + 30 / 60, -41])\r\n\t    .scale([10000])\r\n\t    .translate([mapWidth/1.8, mapHeight*1.1]);\r\n\r\n\tvar geoPath = d3.geo.path()\r\n\t    .projection(projection);\r\n\r\n\tsvgContainer.selectAll(\"path\")\r\n\t    .data(maTowns.features)\r\n\t    .enter()\r\n\t    .append(\"path\")\r\n\t    .classed(\"deathmap\", true)\r\n\t    .attr(\"d\", function(d, i) {\r\n\t\treturn geoPath(d);\r\n\t    })\r\n\t    .style(\"stroke\", \"#2f363d\")\r\n\t    .style(\"stroke-width\", \"0.1px\")\r\n\t    .style(\"fill\", \"white\")\r\n\t    .on('mousemove', function(d) {\r\n\t\tvar mouse = d3.mouse(svgContainer.node()).map(function(d) {\r\n\t\t    return parseInt(d);\r\n\t\t});\r\n\r\n\t\tvar style = 'left:'+((100*mouse[0]/mapWidth)+3)+'% !important;top:'+(100*mouse[1]/mapHeight)+'% !important;';\r\n\t\t// Add transformation based on where the mouse is (top, bottom, left, right) to keep it in view\r\n\t\tvar transformX= mouse[0] > mapWidth/2 ? '-160%' : 0,\r\n\t\t    transformY= mouse[1] > mapHeight/2 ? '-100%' : 0;\r\n\t\tstyle += 'transform: translate('+transformX+','+transformY+');white-space:nowrap;';\r\n\r\n\t\tvar string_base = \"yr\";\r\n\t\tvar currentvalue = string_base.concat(currentyear);\r\n\t\tvar currentrate;\r\n\r\n\t\tif (d.properties[currentvalue] > 0) {\r\n\t\t    currentrate = d3.format(\".0f\")(d.properties[currentvalue]);\r\n\t\t} else if (d.properties[currentvalue] === 0) {\r\n\t\t    currentrate = d3.format(\".0f\")(d.properties[currentvalue]);\r\n\t\t} else {\r\n\t\t    currentrate = \"N/A*\";\r\n\t\t}\r\n\r\n\t\ttooltip.classed('hidden', false)\r\n\t\t    .attr('style', style)\r\n\t\t    .html(\"<b>\" + toTitleCase(d.properties.TOWN) + \"</b> | \" + currentrate);\r\n\t    })\r\n\r\n\t    .on('mouseover', function(d, i) {\r\n\t\td3.select(this).style('fill-opacity', 0.25)\r\n\t\t    .style(\"stroke\", \"white\")\r\n\t\t    .style(\"stroke-width\", \"2px\");\r\n\t    })\r\n\t    .on('mouseout', function(d, i) {\r\n\t\ttooltip.classed('hidden', true);\r\n\t\td3.selectAll('path.deathmap')\r\n\t\t    .style(\"fill-opacity\", 1)\r\n\t\t    .style(\"stroke\", \"#2f363d\")\r\n\t\t\t.style(\"stroke-width\", \"0.1px\");\r\n\t    });\r\n\r\n\r\n\tgetYear();\r\n\tgenerateLegend(opChgScale, 'odMap_legend', 'Count of Opioid Related Deaths by Municipality');\r\n\r\n\r\n    } // generateMap\r\n\r\n    function getYear() {\r\n        setSymbology(2000);\r\n        $(\"#odMap_timeline\").on('input change', function() {\r\n            setSymbology($(this).val());\r\n        });\r\n    }\r\n\r\n    function setSymbology(year) {\r\n\r\n        var szAttr = 'yr' + year;\r\n        currentyear = year;\r\n        $('#odMap_titlePrefix').html('Count of Opiod Related Deaths in Massachusetts in');\r\n        $('#odMap_fromYear').html(year);\r\n\r\n        $('#odMap_source').html('Sources: Massachusetts Department of Public Health,' +\r\n                             '<br>Massachusetts Registry of Vital Records and Statistics</>');\r\n\r\n        svgContainer.selectAll(\"path.deathmap\")\r\n            .transition()\r\n            .duration(500)\r\n            .style(\"fill\", function(d, i) {\r\n                var delta = +d.properties.OPIOIDSTATS[szAttr];\r\n                return (delta === -9999) ? '#f1f1f1' : opChgScale(delta);\r\n            });\r\n    }\r\n\r\n    function generateLegend(scale, szDivId, szCaption) {\r\n\r\n        var svg = d3.select('#' + szDivId).append(\"svg\")\r\n\t    .attr(\"width\", legendWidth)\r\n\t    .attr(\"height\", legendHeight);\r\n\r\n        var g = svg.append(\"g\");\r\n\r\n        // Create data array.\r\n        var legendData = [];\r\n        //legendData.push({\r\n            //d: -9999,\r\n            //r: '#f1f1f1',\r\n            //s: 'N/A'\r\n        //});\r\n\tfor (var i = 0; i < scale.domain().length; i++) {\r\n            legendData.push({\r\n                d: scale.domain()[i],\r\n                r: scale.range()[i],\r\n                s: scale.domainStrings()[i]\r\n            });\r\n        }\r\n\r\n\tvar unitWidth = 100/legendData.length;\r\n\r\n        g.selectAll(\"rect\")\r\n            .data(legendData)\r\n            .enter().append(\"rect\")\r\n\t    .attr(\"height\", legendHeight/3)\r\n\t    .attr(\"width\", function(d, i) {\r\n\t\treturn unitWidth+'%';\r\n\t    })\r\n            .attr(\"x\", function(d, i) {\r\n\t\treturn (i * unitWidth) + '%';\r\n            })\r\n            .attr(\"y\", 20)\r\n            .style(\"stroke\", \"black\")\r\n            .style(\"stroke-width\", \"0.25px\")\r\n            .style(\"fill\", function(d, i) {\r\n                return d.r;\r\n            });\r\n\r\n        g.selectAll(\"text\")\r\n            .data(legendData)\r\n            .enter().append(\"text\")\r\n\t    .attr('text-anchor', 'middle')\r\n            .attr(\"x\", function(d, i) {\r\n\t\treturn (i * unitWidth) + (unitWidth/2) + '%';\r\n            })\r\n\t    .attr(\"y\", 55)\r\n            .text(function(d, i) {\r\n                return d.s;\r\n            })\r\n            .style(\"font-size\", \"12px\");\r\n\r\n        g.append(\"text\")\r\n            .attr(\"class\", \"caption\")\r\n            .attr(\"y\", 12)\r\n            .text(szCaption);\r\n    } // generateLegend()\r\n\r\n\r\n    $(document).ready(initialize);\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// ///////////////////Map Composite\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// function app2() {\r\n//     queue()\r\n//     //should be town polym data\r\n//     .defer(d3.json, \"js/data/TOWN.geo.json\")\r\n//     //.defer(d3.json, \"us_states_5m.geo.json\")\r\n//     //should be opioid death data\r\n//     .defer(d3.json, \"js/data/TOWN.geo.json\")\r\n//     //.defer(d3.csv, \"us_pop.csv\")\r\n//     .awaitAll(generateMap2);\r\n// }\r\n\r\n// function generateMap2(error, results) {\r\n//     $('.controls-map').click(function() {\r\n//         $(\"#timeline\").val($(this).data('select'));\r\n//         setSymbology2($(this).data('select'));\r\n//     });\r\n\r\n//     var maTowns = results[0];\r\n//     var maOpioid = results[1];\r\n\r\n//     var currentyear\r\n\r\n//     var i;\r\n//     for (i = 0; i < maTowns.features.length; i++) {\r\n//         if (maTowns.features[i].properties.town != maOpioid.features[i].TOWN) {\r\n//             // console.log('ASSERT failure for index: ' + i);\r\n//             // console.log(maTowns.features[i].properties.town + ' mismatch with ' + maOpioid.features[i].TOWN);\r\n//             alert('Input data corrupted: generation of map terminated.');\r\n//             return;\r\n//         }\r\n//         maTowns.features[i].properties.OPIOIDSTATS = maOpioid.features[i].properties;\r\n//     }\r\n\r\n//     var width = 960,\r\n//         height = 450;\r\n\r\n//     var svgContainer = d3.select(\"#map2\").append(\"svg\")\r\n//         .attr(\"width\", width)\r\n//         .attr(\"height\", height)\r\n//         .style(\"border\", \"0px solid steelblue\");\r\n\r\n//     var tooltip2 = d3.select('#map2').append('div')\r\n//         .attr('class', 'hidden tooltip2');\r\n\r\n//     var opChgScale = d3.scale.threshold()\r\n//         .domain([0.01, 6.9, 15.9, 31.5, Infinity])\r\n//         .range(colorbrewer.RdPu[5]);\r\n//     opChgScale.domainStrings = function() {\r\n//         return (['< 0.01', '0.01-6.9', '6.9-15.9',\r\n//             '15.9-31.5', '>31.5'\r\n//         ]);\r\n//     };\r\n\r\n//     function toTitleCase(str) {\r\n//         return str.replace(/\\w\\S*/g, function(txt) {\r\n//             return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\r\n//         });\r\n//     }\r\n\r\n//     var projection = d3.geo.conicConformal()\r\n//         .parallels([41 + 43 / 60, 42 + 41 / 60])\r\n//         .rotate([71 + 30 / 60, -41])\r\n//         .scale([10000])\r\n//         .translate([330, 480]);\r\n\r\n//     var geoPath = d3.geo.path()\r\n//         .projection(projection);\r\n\r\n//     var map = svgContainer.selectAll(\"path\")\r\n//         .data(maTowns.features)\r\n//         .enter()\r\n//         .append(\"path\")\r\n//         .attr(\"d\", function(d, i) {\r\n//             return geoPath(d);\r\n//         })\r\n//         .on('mousemove', function(d) {\r\n//             var mouse = d3.mouse(svgContainer.node()).map(function(d) {\r\n//                 return parseInt(d);\r\n//             });\r\n//             var string_base = \"yr\"\r\n//             currentvalue = string_base.concat(currentyear);\r\n//             var currentrate\r\n\r\n//             if (d.properties[currentvalue] > 0) {\r\n//                 currentrate = d3.format(\".1f\")(d.properties[currentvalue]);\r\n//             } else if (d.properties[currentvalue] == 0) {\r\n//                 currentrate = d3.format(\".0f\")(d.properties[currentvalue]);\r\n//             } else {\r\n//                 currentrate = \"N/A*\";\r\n//             }\r\n\r\n\r\n//             tooltip2.classed('hidden', false)\r\n//                 .attr('style', 'left:' + (mouse[0] + 15) +\r\n//                     'px !important; top:' + (mouse[1] + 625) + 'px !important')\r\n//                 .html(\"<b>\" + toTitleCase(d.properties.TOWN) + \"</b> | \" + currentrate);\r\n//         })\r\n//         .on('mouseover', function(d, i) {\r\n\r\n//             var currentState = this;\r\n//             d3.select(this).style('fill-opacity', 0.25)\r\n//                 .style(\"stroke\", \"white\")\r\n//                 .style(\"stroke-width\", \"2px\");\r\n//         })\r\n//         .on('mouseout', function(d, i) {\r\n//             tooltip2.classed('hidden', true);\r\n//             d3.selectAll('path')\r\n//                 .style(\"fill-opacity\", 1)\r\n//                 .style(\"stroke\", \"#2f363d\")\r\n//                 .style(\"stroke-width\", \"0.1px\");\r\n//         })\r\n//         .style(\"stroke\", \"#2f363d\")\r\n//         .style(\"stroke-width\", \"0.1px\")\r\n//         .style(\"fill\", \"white\")\r\n//         .on('mouseenter', function(d, i) {\r\n\r\n//             //var string_base = \"yr\"\r\n//             //currentvalue = string_base.concat(currentyear);\r\n//             //console.log(d.properties[currentvalue]);\r\n//         })\r\n//         .on('mouseleave', function(d) {\r\n\r\n//         });\r\n\r\n//     var aYears = [\r\n//         [2000, 2001],\r\n//         [2001, 2002],\r\n//         [2002, 2003],\r\n//         [2003, 2004],\r\n//         [2004, 2005],\r\n//         [2005, 2006],\r\n//         [2006, 2007],\r\n//         [2007, 2008],\r\n//         [2008, 2009],\r\n//         [2010, 2011],\r\n//         [2011, 2012],\r\n//         [2012, 2013],\r\n//         [2013, 2014],\r\n//         [2014, 2014.5]\r\n//     ];\r\n\r\n//     var index = 0;\r\n//     getYear();\r\n\r\n//     generateLegend2(opChgScale, 'legend2', 'Composite Index Values');\r\n\r\n//     function getYear() {\r\n//         setSymbology2(2000);\r\n//         $(\"#timeline\").on('input change', function() {\r\n//             var year = $(this).val()\r\n//             setSymbology2($(this).val());\r\n//         });\r\n//     };\r\n\r\n\r\n//     function setSymbology2(year) {\r\n\r\n//         var szAttr = 'yr' + year;\r\n//         currentyear = year\r\n//         var toyear = eval(year) + 1\r\n\r\n//         $('#titlePrefix2').html('Opioid Overdose Events in Massachusetts from');\r\n//         $('#fromYear2').html(year);\r\n//         $('#titleMidfix2').html('to');\r\n//         $('#toYear2').html(toyear).append('<span>*</span>');\r\n//         $('#map2-note').html('*Fatal and nonfatal overdoses, ambulance trips, emergency room admissions, narcan use, etc.');\r\n//         $('#map2-source').html('Data Sources: U.S. Census Bureau;' +\r\n//                             '<br />Executive Office of Health and Human Services'+\r\n//                             '<br />(Registry of Vital Records and Statistics,' +\r\n//                             '<br />Massachusetts Department of Public Health)');\r\n\r\n\r\n\r\n//         svgContainer.selectAll(\"path\")\r\n//             .transition()\r\n//             .duration(500)\r\n//             .style(\"fill\", function(d, i) {\r\n\r\n//                 var delta = +d.properties.OPIOIDSTATS[szAttr];\r\n//                 return (delta === -9999) ? '#f1f1f1' : opChgScale(delta);\r\n//             });\r\n//     }\r\n\r\n//     function generateLegend2(scale, szDivId, szCaption) {\r\n//         var width2 = 550,\r\n//             height2 = 80;\r\n\r\n//         var svg = d3.select('#' + szDivId).append(\"svg\")\r\n//             .attr(\"width\", width2)\r\n//             .attr(\"height\", height2);\r\n\r\n//         var g = svg.append(\"g\");\r\n\r\n//         // Create data array.\r\n//         var legendData = [];\r\n//         legendData.push({\r\n//             d: -9999,\r\n//             r: '#f1f1f1',\r\n//             s: 'N/A'\r\n//         });\r\n//         var i;\r\n//         for (i = 0; i < scale.domain().length; i++) {\r\n//             legendData.push({\r\n//                 d: scale.domain()[i],\r\n//                 r: scale.range()[i],\r\n//                 s: scale.domainStrings()[i]\r\n//             });\r\n//         }\r\n\r\n//         g.selectAll(\"rect\")\r\n//             .data(legendData)\r\n//             .enter().append(\"rect\")\r\n//             .attr(\"height\", 20)\r\n//             .attr(\"width\", 50)\r\n//             .attr(\"x\", function(d, i) {\r\n//                 return i * 55;\r\n//             })\r\n//             .attr(\"y\", 20)\r\n//             .style(\"stroke\", \"black\")\r\n//             .style(\"stroke-width\", \"0.25px\")\r\n//             .style(\"fill\", function(d, i) {\r\n//                 return d.r;\r\n//             });\r\n\r\n//         g.selectAll(\"text\")\r\n//             .data(legendData)\r\n//             .enter().append(\"text\")\r\n//             .attr(\"x\", function(d, i) {\r\n//                 return i * 55;\r\n//             })\r\n//             .attr(\"y\", 60)\r\n//             .text(function(d, i) {\r\n//                 return d.s;\r\n//             })\r\n//             .style(\"font-size\", \"12px\");\r\n\r\n//         g.append(\"text\")\r\n//             .attr(\"class\", \"caption\")\r\n//             .attr(\"y\", 12)\r\n//             .text(szCaption);\r\n//     } // generateLegend2()\r\n// } // generateMap2\r\n","var Vis = (function(d3) {\r\n    var geojson;\r\n    queue()\r\n        .defer(d3.json, 'js/data/TOWN.geo.json')\r\n        .defer(d3.json, 'js/data/data.json')\r\n        .await(visualize);\r\n\r\n    var width = 525,\r\n        height = 325;\r\n\r\n    var projection = d3.geo.conicConformal()\r\n        .parallels([41 + 43 / 60, 42 + 41 / 60])\r\n        .rotate([71 + 30 / 60, -41])\r\n        .scale([7500])\r\n        .translate([250, 350]);\r\n\r\n    var $maps_sub = d3.select(\"#carte\").append(\"svg\")\r\n        .attr(\"width\", width)\r\n        .attr(\"height\", height);\r\n\r\n    var path = d3.geo.path().projection(projection),\r\n        palette = d3.scale.threshold().domain([0, 0.1, 0.15, 0.35, 0.6, 1.00]).range(colorbrewer.YlOrBr[6]);\r\n\r\n\r\n\r\n    function visualize(error, states, data) {\r\n\r\n        var visualizationWrapper = d3.select('#treatmentMaps_maps');\r\n\r\n        data.data.forEach(function(data, i) {\r\n            var wrapper = visualizationWrapper\r\n                .append('div')\r\n                .style({\r\n                    width: width + 'px',\r\n                    height: height + 'px'\r\n                });\r\n\r\n            createMap(wrapper, states, data)\r\n        });\r\n    }\r\n\r\n\r\n\r\n    function createMap(wrapper, geo, data) {\r\n\r\n        wrapper.append('p')\r\n            .text(data.key)\r\n            .attr('class', 'legend');\r\n        wrapper.append('p2')\r\n            .text(\"\")\r\n            .attr('class', 'legend');\r\n\r\n        wrapper.append('y');\r\n\r\n        var $maps_sub = wrapper.append('svg')\r\n            .attr({\r\n                width: width,\r\n                height: height\r\n            });\r\n\r\n        $maps_sub.selectAll('path')\r\n            .data(geo.features)\r\n            .enter()\r\n            .append('path')\r\n            .attr('d', path)\r\n            .style(\"stroke\", \"white\")\r\n            .style(\"stroke-width\", \"0.0px\")\r\n            .style('fill', function(d, i) {\r\n                var value = data.values[d.properties.TOWN];\r\n                return palette(value);\r\n            })\r\n            .on('mouseover', function(d, i) {\r\n\r\n            })\r\n            .on('mouseout', function(d, i) {\r\n\r\n            })\r\n            .attr('class', function(d) {\r\n                return d.properties.TOWN.toLowerCase()\r\n            })\r\n            .attr('id', 'bsasmap')\r\n            .on('mouseenter', function(d, i) {\r\n                notify('.' + d.properties.TOWN.toLowerCase(), 'select');\r\n                // var currentState = this;\r\n                // console.log(this);\r\n                // d3.select(this).style('fill-opacity', 0.4).style(\"stroke\", \"white\").style(\"stroke-width\", \"1.5px\");\r\n            })\r\n            .on('mouseleave', function(d) {\r\n                notify('.' + d.properties.TOWN.toLowerCase(), 'unselect');\r\n\r\n            })\r\n            .on('select', function(self) {\r\n                var geoData = self.data();\r\n                var town_value\r\n\r\n                if (data.values[geoData[0].properties.TOWN] !== 'Null') {\r\n                    //console.log(data.values[geoData[0].properties.TOWN] == 'Null');\r\n                    town_value = d3.format(\"%,.2f\")(data.values[geoData[0].properties.TOWN]);\r\n                } else {\r\n                    town_value = \"N/A\";\r\n                };\r\n\r\n                //console.log(town_value);\r\n\r\n                self.node().parentNode.parentNode.getElementsByTagName('p2')[0].innerHTML = (geoData[0].properties.TOWN + \":  \" + town_value);\r\n                d3.select((self.node())).style('fill-opacity', 0.4).style(\"stroke\", \"white\").style(\"stroke-width\", \"1.5px\");\r\n            })\r\n            .on('unselect', function(self) {\r\n                self.node().parentNode.parentNode.getElementsByTagName('p2')[0].innerHTML = \"\";\r\n                d3.selectAll('#treatmentMaps_maps path').style({ 'fill-opacity': 1 }).style(\"stroke\", \"white\").style(\"stroke-width\", \"0.0px\");\r\n            })\r\n\r\n        function notify(selector, eventName) {\r\n            d3.selectAll(selector)[0].forEach(function(el, i) {\r\n                var shape = d3.select(el);\r\n                shape.on(eventName)(shape);\r\n            });\r\n        }\r\n\r\n    }\r\n\r\n    var opChgScale = d3.scale.threshold().domain([0, 0.1, 0.15, 0.35, 0.6, 1.00]).range(colorbrewer.YlOrBr[6])\r\n    opChgScale.domainStrings = function() {\r\n        return (['0%', '>0-10%', '>10-15%', '>15-35%',\r\n            '>35-60%', '>60-100%'\r\n        ]);\r\n    };\r\n    //popChgScale.domainStrings = function() { return (['< 0.1', '0.25-0.50', '0.50-0.75', '0.75-1.0', '1.0-1.25',\r\n    //'1.25-1.50', '1.50-1.75', '1.75-2.0', '> 2.0']); };\r\n    generateLegend_map_sub(opChgScale, 'treatmentMaps_legend', 'Heroin Primary Substance of Abuse upon Seeking Treatment (%)');\r\n\r\n    function generateLegend_map_sub(scale, szDivId, szCaption) {\r\n        var width = 550,\r\n            height = 70;\r\n\r\n        var $maps_sub_svg = d3.select('#' + szDivId).append(\"svg\")\r\n            .attr(\"width\", width)\r\n            .attr(\"height\", height);\r\n\r\n        var $maps_sub_legends = $maps_sub_svg.append(\"g\");\r\n\r\n        // Create data array.\r\n        var legendData = [];\r\n        legendData.push({ d: -9999, r: '#f1f1f1', s: 'N/A*' });\r\n        var i;\r\n        for (i = 0; i < scale.domain().length; i++) {\r\n            legendData.push({ d: scale.domain()[i], r: scale.range()[i], s: scale.domainStrings()[i] });\r\n        }\r\n\r\n        $maps_sub_legends.selectAll(\"rect\")\r\n            .data(legendData)\r\n            .enter().append(\"rect\")\r\n            .attr(\"height\", 20)\r\n            .attr(\"width\", 50)\r\n            .attr(\"x\", function(d, i) {\r\n                return i * 55;\r\n            })\r\n            .attr(\"y\", 20)\r\n            .style(\"stroke\", \"black\")\r\n            .style(\"stroke-width\", \"0.25px\")\r\n            .style(\"fill\", function(d, i) {\r\n                return d.r;\r\n            });\r\n\r\n        $maps_sub_legends.selectAll(\"text\")\r\n            .data(legendData)\r\n            .enter().append(\"text\")\r\n            .attr(\"x\", function(d, i) {\r\n                return i * 55;\r\n            })\r\n            .attr(\"y\", 55)\r\n            .text(function(d, i) {\r\n                return d.s;\r\n            })\r\n            .style(\"font-size\", \"12px\");\r\n\r\n        $maps_sub_legends.append(\"text\")\r\n            .attr(\"class\", \"caption\")\r\n            .attr(\"y\", 12)\r\n            .text(szCaption);\r\n    }\r\n\r\n})(d3);\r\n","/*======================================================================\r\n MultiLines\r\n ======================================================================*/\r\nvar margin = {\r\n    top: 20,\r\n    right: 20,\r\n    bottom: 50,\r\n    left: 50,\r\n};\r\n\r\nvar width = 600;\r\nvar height = 400;\r\n\r\nvar MDG = 29;\r\n\r\nvar Massachusetts = [\"MA\"];\r\nvar UnitedStates = [\"USA\"];\r\n\r\n//Set up date formatting and years\r\nvar dateFormat = d3.time.format(\"%Y\");\r\n\r\n//Set up scales\r\nvar xScale = d3.time.scale()\r\n    .range([margin.left, width - margin.right - margin.left]);\r\n\r\nvar yScale = d3.scale.sqrt()\r\n    .range([margin.top, height - margin.bottom]);\r\n\r\n//Configure axis generators\r\nvar xAxis_death = d3.svg.axis()\r\n    .scale(xScale)\r\n    .orient(\"bottom\")\r\n    .ticks(15)\r\n    .tickFormat(function(d) {\r\n        return dateFormat(d);\r\n    })\r\n    .innerTickSize([8]);\r\n\r\nvar yAxis_death = d3.svg.axis()\r\n    .scale(yScale)\r\n    .orient(\"left\")\r\n    .innerTickSize([8]);\r\n\r\n//defines a function to be used to append the title to the tooltip.  you can set how you want it to display here.\r\n//var maketip = function(d) {\r\n//    var tip = '<p class=\"tip3\">' + d.name + '<p class=\"tip1\">' + NumbType(d.value) + '</p> <p class=\"tip3\">' + formatDate(d.date) + '</p>';\r\n//    return tip;\r\n//}\r\n\r\n// add a tooltip to the page - not to the svg itself!\r\nvar tooltip_death = d3.select(\"#deathLines\")\r\n    .append(\"div\")\r\n    .attr(\"class\", \"lines-tooltip\");\r\n\r\n//Configure line\r\n// each line dataset must have a d.year and a d.rate for this to work.\r\nvar line_death = d3.svg.line()\r\n    .x(function(d) {\r\n        return xScale(dateFormat.parse(d.year));\r\n    })\r\n    .y(function(d) {\r\n        return yScale(+d.rate)\r\n    })\r\n    .defined(function(d) {\r\n        return yScale(+d.rate); });\r\n\r\n//Create the empty SVG image\r\nvar $lines_death = d3.select(\"#deathLines\")\r\n    .append(\"svg\")\r\n    .attr(\"width\", width)\r\n    .attr(\"height\", height);\r\n\r\n/*======================================================================\r\n   Creating the Multiple Lines from the Data\r\n ======================================================================*/\r\n\r\n//Load data - first is opioid mortality rates.\r\nd3.csv(\"js/data/death_states.csv\", function(data) {\r\n    var years = d3.keys(data[0]).slice(1, 65); //\r\n    //console.log(years);\r\n\r\n    //Create a new, empty array to hold our restructured dataset\r\n    var dataset = [];\r\n\r\n    //Loop once for each row in data\r\n    data.forEach(function(d, i) {\r\n\r\n        var OMRs = [];\r\n\r\n        years.forEach(function(y) { //Loop through all the years - and get the rates for this data element\r\n\r\n\r\n            if (d[y]) { /// What we are checking is if the \"y\" value - the year string from our array, which would translate to a column in our csv file - is empty or not.\r\n\r\n                OMRs.push({ //Add a new object to the new rates data array - for year, rate. These are OBJECTS that we are pushing onto the array\r\n                    year: y,\r\n                    rate: d[y], // this is the value for, for example, d[\"2004\"]\r\n                    Geography: d.Geography,\r\n                    FullName: d.FullName\r\n                });\r\n            }\r\n\r\n        });\r\n\r\n        dataset.push({ // At this point we are accessing one index of data from our original csv \"data\", above and we have created an array of year and rate data from this index. We then create a new object with the Geography value from this index and the array that we have made from this index.\r\n            Geography: d.Geography,\r\n            FullName: d.FullName,\r\n            rates: OMRs // we just built this from the current index.\r\n        });\r\n\r\n    });\r\n    //Set scale domains - max and min of the years\r\n    xScale.domain(\r\n        d3.extent(years, function(d) {\r\n            return dateFormat.parse(d);\r\n        }));\r\n\r\n    // max of rates to 0 (reversed, remember)\r\n    yScale.domain([\r\n        d3.max(dataset, function(d) {\r\n            return d3.max(d.rates, function(d) {\r\n                return +d.rate;\r\n            });\r\n        }),\r\n        0\r\n    ]);\r\n\r\n\r\n    //Make a group for each Geography\r\n    var groups = $lines_death.selectAll(\"g.lines-death\")\r\n        .data(dataset)\r\n        .enter()\r\n        .append(\"g\")\r\n        .attr(\"class\", \"lines-death\");\r\n\r\n    //Within each group, create a new line/path,\r\n    //binding just the rates data to each one\r\n    groups.selectAll(\"path\")\r\n        .data(function(d) { // because there's a group with data already...\r\n            return [d.rates]; // it has to be an array for the line function\r\n        })\r\n        .enter()\r\n        .append(\"path\")\r\n        .attr(\"class\", \"line-death\")\r\n        .classed(\"massachusetts\", function(d, i) {\r\n            //console.log(d[i].Geography);\r\n            if ($.inArray(d[i].Geography, Massachusetts) != -1) {\r\n                //console.log(\"true\");\r\n                return true;\r\n            } else {\r\n                //console.log(\"false\");\r\n                return false;\r\n            }\r\n        })\r\n        .classed(\"usa\", function(d, i) {\r\n            //console.log(d[i].Geography);\r\n            if ($.inArray(d[i].Geography, UnitedStates) != -1) {\r\n                //console.log(\"true\");\r\n                return true;\r\n            } else {\r\n                //console.log(\"false\");\r\n                return false;\r\n            }\r\n        })\r\n        .attr(\"d\", line_death);\r\n\r\n\r\n    /*======================================================================\r\n      Adding the Axes\r\n    ======================================================================*/\r\n\r\n\r\n    var margin = {\r\n        top: 20,\r\n        right: 20,\r\n        bottom: 20,\r\n        left: 50,\r\n    };\r\n\r\n    var width = 600;\r\n    var height = 400;\r\n\r\n\r\n\r\n    $lines_death.append(\"g\")\r\n        .attr(\"class\", \"x axis-death\")\r\n        // .attr(\"transform\", \"translate(0,\" + (height - margin.bottom) + \")\")\r\n        .attr(\"transform\", \"translate(0,\" + (height - margin.bottom - margin.top - margin.top) + \")\")\r\n        .call(xAxis_death)\r\n        .append(\"text\")\r\n        .attr(\"x\", width - margin.left)\r\n        .attr(\"y\", margin.bottom+10)\r\n        .attr(\"dy\", \"1em\")\r\n        .style(\"text-anchor\", \"end\")\r\n        .attr(\"class\", \"label\")\r\n        .text(\"Year\");\r\n\r\n    $lines_death.append(\"g\")\r\n        .attr(\"class\", \"y axis-death\")\r\n        // .attr(\"transform\", \"translate(\" + margin.left + \",0)\")\r\n        .attr(\"transform\", \"translate(\" + margin.left + \",\" + (-margin.top / 2) + ')')\r\n        .call(yAxis_death)\r\n        .append(\"text\")\r\n        .attr(\"transform\", \"rotate(-90)\")\r\n        .attr(\"x\", -margin.top)\r\n        .attr(\"y\", -margin.left)\r\n        .attr(\"dy\", \"1em\")\r\n        .style(\"text-anchor\", \"end\")\r\n        .attr(\"class\", \"label\")\r\n        .text(\"Age-Adjusted Opioid Death Rate per 100,000 People\");\r\n\r\n    /*======================================================================\r\n      MDG line\r\n    ======================================================================*/\r\n\r\n    /*svg.append(\"line\")\r\n        .attr(\"class\", \"MDG\")\r\n        .attr(\"x1\", margin.left)\r\n        .attr(\"y1\", yScale(MDG))\r\n        .attr(\"x2\", width - margin.left - margin.right + 15)\r\n        .attr(\"y2\", yScale(MDG));*/\r\n    $lines_death.append(\"text\")\r\n        .attr(\"class\", \"aside-ma\")\r\n        .attr(\"x\", width - margin.left - 15)\r\n        .attr(\"y\", yScale(23.8) - 6)\r\n        .attr(\"dy\", \"1em\")\r\n        .style(\"text-anchor\", \"start\")\r\n        .text(\"MA\");\r\n\r\n    $lines_death.append(\"text\")\r\n        .attr(\"class\", \"aside-usa\")\r\n        .attr(\"x\", width - margin.left - 45)\r\n        .attr(\"y\", yScale(10.0) - 6)\r\n        .attr(\"dy\", \"1em\")\r\n        .style(\"text-anchor\", \"start\")\r\n        .text(\"USA\");\r\n\r\n    /*======================================================================\r\n      Mouse Functions\r\n    ======================================================================*/\r\n    d3.selectAll(\"g.lines-death\")\r\n        .on(\"mouseover\", mouseoverFunc)\r\n        .on(\"mouseout\", mouseoutFunc)\r\n        .on(\"mousemove\", mousemoveFunc);\r\n\r\n    function mouseoutFunc() {\r\n\r\n        d3.selectAll(\"path.line-death\").classed(\"unfocused\", false).classed(\"focused\", false);\r\n        tooltip_death.style(\"display\", \"none\"); // this sets it to invisible!\r\n    }\r\n\r\n    function mouseoverFunc(d, i) {\r\n\r\n        d3.selectAll(\"path.line\").classed(\"unfocused\", true);\r\n        d3.select(this).select(\"path.line-death\").classed(\"unfocused\", false).classed(\"focused\", true);\r\n        tooltip_death\r\n            .style(\"display\", \"block\") // this removes the display none setting from it\r\n            .html(\"<p><span class='lines-tooltipHeader sans'>\" + d.FullName + \"</span></p>\");\r\n        //console.log(d.FullName);\r\n        // console.log(d.rates[i]);\r\n\r\n    }\r\n\r\n     var coordinates = [0, 0];\r\n\r\n    function mousemoveFunc(d) {\r\n\r\n        coordinates = d3.mouse(this);\r\n        var x = coordinates[0];\r\n        var y = coordinates[1];\r\n\r\n\r\n        tooltip_death\r\n            .style(\"top\", y + \"px\")\r\n            .style(\"left\", x + \"px\")\r\n            .style('position', 'absolute')\r\n            .style('z-index', 1001);\r\n    }\r\n\r\n\r\n\r\n}); // end of data csv\r\n","/* global d3 */\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var rootSelector = '#fentanyl-lines';\r\n\r\n    var chartData = [{\r\n\t\"date\": new Date(\"01/01/2014\"),\r\n\t\"FentanylHeroin\": \"0.19\",\r\n\t\"Fentanyl\": \"0.22\",\r\n\t\"Heroin\": \"0.41\",\r\n\t\"Methadone\": \"0.10\"\r\n\t}, {\r\n\t\"date\": new Date(\"04/01/2014\"),\r\n\t\"FentanylHeroin\": \"0.18\",\r\n\t\"Fentanyl\": \"0.19\",\r\n\t\"Heroin\": \"0.49\",\r\n\t\"Methadone\": \"0.07\"\r\n\t}, {\r\n\t\"date\": new Date(\"07/01/2014\"),\r\n\t\"FentanylHeroin\": \"0.14\",\r\n\t\"Fentanyl\": \"0.14\",\r\n\t\"Heroin\": \"0.53\",\r\n\t\"Methadone\": \"0.10\"\r\n\t}, {\r\n\t\"date\": new Date(\"10/01/2014\"),\r\n\t\"FentanylHeroin\": \"0.22\",\r\n\t\"Fentanyl\": \"0.27\",\r\n\t\"Heroin\": \"0.35\",\r\n\t\"Methadone\": \"0.06\"\r\n\t}, {\r\n\t\"date\": new Date(\"01/01/2015\"),\r\n\t\"FentanylHeroin\": \"0.19\",\r\n\t\"Fentanyl\": \"0.40\",\r\n\t\"Heroin\": \"0.30\",\r\n\t\"Methadone\": \"0.04\"\r\n\t}, {\r\n\t\"date\": new Date(\"04/01/2015\"),\r\n\t\"FentanylHeroin\": \"0.24\",\r\n\t\"Fentanyl\": \"0.38\",\r\n\t\"Heroin\": \"0.29\",\r\n\t\"Methadone\": \"0.05\"\r\n\t}, {\r\n\t\"date\": new Date(\"07/01/2015\"),\r\n\t\"FentanylHeroin\": \"0.19\",\r\n\t\"Fentanyl\": \"0.40\",\r\n\t\"Heroin\": \"0.30\",\r\n\t\"Methadone\": \"0.06\"\r\n\t}, {\r\n\t\"date\": new Date(\"10/01/2015\"),\r\n\t\"FentanylHeroin\": \"0.22\",\r\n\t\"Fentanyl\": \"0.43\",\r\n\t\"Heroin\": \"0.24\",\r\n\t\"Methadone\": \"0.05\"\r\n\t}, {\r\n\t\"date\": new Date(\"01/01/2016\"),\r\n\t\"FentanylHeroin\": \"0.15\",\r\n\t\"Fentanyl\": \"0.50\",\r\n\t\"Heroin\": \"0.17\",\r\n\t\"Methadone\": \"0.04\"\r\n\t}];\r\n\r\n\r\n\r\n\r\n    var yearformat = d3.time.format(\"%Y\");\r\n\r\n    function quarter (date) {\r\n\tvar date2 = new Date();\r\n\tdate2.setMonth(date.getMonth() - 10);\r\n\tvar q = Math.ceil((date2.getMonth()) / 3);\r\n\treturn \"Q\" + q;\r\n    }\r\n\r\n    var seriesColors = [\"#ffffff\", \"#b71c1c\", \"#0071bc\", \"#ffffff\"];\r\n    var seriesLineStrokes = [\"1.5px\", \"3.5px\", \"3.5px\", \"1.5px\"];\r\n    var seriesLineDash = [\"2,2,2,2\", \"0,0,0,0\", \"0,0,0,0\", \"1,1,1,1\"];\r\n    var seriesPointShapes = [\"circle\", \"circle\", \"circle\", \"circle\"];\r\n    var seriesPointWidth = [\"1px\", \"1.5px\", \"1.5px\", \"1px\"];\r\n    var seriesPointFill = [\"#a50f15\", \"#08519c\", \"#636363\", \"#636363\"];\r\n    var xLabel = \"date\";\r\n\r\n\r\n\r\n\r\n    // Dimensions\r\n\r\n    var margin = {\r\n\ttop: 30,\r\n\t   right: 150,\r\n\tbottom: 50,\r\n\tleft: 42\r\n    };\r\n\r\n    var width = 540;\r\n    var height = 300;\r\n\r\n\r\n    var x = d3.scale.ordinal().rangePoints([0, width]);\r\n    var x2 = d3.scale.ordinal().rangePoints([0, width]);\r\n\r\n    var y = d3.scale.linear()\r\n\t.range([height, 0]);\r\n\r\n    var color = d3.scale.ordinal()\r\n\t.range(seriesColors);\r\n\r\n    var lineStroke = d3.scale.ordinal()\r\n\t.range(seriesLineStrokes);\r\n\r\n    var lineDash = d3.scale.ordinal()\r\n\t.range(seriesLineDash);\r\n\r\n    var pointShape = d3.scale.ordinal()\r\n\t.range(seriesPointShapes);\r\n\r\n    var pointWidth = d3.scale.ordinal()\r\n\t.range(seriesPointWidth);\r\n\r\n    var pointFill = d3.scale.ordinal()\r\n\t.range(seriesPointFill);\r\n\r\n    var xAxis_fent = d3.svg.axis()\r\n\t.scale(x)\r\n\t.orient(\"bottom\")\r\n\t.ticks(d3.time.months, 3)\r\n\t.tickFormat(quarter);\r\n\r\n\r\n    var xAxis2_fent = d3.svg.axis()\r\n\t.scale(x)\r\n\t.ticks(d3.time.years, 1)\r\n\t.tickFormat(yearformat)\r\n\t.tickSize(3, 0)\r\n\t.tickPadding(1)\r\n\t.orient(\"bottom\");\r\n\r\n    //percentage formatiing\r\n    var formatPercent = d3.format(\".0%\");\r\n\r\n    var yAxis_fent = d3.svg.axis()\r\n\t.scale(y)\r\n\t.orient(\"left\")\r\n\t.tickFormat(formatPercent)\r\n\t.ticks(5)\r\n\t.tickSize(3, 0)\r\n\t.tickPadding(1);\r\n\r\n    //create tooltipFent\r\n\r\n    // add a tooltipFent to the page - not to the svg itself!\r\n    var tooltipFent = d3.select(\"body\")\r\n\t.append(\"div\")\r\n\t.attr(\"class\", \"tooltipFent\");\r\n\r\n    var line = d3.svg.line()\r\n\t//.interpolate(\"monotone\")\r\n\t.x(function(d) {\r\n\t    return x(d.label);\r\n\t})\r\n\t.y(function(d) {\r\n\t    return y(d.value);\r\n\t});\r\n\r\n\r\n    var $lines_fent = d3.select(document.querySelector(rootSelector))\r\n\t.append(\"svg\")\r\n\t.attr(\"preserveAspectRatio\", \"xMinYMin meet\")\r\n\t.attr(\"viewBox\", \"0 0 \"+(width + margin.left + margin.right) +\" \"+(height + margin.top + margin.bottom))\r\n\t//class to make it responsive\r\n\t.classed(\"svg-content-responsive\", true)\r\n\t.append(\"g\")\r\n\t.attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\r\n\r\n    var varSeries = d3.keys(chartData[0]).filter(function(key) {\r\n\treturn key !== xLabel;\r\n    });\r\n\r\n    color.domain(varSeries);\r\n    lineStroke.domain(varSeries);\r\n    lineDash.domain(varSeries);\r\n    pointShape.domain(varSeries);\r\n    pointWidth.domain(varSeries);\r\n    pointFill.domain(varSeries);\r\n\r\n    var seriesData = varSeries.map(function(name) {\r\n\treturn {\r\n\t    name: name,\r\n\t    values: chartData.map(function(d) {\r\n\t\treturn {\r\n\t\t    name: name,\r\n\t\t    label: d[xLabel],\r\n\t\t    value: +d[name]\r\n\t\t};\r\n\t    })\r\n\t};\r\n    });\r\n\r\n\r\n    x.domain(chartData.map(function(d) {\r\n\treturn d.date;\r\n    }));\r\n\r\n    x2.domain(chartData.map(function(d) {\r\n\treturn d.date;\r\n    }));\r\n\r\n    y.domain([\r\n\td3.min(seriesData, function(c) {\r\n\t    return d3.min(c.values, function(d) {\r\n\t\t//return d.value;\r\n\t\treturn 0;\r\n\t    });\r\n\t}),\r\n\td3.max(seriesData, function(c) {\r\n\t    return d3.max(c.values, function(d) {\r\n\t\treturn d.value;\r\n\t    });\r\n\t})\r\n    ]);\r\n\r\n    $lines_fent.append(\"g\")\r\n\t.attr(\"class\", \"x axis_fent\")\r\n\t.attr(\"transform\", \"translate(0,\" + height + \")\")\r\n\t.call(xAxis_fent)\r\n\t.append(\"path\")\r\n\t.attr(\"class\", \"line\")\r\n\t.style(\"stroke-width\", \"1.5px\")\r\n\t.call(xAxis_fent);\r\n\r\n    $lines_fent.append(\"g\")\r\n\t.attr(\"class\", \"x axis2_fent\")\r\n\t.attr(\"transform\", \"translate(0,\" + (height + 15) + \")\")\r\n\t.call(xAxis2_fent)\r\n\t.append(\"text\")\r\n\t.attr(\"x\", width - margin.left)\r\n\t.attr(\"y\", margin.bottom - 32)\r\n\t.attr(\"dy\", \"1em\")\r\n\t.style(\"text-anchor\", \"end\")\r\n\t.attr(\"class\", \"label\")\r\n\t.text(\"Quarter\");\r\n\r\n\r\n    $lines_fent.append(\"g\")\r\n\t.attr(\"class\", \"y axis_fent\")\r\n\t.call(yAxis_fent)\r\n\t.append(\"text\")\r\n\t.attr(\"transform\", \"rotate(-90)\")\r\n\t.attr(\"x\", 0)\r\n\t.attr(\"y\", -44)\r\n\t.attr(\"dy\", \"1em\")\r\n\t.style(\"text-anchor\", \"end\")\r\n\t   .style(\"font\",\"13px sans-serif\")\r\n\t.style(\"font-weight\", \"normal\")\r\n\t//.attr(\"class\", \"label\")\r\n\t.text(\"Percent Opioid Deaths\");\r\n\r\n    var series = $lines_fent.selectAll(\".series\")\r\n\t.data(seriesData)\r\n\t.enter().append(\"g\")\r\n\t.attr(\"class\", \"seriesData\");\r\n\r\n\r\n    series.append(\"path\")\r\n\t.attr(\"class\", \"line\")\r\n\t.attr(\"d\", function(d) {\r\n\t    return line(d.values);\r\n\t})\r\n\t.style(\"stroke\", function(d) {\r\n\t    return color(d.name);\r\n\t})\r\n\t.style(\"stroke-width\", function(d) {\r\n\t    return lineStroke(d.name);\r\n\t})\r\n\t.style(\"stroke-dasharray\", function(d) {\r\n\t    return lineDash(d.name);\r\n\t})\r\n\t.style(\"fill\", \"none\");\r\n\r\n\r\n    series.append(\"path\")\r\n\t.attr(\"class\", \"hit-area-ext\")\r\n\t.attr(\"d\", function(d) {\r\n\t    return line(d.values);\r\n\t})\r\n\t.attr(\"style\", \"stroke:transparent;stroke-width:10px\")\r\n\t.style(\"fill\", \"none\");\r\n\r\n\r\n    $lines_fent.append(\"text\")\r\n\t.attr(\"class\", \"aside-note\")\r\n\t.attr(\"x\", width + 5)\r\n\t.attr(\"y\", y(chartData[8].FentanylHeroin) - 5)\r\n\t.attr(\"dy\", \"1em\")\r\n\t.style(\"text-anchor\", \"start\")\r\n\t.style(\"font-size\", \"16px\")\r\n\t.text(\"Fentanyl & Heroin\")\r\n\t.style(\"font-weight\", \"normal\");\r\n\r\n    $lines_fent.append(\"text\")\r\n\t.attr(\"class\", \"aside-note\")\r\n\t.attr(\"x\", width + 5)\r\n\t.attr(\"y\", y(chartData[8].Methadone) - 7)\r\n\t.attr(\"dy\", \"1em\")\r\n\t.style(\"text-anchor\", \"start\")\r\n\t.style(\"font-size\", \"16px\")\r\n\t.text(\"Methadone\")\r\n\t.style(\"font-weight\", \"normal\");\r\n\r\n    $lines_fent.append(\"text\")\r\n        .attr(\"class\", \"aside-note\")\r\n        .attr(\"x\", width + 5)\r\n        .attr(\"y\", y(chartData[8].Heroin) - 10)\r\n        .attr(\"dy\", \"1em\")\r\n        .style(\"text-anchor\", \"start\")\r\n        .text(\"Heroin\")\r\n\t.style(\"font-size\", \"16px\");\r\n\r\n    $lines_fent.append(\"text\")\r\n        .attr(\"class\", \"aside-note\")\r\n        .attr(\"x\", width + 5)\r\n        .attr(\"y\", y(chartData[8].Fentanyl) - 10)\r\n        .attr(\"dy\", \"1em\")\r\n        .style(\"text-anchor\", \"start\")\r\n        .text(\"Fentanyl\")\r\n\t.style(\"font-size\", \"16px\")\r\n\t.style(\"fill\", \"#fff\");\r\n\r\n\r\n\r\n    /*======================================================================\r\n     Mouse Functions\r\n    ======================================================================*/\r\n    var focus = $lines_fent.append(\"g\")\r\n\t.attr(\"class\", \"focus\")\r\n\t.style(\"display\", \"none\");\r\n\r\n    focus.append(\"circle\")\r\n\t.style(\"stroke-width\", 1)\r\n\t.attr(\"r\", 6)\r\n\t.attr('pointer-events', 'none');\r\n\r\n    d3.selectAll(\"g.seriesData\")\r\n\t.on(\"mouseover\", mouseoverFunc)\r\n\t.on(\"mouseout\", mouseoutFunc)\r\n\t.on(\"mousemove\", mousemoveFunc);\r\n\r\n    function mouseoutFunc() {\r\n\r\n\td3.selectAll(\"path.line\").classed(\"unfocused\", false).classed(\"focused\", false);\r\n\td3.selectAll(\"path.point\").classed(\"unfocused\", false).classed(\"focused\", false).attr(\"d\", d3.svg.symbol().type(\"circle\").size(15)).style(\"fill-opacity\", \"1\");\r\n\ttooltipFent.style(\"display\", \"none\"); // this sets it to invisible!\r\n\tfocus.style(\"display\", \"none\");\r\n    }\r\n\r\n    function mouseoverFunc(d, i) {\r\n\r\n\td3.selectAll(\"path.line\").classed(\"unfocused\", true);\r\n\td3.selectAll(\"path.point\").classed(\"unfocused\", true).attr(\"d\", d3.svg.symbol().type(\"circle\").size(10)).style(\"fill-opacity\", \"0\");\r\n\t// below code sets the sub set of data even more - they only go \"unfocused\" if a certain line is selected. Otherwise, they remain at the regular opacity. .\r\n\t//         if(!d3.select(this).select(\"path.line\").classed(\"ssAfrica\")) {\r\n\t//             d3.selectAll(\"path.ssAfrica\").classed(\"unfocused\", false);\r\n\t//         }\r\n\r\n\td3.select(this).select(\"path.line\").classed(\"unfocused\", false).classed(\"focused\", true);\r\n\t//d3.select(this).select(\"path.point\").classed(\"unfocused\", false).classed(\"focused\", true).attr(\"d\", d3.svg.symbol().type(\"circle\").size(0));\r\n\tvar x0 = d3.mouse(this)[0];\r\n\tvar y0 = d3.mouse(this)[1]\r\n\tvar y1 = y.invert(y0);\r\n\tvar percentVal = d3.format(\".0%\")(y1)\r\n\r\n\ttooltipFent\r\n\t    .style(\"display\", null) // this removes the display none setting from it\r\n\t.html(\r\n\t    \"<p><span class='tooltipFentHeader sans'>\" + percentVal + \"</span></p>\"\r\n\t);\r\n\t//console.log(d.rates[i]);\r\n\t//console.log(d3.select(this).select(\"path.point\"));\r\n\tfocus.style(\"display\", null);\r\n    }\r\n\r\n    function mousemoveFunc(d) {\r\n\r\n\r\n\r\n\t//console.log(\"events\", window.event, d3.event);\r\n\tvar x0 = d3.mouse(this)[0];\r\n\tvar y0 = d3.mouse(this)[1]\r\n\tvar y1 = y.invert(y0);\r\n\tvar percentVal = d3.format(\".0%\")(y1);\r\n\r\n\tfocus.attr(\"transform\", \"translate(\" + x0 + \",\" + y0 + \")\");\r\n\r\n\r\n\r\n\ttooltipFent\r\n\t    .style(\"top\", (d3.event.pageY - 45) + \"px\")\r\n\t    .style(\"left\", (d3.event.pageX + 5) + \"px\")\r\n\t    .html(\r\n\t\t\"<p><span class='tooltipFentHeader sans'>\" + percentVal + \"</span></p>\"\r\n\t);\r\n    }\r\n})();\r\n","$(document).ready(function() {\r\n\r\n    var prescription = [{\r\n        \"Yes\": 83,\r\n        \"No\": 17\r\n    }, {\r\n        \"Yes\": 57,\r\n        \"No\": 43\r\n    }, {\r\n        \"Yes\": 50,\r\n        \"No\": 50\r\n    }, {\r\n        \"Yes\": 37,\r\n        \"No\": 63\r\n    }];\r\n\r\n    var heroin = [{\r\n        \"Yes\": 65,\r\n        \"No\": 35\r\n    }, {\r\n        \"Yes\": 28,\r\n        \"No\": 72\r\n    }, {\r\n        \"Yes\": 20,\r\n        \"No\": 80\r\n    }, {\r\n        \"Yes\": 13,\r\n        \"No\": 87\r\n    }];\r\n\r\n    var fentanyl = [{\r\n        \"Yes\": 68,\r\n        \"No\": 32\r\n    }, {\r\n        \"Yes\": 30,\r\n        \"No\": 70\r\n    }, {\r\n        \"Yes\": 22,\r\n        \"No\": 78\r\n    }, {\r\n        \"Yes\": 17,\r\n        \"No\": 83\r\n    }];\r\n\r\n    var both = [{\r\n        \"Yes\": 64,\r\n        \"No\": 36\r\n    }, {\r\n        \"Yes\": 24,\r\n        \"No\": 76\r\n    }, {\r\n        \"Yes\": 15,\r\n        \"No\": 85\r\n    }, {\r\n        \"Yes\": 9,\r\n        \"No\": 91\r\n    }];\r\n\r\n    var methadone = [{\r\n        \"Yes\": 76,\r\n        \"No\": 24\r\n    }, {\r\n        \"Yes\": 46,\r\n        \"No\": 54\r\n    }, {\r\n        \"Yes\": 41,\r\n        \"No\": 59\r\n    }, {\r\n        \"Yes\": 27,\r\n        \"No\": 73\r\n    }];\r\n\r\n    var buprenorphine = [{\r\n        \"Yes\": 60,\r\n        \"No\": 40\r\n    }, {\r\n        \"Yes\": 60,\r\n        \"No\": 40\r\n    }, {\r\n        \"Yes\": 60,\r\n        \"No\": 40\r\n    }, {\r\n        \"Yes\": 60,\r\n        \"No\": 40\r\n    }];\r\n\r\n\r\n\r\n\r\n    var data_substance = prescription;\r\n    var time = 0;\r\n    asignVal_substance(data_substance, time);\r\n    $(\"#studyperiod\").addClass(\"active\");\r\n\r\n    // $(\"#options_substance\").on('input change', function() {\r\n    //     data_substance = eval(($(\"#options_substance option:selected\").val()));\r\n    //     asignVal_substance(data_substance, time);\r\n    // });\r\n\r\n\r\n    $(\".btn-time\").on('click', function() {\r\n        $('.btn-time').removeClass(\"active\");\r\n        $(this).addClass(\"active\");\r\n        time = parseInt($(this).val());\r\n        asignVal_substance(data_substance, time);\r\n        var time_period;\r\n        switch (time) {\r\n            case 0:\r\n                time_period = \"During the Study Period\";\r\n                break;\r\n            case 1:\r\n                time_period = \"6 Months Before Death\";\r\n                break;\r\n            case 2:\r\n                time_period = \"3 Months Before Death\";\r\n                break;\r\n            case 3:\r\n                time_period = \"1 Month Before Death\";\r\n                break;\r\n        }\r\n        $(\"#time-perioid\").html(time_period.toLowerCase());\r\n        $(\"#label_blocks\").html(time_period);\r\n    });\r\n\r\n\r\n    function asignVal_substance(type, time) {\r\n        $(\"#people\").empty();\r\n        $('#people').each(function() {\r\n            makeChart_substance(type, time);\r\n            $('#table_substance').html('<table class=\"table\" id=\"table_substance\"><tr><th>Present</th><th>Not Present</th></tr><tr><td class=\"type_substance0\">' + type[time].Yes + '%</td><td class=\"type_substance1\">' + type[time].No + '%</td></tr></table>');\r\n        })\r\n\r\n    };\r\n\r\n\r\n\r\n    function makeChart_substance(data_substance, i) {\r\n        var blockArray_substance = [];\r\n        var noOfBlocks_No = Math.round(data_substance[i].No);\r\n        var noOfBlocks_Yes = Math.round(data_substance[i].Yes);\r\n        var blocksAdded = 0;\r\n        blockArray = addBlocks_substance(\"#people\", noOfBlocks_Yes, noOfBlocks_No, data_substance, blockArray_substance, i);\r\n        addBlock_substance(\"#people\", blockArray_substance, 0);\r\n    }\r\n\r\n    function addBlocks_substance(id, noOfBlocks_Yes, noOfBlocks_No, data_substance, blockArray_substance, i) {\r\n        for (b = 0; b < noOfBlocks_No; b++) {\r\n            blockArray_substance.push('<div class=\"block type_substance' + 1 + ' data-index=' + data_substance[i].No + '\">' + '</div>');\r\n        };\r\n        for (b = 0; b < noOfBlocks_Yes; b++) {\r\n            $(id).append('<div class=\"block type_substance' + 0 + ' data-index=' + data_substance[i].Yes + '\">' + '</div>');\r\n        };\r\n        return blockArray_substance;\r\n\r\n    }\r\n\r\n    function addBlock_substance(id, blockArray_substance, i) {\r\n        if (i < blockArray.length) {\r\n            $(id).append(blockArray_substance[i]);\r\n            i++;\r\n            addBlock_substance(id, blockArray_substance, i);\r\n        }\r\n    }\r\n\r\n\r\n    ////////////////////////\r\n    //PIE CHART\r\n    ///////////////////////\r\n\r\n    var margin = {\r\n        top: 10,\r\n        bottom: 10,\r\n        left: 10,\r\n        right: 0\r\n    };\r\n    var width = 550 - margin.left - margin.right,\r\n        height = 300 - margin.top - margin.bottom;\r\n\r\n    var labelsWidth = width * 0.4;\r\n    var labelWidth = labelsWidth * 0.1;\r\n    var labelHeight = labelWidth * 0.6;\r\n\r\n    var animateDuration = 300;\r\n    var outerRadius = width - labelsWidth < height ? (width - labelsWidth) / 2 : height / 2;\r\n    var innerRadius = outerRadius * 0.5; // 40%\r\n\r\n    var arc = d3.svg.arc()\r\n        .innerRadius(innerRadius)\r\n        .outerRadius(outerRadius);\r\n\r\n    var pie = d3.layout\r\n        .pie()\r\n        .sort(null)\r\n        .value(getValue)\r\n        .startAngle(1.1 * Math.PI)\r\n        .endAngle(3.1 * Math.PI);\r\n\r\n    var explodedIndex;\r\n    var color = d3.scale.ordinal()\r\n        .range([\"#b71c1c\", \"#d32f2f\", \"#f44336\", \"#ef5350\", \"#e57373\", \"#ef9a9a\"]);\r\n\r\n    var $pie_substance = d3.select('#piechart')\r\n        .attr({\r\n            width: width + margin.left + margin.right,\r\n            height: height + margin.top + margin.bottom\r\n        })\r\n        .append('g')\r\n        .attr({\r\n            class: 'labels',\r\n            transform: 'translate(' + (width - (labelsWidth + margin.right)) + ', ' + margin.top + ')'\r\n        })\r\n        .select(getParent)\r\n        .append('g')\r\n        .attr({\r\n            class: 'pie',\r\n            transform: 'translate(' + (outerRadius + margin.left) + ', ' + (height / 2 + margin.top) + ')'\r\n        })\r\n        .select(getParent)\r\n        .append('g')\r\n        .attr({\r\n            class: 'main-legend',\r\n            transform: 'translate(' + (outerRadius + margin.left) + ', ' + (outerRadius + margin.top) + ')'\r\n        })\r\n        .select(getParent);\r\n\r\n    $pie_substance.select('.main-legend')\r\n        .append('circle')\r\n        .attr({\r\n            class: 'border',\r\n            opacity: 0,\r\n            stroke: 'rgba(255,255,255,1)',\r\n            fill: 'rgba(0,0,0,0)',\r\n            r: innerRadius * 0.9\r\n        })\r\n        .select(getParent)\r\n        .append('circle')\r\n        .attr({\r\n            class: 'circle',\r\n            opacity: 0,\r\n            fill: 'rgba(255,255,255,1)',\r\n            r: innerRadius * 0.9\r\n        })\r\n        .select(getParent)\r\n        .append('line')\r\n        .attr({\r\n            opacity: 0,\r\n            stroke: 'rgba(255,255,255,1)',\r\n            x1: 0,\r\n            y1: 0,\r\n            x2: 0,\r\n            y2: 0\r\n        })\r\n        .select(getParent)\r\n        .append('text')\r\n        .attr({\r\n            class: 'legend-title',\r\n            'font-size': '18px',\r\n            y: -1 * innerRadius * 0.13,\r\n            'font-family': 'Arial',\r\n            'text-anchor': 'middle',\r\n            'alignment-baseline': 'middle',\r\n            fill: '#fff'\r\n        })\r\n\r\n    .select(getParent)\r\n        .append('text')\r\n        .attr({\r\n            class: 'description',\r\n            'font-size': '14px',\r\n            y: innerRadius * 0.13,\r\n            'font-family': 'Arial',\r\n            'text-anchor': 'middle',\r\n            'alignment-baseline': 'middle',\r\n            fill: '#fff'\r\n        });\r\n\r\n    function getParent() {\r\n        return this.parentNode;\r\n    }\r\n\r\n    function getValue(d) {\r\n        return d.value;\r\n    }\r\n\r\n\r\n    function getSum(data) {\r\n        var _sum = 0;\r\n        data.forEach(function addValue(item) {\r\n            _sum += item.value;\r\n        });\r\n        return _sum;\r\n    }\r\n\r\n    function arcTween(d) {\r\n        var i;\r\n\r\n        function toArc(t) {\r\n            return arc(i(t));\r\n        }\r\n\r\n        function toEndAngle(t) {\r\n            d.endAngle = i(t);\r\n            return arc(d);\r\n        }\r\n\r\n        if ('undefined' === typeof this._current) {\r\n            i = d3.interpolate(d.startAngle + 0.1, d.endAngle);\r\n            this._current = d;\r\n            return toEndAngle;\r\n        }\r\n        i = d3.interpolate(this._current, d);\r\n        this._current = i(0);\r\n        return toArc;\r\n    }\r\n\r\n    function labelAnimation(d) {\r\n        return 'translate (' + arc.centroid(d) + ')';\r\n    }\r\n\r\n    function fill(d, i) {\r\n        return color(i);\r\n    }\r\n\r\n    function selectArcAnimation(_d) {\r\n        var dist = outerRadius * 0.05;\r\n        _d.midAngle = ((_d.endAngle - _d.startAngle) / 2) + _d.startAngle;\r\n        var x = Math.sin(_d.midAngle) * dist;\r\n        var y = -Math.cos(_d.midAngle) * dist;\r\n        return 'translate(' + x + ',' + y + ')';\r\n    }\r\n\r\n    function updatePie(data) {\r\n        var sum = getSum(data);\r\n        data = pie(data);\r\n        var arcs = $pie_substance.select('.pie')\r\n            .selectAll('.arc')\r\n            .data(data);\r\n\r\n        var isDelay = arcs.selectAll('path').length;\r\n        var _duration = isDelay ? animateDuration : animateDuration / 2;\r\n\r\n        function getPercent(d) {\r\n            return ((d.value / sum) * 100).toFixed(1) + '%';\r\n        }\r\n\r\n        function getLegend(d) {\r\n            return d.data.name + ' Present | ' + d.data.value;\r\n        }\r\n\r\n        function liveLarge(d) {\r\n            var angle = 360 * (d.value / sum);\r\n            var arcLength = (Math.PI * (outerRadius / 2) * angle) / 180;\r\n            return arcLength > Math.PI * outerRadius * 0.01;\r\n        }\r\n\r\n        function onMouseIn(d, i) {\r\n            explodedIndex = i;\r\n            onClick(d, i);\r\n\r\n            function onClick(d, i) {\r\n\r\n                console.log(d.data.option);\r\n                $('.substance-type').html(d.data.description);\r\n                $('#total').html(d.data.value);\r\n                if (d.data.option == \"buprenorphine\") {\r\n                    $('#timeline_blocks').attr('max', 0);\r\n                } else {\r\n                    $('#timeline_blocks').attr('max', 3);\r\n                };\r\n                data_substance = eval(d.data.option);\r\n                asignVal_substance(data_substance, time);\r\n            };\r\n\r\n\r\n            var label = $pie_substance.selectAll('.legend')\r\n                .filter(function(_d, _i) {\r\n                    return i === _i;\r\n                });\r\n            if (!label.attr('data-exit')) {\r\n                label.transition()\r\n                    .duration(animateDuration / 2)\r\n                    .attr({\r\n                        opacity: 1,\r\n                        transform: 'translate(10, ' + ((labelHeight + 5) * i) + ')'\r\n                    });\r\n            }\r\n\r\n\r\n            $pie_substance.selectAll('.arc')\r\n                .filter(function(_d, _i) {\r\n                    return i === _i;\r\n                })\r\n                .transition()\r\n                .duration(animateDuration / 2)\r\n                .attr('transform', selectArcAnimation);\r\n\r\n            $pie_substance.select('.main-legend')\r\n                .select('.border')\r\n                .transition()\r\n                .duration(animateDuration / 2)\r\n                .attr({\r\n                    opacity: 1,\r\n                    stroke: fill(null, i)\r\n                });\r\n\r\n            $pie_substance.select('.main-legend')\r\n                .select('.circle')\r\n                .transition()\r\n                .duration(animateDuration / 2)\r\n                .attr({\r\n                    opacity: 1,\r\n                    fill: fill(null, i)\r\n                });\r\n\r\n            $pie_substance.select('.main-legend')\r\n                .select('line')\r\n                .transition()\r\n                .duration(animateDuration / 2)\r\n                .attr({\r\n                    opacity: 1,\r\n                    stroke: fill(null, i),\r\n                    x1: Math.sin(d.midAngle) * (innerRadius * 0.7),\r\n                    y1: -Math.cos(d.midAngle) * (innerRadius * 0.7),\r\n                    x2: Math.sin(d.midAngle) * innerRadius,\r\n                    y2: -Math.cos(d.midAngle) * innerRadius\r\n                });\r\n\r\n            $pie_substance.select('.main-legend')\r\n                .select('.legend-title')\r\n                .text(d.data.name)\r\n                // .append(d.data.name[1])\r\n                .select(getParent)\r\n                .select('.description')\r\n                .text(d.data.value)\r\n        }\r\n\r\n        function onMouseOut(d, i) {\r\n            $pie_substance.select('.main-legend')\r\n                .selectAll(['.circle', '.border'])\r\n                .transition()\r\n                .duration(animateDuration / 2)\r\n                .attr({\r\n                    opacity: 0\r\n                });\r\n\r\n            $pie_substance.select('.main-legend')\r\n                .select('line')\r\n                .transition()\r\n                .duration(animateDuration / 2)\r\n                .attr({\r\n                    opacity: 0\r\n                });\r\n\r\n            $pie_substance.select('.main-legend')\r\n                .select('.legend-title')\r\n                .text('')\r\n                .select(getParent)\r\n                .select('.description')\r\n                .text('');\r\n\r\n            if ('undefined' === typeof i) {\r\n                return;\r\n            }\r\n            var label = $pie_substance.selectAll('.legend')\r\n                .filter(function(_d, _i) {\r\n                    return i === _i;\r\n                });\r\n\r\n            if (!label.attr('data-exit')) {\r\n                label.transition()\r\n                    .duration(animateDuration / 2)\r\n                    .attr({\r\n                        opacity: 1,\r\n                        transform: 'translate(0, ' + ((labelHeight + 5) * i) + ')'\r\n                    });\r\n            }\r\n\r\n            $pie_substance.selectAll('.arc')\r\n                .filter(function(_d, _i) {\r\n                    return i === _i;\r\n                })\r\n                .transition()\r\n                .duration(animateDuration / 2)\r\n                .attr({\r\n                    transform: 'translate(0,0)'\r\n                });\r\n        }\r\n\r\n        onMouseOut();\r\n        // update Pie\r\n\r\n        arcs.enter()\r\n            .append('g')\r\n            .attr('class', 'arc')\r\n\r\n        .on('click', function(d, i) {\r\n                // onMouseOut.call($(this).parent(), d, i);\r\n                // console.log($(this));\r\n                if (explodedIndex >= 0) {\r\n                    onMouseOut(null, explodedIndex);\r\n                }\r\n                onMouseIn(d, i);\r\n            })\r\n            //.on('mouseout', onMouseOut)\r\n            // .on('mouseout', onMouseOut)\r\n            .append('path')\r\n            .attr({\r\n                fill: fill\r\n            })\r\n            .attr(\"d\", arc).style('stroke', 'white')\r\n            .style('stroke-width', 2)\r\n            .select(getParent)\r\n            .filter(liveLarge)\r\n            .append('text')\r\n            .attr({\r\n                'font-family': 'Arial',\r\n                'font-size': '14px',\r\n                fill: '#fff',\r\n                'text-anchor': 'middle'\r\n            });\r\n\r\n\r\n        arcs.select('path')\r\n            .transition()\r\n            .delay(function delayFn(d, i) {\r\n                return isDelay ? 0 : _duration * i;\r\n            })\r\n            .duration(_duration)\r\n            .attrTween('d', arcTween);\r\n\r\n        arcs.select('text')\r\n            .text(getPercent)\r\n            .transition()\r\n            .duration(animateDuration)\r\n            .attr({\r\n                class: 'label-content',\r\n                transform: labelAnimation\r\n            });\r\n\r\n        arcs.exit()\r\n            .on('mouseenter', null)\r\n            .on('mouseout', null)\r\n            .remove();\r\n\r\n        // Update Legends\r\n\r\n        var legends = $pie_substance\r\n            .select('.labels')\r\n            .selectAll('.legend')\r\n            .data(data);\r\n\r\n        legends.enter()\r\n            .append('g')\r\n            .on('click', function(d, i) {\r\n                // onMouseOut.call($(this).parent(), d, i);\r\n                // console.log($(this));\r\n                if (explodedIndex >= 0) {\r\n                    onMouseOut(null, explodedIndex);\r\n                }\r\n                onMouseIn(d, i);\r\n            })\r\n            .attr('class', 'legend')\r\n            .append('rect')\r\n            .attr({\r\n                width: labelWidth,\r\n                height: labelHeight,\r\n                fill: fill\r\n            })\r\n            .select(getParent)\r\n            .append('text')\r\n            .attr({\r\n                'font-size': '14px',\r\n                'font-family': 'Arial',\r\n                fill: '#666',\r\n                x: labelWidth + 5,\r\n                y: labelHeight / 2 + 5\r\n            })\r\n            .select(getParent)\r\n            .attr({\r\n                opacity: 0,\r\n                transform: function(d, i) {\r\n                    return 'translate(15, ' + ((labelHeight + 5) * i) + ')';\r\n                }\r\n            })\r\n            .transition()\r\n            .duration(animateDuration)\r\n            .attr({\r\n                opacity: 1,\r\n                transform: function(d, i) {\r\n                    return 'translate(0, ' + ((labelHeight + 5) * i) + ')';\r\n                }\r\n            });\r\n\r\n        legends.exit()\r\n            .on('mouseenter', null)\r\n            .on('mouseout', null)\r\n            .attr('data-exit', true)\r\n            .transition()\r\n            .duration(animateDuration / 2)\r\n            .attr({\r\n                opacity: 0,\r\n                transform: function(d, i) {\r\n                    return 'translate(-15, ' + ((labelHeight + 5) * i) + ')';\r\n                }\r\n            })\r\n            .remove();\r\n\r\n\r\n\r\n        legends.select('text').html(getLegend);\r\n\r\n    }\r\n\r\n    var data_pie = [\r\n        { name: 'Heroin', value: 867, option: 'heroin', description: 'heroin' },\r\n        { name: 'Fentanyl', value: 288, option: 'fentanyl', description: 'fentanyl' },\r\n        { name: 'Fentanyl & Heroin', value: 249, option: 'both', description: 'both fentanyl and heroin' },\r\n        { name: 'Prescription Opioid', value: 154, option: 'prescription', description: 'prescription opioid' },\r\n        { name: 'Methadone', value: 84, option: 'methadone', description: 'methadone' },\r\n        { name: 'Buprenorphine', value: 15, option: 'buprenorphine', description: 'buprenorphine' },\r\n    ];\r\n\r\n    generatePie(data_pie);\r\n\r\n\r\n    function generatePie(data) {\r\n        updatePie(data);\r\n    }\r\n\r\n\r\n\r\n})\r\n","$(document).ready(function() {\r\n\r\n    var prescription = [\r\n        [0, 0],\r\n        [\"No\", 58],\r\n        [\"Yes\", 13],\r\n        [\"Yes\", 8],\r\n        [\"No\", 21],\r\n        [0, 0]\r\n    ];\r\n    var heroin = [\r\n        [0, 0],\r\n        [\"No\", 22],\r\n        [\"Yes\", 49],\r\n        [\"Yes\", 17],\r\n        [\"No\", 12],\r\n        [0, 0]\r\n    ];\r\n\r\n    var multi = [\r\n        [\"1\", 15],\r\n        [\"2\", 31],\r\n        [\"3\", 25],\r\n        [\"3\", 18],\r\n        [\"2\", 9],\r\n        [\"1\", 2]\r\n    ];\r\n\r\n\r\n    // var person = '<svg width=\"10\" height=\"10\"><path d=\"M12.6,18.4c0-1,0-2,0-3c0-1.4,0.7-2.5,2-3.1c0.8-0.4,1.6-0.6,2.5-0.6c1,0,1.9,0,2.9,0c1,0,1.9,0.3,2.8,0.8c1,0.6,1.6,1.6,1.6,2.7c0,2.1,0,4.1,0,6.2c0,1.3-0.3,2.5-1.1,3.6c-0.2,0.2-0.4,0.4-0.6,0.6c-0.1,0.1-0.2,0.2-0.2,0.4c-0.2,0.8-0.4,1.6-0.5,2.5c-0.3,1.8-0.6,3.5-0.9,5.3c-0.2,1-0.8,1.5-1.8,1.5c-0.5,0-1.1,0-1.6,0c-0.2,0-0.3,0-0.5,0c-0.6-0.1-1.2-0.7-1.3-1.4c-0.3-1.6-0.5-3.2-0.8-4.9c-0.1-0.8-0.3-1.6-0.5-2.5c-0.1-0.4-0.2-0.7-0.5-1c-0.5-0.5-0.8-1.1-1-1.8c-0.3-0.8-0.4-1.6-0.4-2.5C12.6,20.3,12.6,19.3,12.6,18.4z\"/><path d=\"M13.6,6c0-2.4,1.9-4.7,4.7-4.7c2.7,0,4.8,2.1,4.8,4.8c0,2.7-2.1,4.7-4.7,4.7C15.7,10.7,13.6,8.6,13.6,6z\"/></svg>'\r\n    // console.log(person);\r\n    var table_html = [\r\n        '<table class=\"table\" id=\"table_gender\"><tr><th></th><th>Present</th><th>Not Present</th></tr><tr><th>Male</th><td class=\"type_gender2\">' + prescription[2][1] + '%</td><td class=\"type_gender1\">' + prescription[1][1] + '%</td></tr><tr><th>Female</th><td class=\"type_gender3\">' + prescription[3][1] + '%</td><td class=\"type_gender4\">' + prescription[4][1] + '%</td></tr></table>',\r\n        '<table class=\"table\" id=\"table_gender\"><tr><th></th><th>Present</th><th>Not Present</th></tr><tr><th>Male</th><td class=\"type_gender2\">' + heroin[2][1] + '%</td><td class=\"type_gender1\">' + heroin[1][1] + '%</td></tr><tr><th>Female</th><td class=\"type_gender3\">' + heroin[3][1] + '%</td><td class=\"type_gender4\">' + heroin[4][1] + '%</td></tr></table>',\r\n        '<table class=\"table\" id=\"table_gender\"><tr><th></th><th>0 Prescribers</th><th>1–2 Prescribers</th><th>3+ Prescribers</th></tr><tr><th>Male</th><td td class=\"type_gender0\">' + multi[0][1] + '%</td><td td class=\"type_gender1\">' + multi[1][1] + '%</td><td td class=\"type_gender2\">' + multi[2][1] + '%</td></tr><tr><th>Female</th><td td class=\"type_gender5\">' + multi[5][1] + '%</td><td td class=\"type_gender4\">' + multi[4][1] + '%</td><td td class=\"type_gender3\">' + multi[3][1] + '%</td></tr></table>'\r\n    ];\r\n\r\n\r\n    var data_gender = prescription;\r\n\r\n\r\n    //Set initial values\r\n    makeChart_gender(prescription);\r\n    $('#table_gender').html(table_html[0]);\r\n    $(\"#prescription\").addClass(\"active\");\r\n\r\n    //Link text controls\r\n    $('.controls-block').click(function() {\r\n        var $option = $(this).data('select');\r\n        var $value = eval($(this).val());\r\n        asignVal_gender($option, $value);\r\n    });\r\n\r\n    //Link button controls\r\n    $('.btn-blocks').click(function() {\r\n        var $option = $(this).attr('id');\r\n        var $value = eval($(this).val());\r\n        asignVal_gender($option, $value);\r\n    });\r\n\r\n\r\n    function asignVal_gender(option, value) {\r\n        $(\"#buttons-blocks button\").removeClass(\"active\");\r\n        $('#' + option).addClass('active');\r\n        $(\"#gender\").empty();\r\n        makeChart_gender(eval(option));\r\n        $('#table_gender').html(table_html[value]);\r\n    };\r\n\r\n\r\n    function makeChart_gender(data_gender) {\r\n\r\n        var blockArray = [];\r\n        for (i = 0; i < 6; i++) {\r\n            var noOfBlocks_gender = Math.round(data_gender[i][1]);\r\n            var blocksAdded = 0;\r\n            blockArray_gender = addBlocks_gender(\"#gender\", noOfBlocks_gender, data_gender, blockArray);\r\n        }\r\n        addBlock_gender(\"#gender\", blockArray_gender, 0);\r\n    }\r\n\r\n    function addBlock_gender(id, blockArray, i) {\r\n        if (i < blockArray.length) {\r\n            $(id).append(blockArray[i]);\r\n            i++;\r\n            //timeout += 1;\r\n            // setTimeout(function() {\r\n            addBlock_gender(id, blockArray, i);\r\n            //})\r\n        }\r\n    }\r\n\r\n\r\n    function addBlocks_gender(id, noOfBlocks, data_gender, blockArray) {\r\n        for (b = 0; b < noOfBlocks; b++) {\r\n            // blockArray.push('<div class=\"block type' + i + '\">' + '<p>' + data[i][0] + '</p></div>');\r\n            blockArray.push('<div class=\"block type_gender' + i + ' data-index=' + data_gender[i][0] + '\">' + '</div>');\r\n            // $(id).append('<div class=\"block type'+i+'\"><p>'+ data[i][0] +'</p></div>');\r\n        }\r\n        return blockArray;\r\n    }\r\n\r\n});\r\n\r\n\r\n// var $block = document.getElementByClassName('block');\r\n// $(\".block\").hover(function() { console.log($(this).dataset.index); });\r\n","(function() {\r\n\r\n    var width = 600;\r\n    var height = 300;\r\n    var margin = 50;\r\n    var selected;\r\n\r\n\r\n\r\n    //setup the svg\r\n\r\n    var $bars_age = d3.select(\"#changing_bars\").append(\"svg\")\r\n        .attr(\"width\", width + 100)\r\n        .attr(\"height\", height + 10); // adding some random padding\r\n    $bars_age.append(\"rect\")\r\n        .attr(\"width\", \"100%\")\r\n        .attr(\"height\", \"100%\")\r\n        .attr(\"fill\", \"none\");\r\n\r\n\r\n\r\n    d3.csv(\"js/data/bars-age.csv\", function(error, data) {\r\n\r\n        var selected = \"percentOpiodDeaths\";\r\n        //console.log(column);\r\n        var dataset = drawGraph(data, selected); // you need to finish this function below.\r\n        //\r\n        // //console.log(column, dataset);\r\n        //\r\n        redraw(dataset, selected);\r\n\r\n        d3.select(\"#POD\").classed(\"selected\", true);\r\n        $(\"#POD\").addClass(\"active\");\r\n\r\n        d3.select(\"#POD\")\r\n            .on(\"click\", function(d, i) {\r\n                selected = \"percentOpiodDeaths\"\r\n                dataset = drawGraph(data, selected);\r\n                redraw(dataset, selected);\r\n                var thisButton = d3.select(this);\r\n                d3.selectAll(\"#buttons-bar button\").classed(\"selected\", false);\r\n                $(\"#buttons-bar button\").removeClass(\"active\");\r\n\r\n                d3.selectAll(\"#age18to24\").classed(\"selected\", false);\r\n                $(\"#age18to24\").removeClass(\"active\");\r\n\r\n                thisButton.classed(\"selected\", true);\r\n                $(this).addClass(\"active\");\r\n            });\r\n        d3.select(\"#DR\")\r\n            .on(\"click\", function(d, i) {\r\n                selected = \"deathRate\"\r\n                dataset = drawGraph(data, selected);\r\n                redraw(dataset, selected);\r\n                var thisButton = d3.select(this);\r\n                d3.selectAll(\"#buttons-bar button\").classed(\"selected\", false);\r\n                $(\"#buttons-bar button\").removeClass(\"active\");\r\n\r\n                d3.selectAll(\"#age18to24\").classed(\"selected\", false);\r\n                $(\"#age18to24\").removeClass(\"active\");\r\n\r\n                thisButton.classed(\"selected\", true);\r\n                $(this).addClass(\"active\");\r\n            });\r\n        d3.select(\"#NOD\")\r\n            .on(\"click\", function(d, i) {\r\n                selected = \"numberOpioidDeaths\"\r\n                dataset = drawGraph(data, selected);\r\n                redraw(dataset, selected);\r\n                var thisButton = d3.select(this);\r\n                d3.selectAll(\"#buttons-bar button\").classed(\"selected\", false);\r\n                $(\"#buttons-bar button\").removeClass(\"active\");\r\n\r\n                d3.selectAll(\"#age18to24\").classed(\"selected\", false);\r\n                $(\"#age18to24\").removeClass(\"active\");\r\n\r\n                thisButton.classed(\"selected\", true);\r\n                $(this).addClass(\"active\");\r\n               \r\n            });\r\n\r\n        d3.select(\"#age18to24\")\r\n            .on(\"click\", function(d, i) {\r\n                //selected = \"18to24\"\r\n                // dataset = drawGraph(data, selected);\r\n                // redraw(dataset, selected);\r\n                var thisButton = d3.select(this);\r\n\r\n                //d3.selectAll(\"#buttons-bar button\").classed(\"selected\", false);\r\n                //$(\"#buttons-bar button\").removeClass(\"active\");\r\n                thisButton.classed(\"selected\", true);\r\n                $(this).addClass(\"active\");\r\n\r\n                d3.selectAll(\".malFocus.age18to24\")\r\n                    .classed(\"malSelector\", true);\r\n                d3.selectAll(\".femFocus.age18to24\")\r\n                    .classed(\"femSelector\", true);\r\n\r\n                d3.selectAll(\".malFocus.age25to34\")\r\n                    .classed(\"malSelector\", false);\r\n                d3.selectAll(\".femFocus.age25to34\")\r\n                    .classed(\"femSelector\", false);\r\n\r\n            });\r\n\r\n        d3.select(\"#age25to34\")\r\n            .on(\"click\", function(d, i) {\r\n                //lected = \"18to24\"\r\n                // dataset = drawGraph(data, selected);\r\n                // redraw(dataset, selected);\r\n                var thisButton = d3.select(this);\r\n\r\n                //d3.selectAll(\"#buttons-bar button\").classed(\"selected\", false);\r\n                //$(\"#buttons-bar button\").removeClass(\"active\");\r\n                thisButton.classed(\"selected\", true);\r\n                $(this).addClass(\"active\");\r\n\r\n                d3.selectAll(\".malFocus.age25to34\")\r\n                    .classed(\"malSelector\", true);\r\n                d3.selectAll(\".femFocus.age25to34\")\r\n                    .classed(\"femSelector\", true);\r\n\r\n                d3.selectAll(\".malFocus.age18to24\")\r\n                    .classed(\"malSelector\", false);\r\n                d3.selectAll(\".femFocus.age18to24\")\r\n                    .classed(\"femSelector\", false);    \r\n                    \r\n            });\r\n\r\n        //setup our ui -- requires access to data variable, so inside csv\r\n        // d3.select(\"#menu select\")\r\n        //     .on(\"change\", function() {\r\n        //         column = d3.select(\"#menu select\").property(\"value\");\r\n        //         dataset = drawGraph(data, column);\r\n        //         //console.log(column, dataset);\r\n        //         redraw(dataset, column);\r\n        // });\r\n\r\n    }) // end csv\r\n\r\n    //make the bars for the first data set.  They will be red at first.\r\n\r\n    function drawGraph(data, column) {\r\n\r\n        return data.sort(function(a, b) {\r\n            return b[column] - a[column]; // descending order, biggest at the top!\r\n        }); // cut off the top 10!\r\n\r\n    }\r\n\r\n    // This function is used to draw and update the data. It takes different data each time.\r\n\r\n    function redraw(data, column) {\r\n\r\n        var max = d3.max(data, function(d) {\r\n            return +d[column];\r\n        });\r\n\r\n        xScale = d3.scale.linear()\r\n            .domain([0, max])\r\n            .range([0, width]);\r\n\r\n        yScale = d3.scale.ordinal()\r\n            .domain(d3.range(data.length))\r\n            .rangeBands([0, height], .2);\r\n\r\n        // yScale = function calc(e){return i[((u.get(e)||(\"range\"===t.t?u.set(e,n.push(e)):0/0))-1)%i.length]};\r\n\r\n\r\n        var bars = $bars_age.selectAll(\"rect.bar\")\r\n            .data(data, function(d) {\r\n                return d.gender_age;\r\n            }); // key function!\r\n\r\n\r\n        var age_bar_color = d3.scale.ordinal()\r\n            .range([\"#64B5F6\", \"#FF80AB\"]);\r\n        var age_bar_label = d3.scale.ordinal()\r\n            .range([\"Male\", \"Female\"])\r\n\r\n        var age_bars_legend = $bars_age.selectAll(\".age_bars_legend\")\r\n            .data(options.slice())\r\n            .enter().append(\"g\")\r\n            .attr(\"class\", \"age_bars_legend\")\r\n            .attr(\"transform\", function(d, i) {\r\n                return \"translate(0,\" + (height - (margin * 2) + (i * 24)) + \")\";\r\n            });\r\n\r\n        age_bars_legend.append(\"rect\")\r\n            .attr(\"x\", width - 18)\r\n            .attr(\"width\", 20)\r\n            .attr(\"height\", 20)\r\n            .style(\"fill\", age_bar_color);\r\n\r\n\r\n        age_bars_legend.append(\"text\")\r\n            .attr(\"x\", width + 4)\r\n            .attr(\"y\", 9)\r\n            .attr(\"dy\", \".35em\")\r\n            .style(\"text-anchor\", \"start\")\r\n            .text(age_bar_label);\r\n\r\n        //update -- existing bars get blue when we \"redraw\". We don't change labels.\r\n        // bars\r\n        //   .attr(\"fill\", \"steelblue\");\r\n\r\n        //enter - new bars get set to darkorange when we \"redraw.\"\r\n        bars.enter()\r\n            .append(\"rect\")\r\n            .attr(\"class\", \"bar\");\r\n        // .attr(\"fill\", \"steelblue\");\r\n\r\n        //exit -- remove ones that aren't in the index set\r\n        bars.exit()\r\n            .transition()\r\n            .duration(200)\r\n            .ease(\"exp\")\r\n            .attr(\"width\", 0)\r\n            .remove();\r\n\r\n        //console.log(yScale);\r\n        // transition -- move the bars to proper widths and location\r\n        bars\r\n            .transition()\r\n            .duration(500)\r\n            .ease(\"quad\")\r\n            .attr(\"width\", function(d) {\r\n                return xScale(+d[column]);\r\n            })\r\n            .attr(\"height\", yScale.rangeBand())\r\n            .attr(\"transform\", function(d, i) {\r\n                return \"translate(\" + [(0 + margin), yScale(i)] + \")\";\r\n            })\r\n            .attr(\"class\", function(d, i) {\r\n                if (d.gender === 'Male' && d.age === '18 to 24') {\r\n                    return \"bar malFocus age18to24\";\r\n                } else if (d.gender === 'Female' && d.age === '18 to 24') {\r\n                    return \"bar femFocus age18to24\";\r\n                } else if (d.gender === 'Female' && d.age === '25 to 34') {\r\n                    return \"bar femFocus age25to34\";\r\n                } else if (d.gender === 'Male' && d.age === '25 to 34') {\r\n                    return \"bar malFocus age25to34\";\r\n                } else if (d.gender === 'Female') {\r\n                    return \"bar femFocus\";\r\n                } else if (d.gender === 'Male') {\r\n                    return \"bar malFocus\";\r\n                }\r\n            })\r\n        //.classed(\"18to24\", (d.age === '18 to 24'))\r\n\r\n        //   .attr(\"class\", function (d, i) {\r\n        //       if (d.age === '18 to 24') {\r\n        //           return \"18to24\";\r\n        //      } else if (d.age === '25 to 34') {\r\n        //           return \"25to34\";\r\n        //       }\r\n        //   });\r\n\r\n        //add legend\r\n\r\n\r\n        //  We are attaching the labels separately, not in a group with the bars...\r\n\r\n        var labels = $bars_age.selectAll(\"text.labels\")\r\n            .data(data, function(d) {\r\n                return d.gender_age\r\n            }); // key function!\r\n\r\n        var labels2 = $bars_age.selectAll(\"text.labels2\")\r\n            .data(data, function(d) {\r\n                return d.gender_age\r\n            });\r\n\r\n\r\n        // everything gets a class and a text field.  But we assign attributes in the transition.\r\n        labels.enter()\r\n            .append(\"text\")\r\n            .attr(\"class\", \"labels\");\r\n        labels.exit()\r\n            .remove();\r\n\r\n        labels2.enter()\r\n            .append(\"text\")\r\n            .attr(\"class\", \"labels2\");\r\n        labels2.exit()\r\n            .remove();\r\n\r\n        numberFormat = d3.format(\".0f\");\r\n        percentageFormat = d3.format(\".1f\");\r\n        rateFormat = d3.format(\".2f\");\r\n\r\n        labels.transition()\r\n            .duration(500)\r\n            .attr(\"transform\", function(d, i) {\r\n                console.log(xScale(+d[column]) + 50);\r\n                console.log(d[column]);\r\n                return \"translate(\" + (xScale(+d[column]) + margin) + \",\" + (yScale(i) + 4) + \")\"\r\n            })\r\n            .text(function(d) {\r\n                // console.log(column);\r\n                if (column == \"percentOpiodDeaths\" && d.age == '65+') {\r\n                    return \"<1%\";\r\n                }\r\n                if (column == \"percentOpiodDeaths\" && d.age != '65+') {\r\n                    return percentageFormat(d[column]) + \"%\";\r\n                }\r\n                if (column == \"numberOpioidDeaths\") {\r\n                    return numberFormat(d[column]);\r\n                } else {\r\n                    return rateFormat(d[column]);\r\n                }\r\n            })\r\n            .attr(\"dy\", \"1.2em\")\r\n            .attr(\"dx\", \"5px\")\r\n            .attr(\"text-anchor\", \"start\");\r\n\r\n        labels2.transition()\r\n            .duration(500)\r\n            .attr(\"transform\", function(d, i) {\r\n                //return \"translate(\" + xScale(+d[column]) + \",\" + yScale(i) + \")\"\r\n                return \"translate(\" + 0 + \",\" + (yScale(i) + 5) + \")\"\r\n            })\r\n            .text(function(d) {\r\n                return d.age;\r\n            })\r\n            .attr(\"dy\", \"1.2em\")\r\n            .attr(\"dx\", \"5px\")\r\n            .attr(\"text-anchor\", \"start\");\r\n\r\n\r\n    } // end of draw function\r\n})();"],"sourceRoot":"/source/"}